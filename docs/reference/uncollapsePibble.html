<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Uncollapse output from optimPibbleCollapsed to full pibble Model — uncollapsePibble • stray</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Uncollapse output from optimPibbleCollapsed to full pibble Model — uncollapsePibble" />

<meta property="og:description" content="See details for model. Should likely be called following
optimPibbleCollapsed. Notation: N is number of samples,
D is number of multinomial categories, Q is number
of covariates, iter is the number of samples of eta (e.g.,
the parameter n_samples in the function optimPibbleCollapsed)" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stray</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.13</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="https://github.com/jsilve24/stray/wiki/Installation-Details">Installation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/introduction-to-stray.html">Intro to stray through stray::pibble</a>
    </li>
    <li>
      <a href="../articles/non-linear-models.html">Non-Linear Modeling with stray::basset</a>
    </li>
    <li>
      <a href="../articles/orthus.html">Joint Modeling  (e.g., Multiomics) with Stray::Orthus</a>
    </li>
    <li>
      <a href="../articles/picking_priors.html">Tips on Specifying Priors</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://github.com/jsilve24/RcppCoDA">RcppCoDA</a>
    </li>
    <li>
      <a href="https://jsilve24.github.io/driver/">driver</a>
    </li>
    <li>
      <a href="https://bioconductor.org/packages/release/bioc/html/philr.html">philr</a>
    </li>
    <li>
      <a href="https://cran.r-project.org/package=RcppHungarian">RcppHungarian</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/inschool4life">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/jsilve24/stray">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Uncollapse output from optimPibbleCollapsed to full pibble Model</h1>
    
    <div class="hidden name"><code>uncollapsePibble.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>See details for model. Should likely be called following
<code><a href='optimPibbleCollapsed.html'>optimPibbleCollapsed</a></code>. Notation: <code>N</code> is number of samples,
<code>D</code> is number of multinomial categories, <code>Q</code> is number
of covariates, <code>iter</code> is the number of samples of <code>eta</code> (e.g.,
the parameter <code>n_samples</code> in the function <code>optimPibbleCollapsed</code>)</p>
    
    </div>

    <pre class="usage"><span class='fu'>uncollapsePibble</span>(<span class='no'>eta</span>, <span class='no'>X</span>, <span class='no'>Theta</span>, <span class='no'>Gamma</span>, <span class='no'>Xi</span>, <span class='no'>upsilon</span>, <span class='no'>seed</span>,
  <span class='kw'>ret_mean</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>ncores</span> <span class='kw'>=</span> -<span class='fl'>1L</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>eta</th>
      <td><p>array of dimension (D-1) x N x iter (e.g., <code>Pars</code> output of
function optimPibbleCollapsed)</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>matrix of covariates of dimension Q x N</p></td>
    </tr>
    <tr>
      <th>Theta</th>
      <td><p>matrix of prior mean of dimension (D-1) x Q</p></td>
    </tr>
    <tr>
      <th>Gamma</th>
      <td><p>covariance matrix of dimension Q x Q</p></td>
    </tr>
    <tr>
      <th>Xi</th>
      <td><p>covariance matrix of dimension (D-1) x (D-1)</p></td>
    </tr>
    <tr>
      <th>upsilon</th>
      <td><p>scalar (must be &gt; D) degrees of freedom for InvWishart prior</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>seed to use for random number generation</p></td>
    </tr>
    <tr>
      <th>ret_mean</th>
      <td><p>if true then uses posterior mean of Lambda and Sigma
corresponding to each sample of eta rather than sampling from
posterior of Lambda and Sigma (useful if Laplace approximation
is not used (or fails) in optimPibbleCollapsed)</p></td>
    </tr>
    <tr>
      <th>ncores</th>
      <td><p>(default:-1) number of cores to use, if ncores==-1 then
uses default from OpenMP typically to use all available cores.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>List with components</p><ol>
<li><p>Lambda Array of dimension (D-1) x Q x iter (posterior samples)</p></li>
<li><p>Sigma Array of dimension (D-1) x (D-1) x iter (posterior samples)</p></li>
<li><p>Timer</p></li>
</ol>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Notation: Let Z_j denote the J-th row of a matrix Z.
While the collapsed model is given by:
$$Y_j ~ Multinomial(Pi_j)$$
$$Pi_j = Phi^{-1}(Eta_j)$$
$$Eta ~ T_{D-1, N}(upsilon, Theta*X, K, A)$$
Where A = I_N + X * Gamma * X', K = Xi is a (D-1)x(D-1) covariance
matrix, Gamma is a Q x Q covariance matrix, and Phi^-1 is ALRInv_D
transform.</p>
<p>The uncollapsed model (Full pibble model) is given by:
$$Y_j ~ Multinomial(Pi_j)$$
$$Pi_j = Phi^{-1}(Eta_j)$$
$$Eta ~ MN_{D-1 x N}(Lambda*X, Sigma, I_N)$$
$$Lambda ~ MN_{D-1 x Q}(Theta, Sigma, Gamma)$$
$$Sigma ~ InvWish(upsilon, Xi)$$
This function provides a means of sampling from the posterior distribution of
<code>Lambda</code> and <code>Sigma</code> given posterior samples of <code>Eta</code> from
the collapsed model.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>JD Silverman K Roche, ZC Holmes, LA David, S Mukherjee.
Bayesian Multinomial Logistic Normal Models through Marginally Latent Matrix-T Processes.
2019, arXiv e-prints, arXiv:1903.11695</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='optimPibbleCollapsed.html'>optimPibbleCollapsed</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>sim</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='pibble_sim.html'>pibble_sim</a></span>()

<span class='co'># Fit model for eta</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='optimPibbleCollapsed.html'>optimPibbleCollapsed</a></span>(<span class='no'>sim</span>$<span class='no'>Y</span>, <span class='no'>sim</span>$<span class='no'>upsilon</span>, <span class='no'>sim</span>$<span class='no'>Theta</span><span class='kw'>%*%</span><span class='no'>sim</span>$<span class='no'>X</span>, <span class='no'>sim</span>$<span class='no'>KInv</span>,
                             <span class='no'>sim</span>$<span class='no'>AInv</span>, <span class='fu'><a href='random_pibble_init.html'>random_pibble_init</a></span>(<span class='no'>sim</span>$<span class='no'>Y</span>))

<span class='co'># Finally obtain samples from Lambda and Sigma</span>
<span class='no'>fit2</span> <span class='kw'>&lt;-</span> <span class='fu'>uncollapsePibble</span>(<span class='no'>fit</span>$<span class='no'>Samples</span>, <span class='no'>sim</span>$<span class='no'>X</span>, <span class='no'>sim</span>$<span class='no'>Theta</span>,
                                   <span class='no'>sim</span>$<span class='no'>Gamma</span>, <span class='no'>sim</span>$<span class='no'>Xi</span>, <span class='no'>sim</span>$<span class='no'>upsilon</span>,
                                   <span class='kw'>seed</span><span class='kw'>=</span><span class='fl'>2849</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Justin Silverman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

