<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Uncollapse output from optimPibbleCollapsed to full pibble Model — uncollapsePibble • fido</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Uncollapse output from optimPibbleCollapsed to full pibble Model — uncollapsePibble"><meta property="og:description" content="See details for model. Should likely be called following
optimPibbleCollapsed. Notation: N is number of samples,
D is number of multinomial categories, Q is number
of covariates, iter is the number of samples of eta (e.g.,
the parameter n_samples in the function optimPibbleCollapsed)"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fido</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="https://github.com/jsilve24/fido/wiki/Installation-Details" class="external-link">Installation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/introduction-to-fido.html">Intro to fido through fido::pibble</a>
    </li>
    <li>
      <a href="../articles/non-linear-models.html">Non-Linear Modeling with fido::basset</a>
    </li>
    <li>
      <a href="../articles/orthus.html">Joint Modeling  (e.g., Multiomics) with fido::Orthus</a>
    </li>
    <li>
      <a href="../articles/picking_priors.html">Tips on Specifying Priors</a>
    </li>
    <li>
      <a href="../articles/mitigating-pcrbias.html">Mitigating PCR Bias</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="https://github.com/jsilve24/RcppCoDA" class="external-link">RcppCoDA</a>
    </li>
    <li>
      <a href="https://jsilve24.github.io/driver/" class="external-link">driver</a>
    </li>
    <li>
      <a href="https://bioconductor.org/packages/release/bioc/html/philr.html" class="external-link">philr</a>
    </li>
    <li>
      <a href="https://cran.r-project.org/package=RcppHungarian" class="external-link">RcppHungarian</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://twitter.com/inschool4life" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/jsilve24/fido" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Uncollapse output from optimPibbleCollapsed to full pibble Model</h1>
    <small class="dont-index">Source: <a href="https://github.com/jsilve24/fido/blob/HEAD/R/RcppExports.R" class="external-link"><code>R/RcppExports.R</code></a></small>
    <div class="hidden name"><code>uncollapsePibble.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>See details for model. Should likely be called following
<code><a href="optimPibbleCollapsed.html">optimPibbleCollapsed</a></code>. Notation: <code>N</code> is number of samples,
<code>D</code> is number of multinomial categories, <code>Q</code> is number
of covariates, <code>iter</code> is the number of samples of <code>eta</code> (e.g.,
the parameter <code>n_samples</code> in the function <code>optimPibbleCollapsed</code>)</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">uncollapsePibble</span><span class="op">(</span></span>
<span>  <span class="va">eta</span>,</span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">Theta</span>,</span>
<span>  <span class="va">Gamma</span>,</span>
<span>  <span class="va">Xi</span>,</span>
<span>  <span class="va">upsilon</span>,</span>
<span>  <span class="va">seed</span>,</span>
<span>  ret_mean <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ncores <span class="op">=</span> <span class="op">-</span><span class="fl">1L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>eta</dt>
<dd><p>array of dimension (D-1) x N x iter (e.g., <code>Pars</code> output of
function optimPibbleCollapsed)</p></dd>


<dt>X</dt>
<dd><p>matrix of covariates of dimension Q x N</p></dd>


<dt>Theta</dt>
<dd><p>matrix of prior mean of dimension (D-1) x Q</p></dd>


<dt>Gamma</dt>
<dd><p>covariance matrix of dimension Q x Q</p></dd>


<dt>Xi</dt>
<dd><p>covariance matrix of dimension (D-1) x (D-1)</p></dd>


<dt>upsilon</dt>
<dd><p>scalar (must be &gt; D) degrees of freedom for InvWishart prior</p></dd>


<dt>seed</dt>
<dd><p>seed to use for random number generation</p></dd>


<dt>ret_mean</dt>
<dd><p>if true then uses posterior mean of Lambda and Sigma
corresponding to each sample of eta rather than sampling from
posterior of Lambda and Sigma (useful if Laplace approximation
is not used (or fails) in optimPibbleCollapsed)</p></dd>


<dt>ncores</dt>
<dd><p>(default:-1) number of cores to use, if ncores==-1 then
uses default from OpenMP typically to use all available cores.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>List with components</p><ol><li><p>Lambda Array of dimension (D-1) x Q x iter (posterior samples)</p></li>
<li><p>Sigma Array of dimension (D-1) x (D-1) x iter (posterior samples)</p></li>
<li><p>The number of cores used</p></li>
<li><p>Timer</p></li>
</ol></div>
    <div id="details">
    <h2>Details</h2>
    <p>Notation: Let Z_j denote the J-th row of a matrix Z.
While the collapsed model is given by:
$$Y_j ~ Multinomial(Pi_j)$$
$$Pi_j = Phi^{-1}(Eta_j)$$
$$Eta ~ T_{D-1, N}(upsilon, Theta*X, K, A)$$
Where A = I_N + X * Gamma * X', K = Xi is a (D-1)x(D-1) covariance
matrix, Gamma is a Q x Q covariance matrix, and Phi^-1 is ALRInv_D
transform.</p>
<p>The uncollapsed model (Full pibble model) is given by:
$$Y_j ~ Multinomial(Pi_j)$$
$$Pi_j = Phi^{-1}(Eta_j)$$
$$Eta ~ MN_{D-1 x N}(Lambda*X, Sigma, I_N)$$
$$Lambda ~ MN_{D-1 x Q}(Theta, Sigma, Gamma)$$
$$Sigma ~ InvWish(upsilon, Xi)$$
This function provides a means of sampling from the posterior distribution of
<code>Lambda</code> and <code>Sigma</code> given posterior samples of <code>Eta</code> from
the collapsed model.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>JD Silverman K Roche, ZC Holmes, LA David, S Mukherjee.
Bayesian Multinomial Logistic Normal Models through Marginally Latent Matrix-T Processes.
2019, arXiv e-prints, arXiv:1903.11695</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="optimPibbleCollapsed.html">optimPibbleCollapsed</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="pibble_sim.html">pibble_sim</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit model for eta</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="optimPibbleCollapsed.html">optimPibbleCollapsed</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">Y</span>, <span class="va">sim</span><span class="op">$</span><span class="va">upsilon</span>, <span class="va">sim</span><span class="op">$</span><span class="va">Theta</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">sim</span><span class="op">$</span><span class="va">X</span>, <span class="va">sim</span><span class="op">$</span><span class="va">KInv</span>, </span></span>
<span class="r-in"><span>                             <span class="va">sim</span><span class="op">$</span><span class="va">AInv</span>, <span class="fu"><a href="random_pibble_init.html">random_pibble_init</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span>  </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Finally obtain samples from Lambda and Sigma</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">uncollapsePibble</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">Samples</span>, <span class="va">sim</span><span class="op">$</span><span class="va">X</span>, <span class="va">sim</span><span class="op">$</span><span class="va">Theta</span>, </span></span>
<span class="r-in"><span>                                   <span class="va">sim</span><span class="op">$</span><span class="va">Gamma</span>, <span class="va">sim</span><span class="op">$</span><span class="va">Xi</span>, <span class="va">sim</span><span class="op">$</span><span class="va">upsilon</span>, </span></span>
<span class="r-in"><span>                                   seed<span class="op">=</span><span class="fl">2849</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Justin Silverman, Michelle Nixon.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

