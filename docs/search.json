[{"path":"https://jsilve24.github.io/fido/articles/introduction-to-fido.html","id":"an-introduction-to-fido","dir":"Articles","previous_headings":"","what":"An introduction to fido","title":"Introduction to fido::Pibble","text":"fido (Justin D. Silverman et al. 2019) loose acronym “(Bayesian) Multinomial Logistic-Normal Models”. particular development fido stems need fast inference time-invariant MALLARD models(Justin D. Silverman et al. 2018). fido fast! uses closed form solutions model gradients Hessians written C++ preform MAP estimation combination parameter uncertainty estimation using Laplace Approximation. One main models fido function pibble fits Multinomial Logistic-Normal Linear Regression model. fido model exactly? First let give broad description 10,000ft : Basically model multinomial count data (e.g., sample contains counts \\(D\\) “types things”). Importantly, unlike common Poisson count models, multinomial models “competition counted” (.e., cases counting one type thing means less resources available count types things). may seem vague let give example. Pretend ball pit red, green, blue balls. Pretend ball pit large don’t know total number balls ball pit, yet want say something relative number red, blue, green balls pit. One way may choose measure ball pit grabbing armful balls counting number balls color (e.g., one armful may collect 5 red, 3 blue, 6 green). arms can contain many balls (example 14) (randomly) gotten another green ball armful (making 7 total) likely able measure one red blue balls; hence “competition counted”. turns type sampling occurs time many situations (Wikipedia example political polling). Perhaps one notable examples type count data occurs modern high-throughput sequencing studies 16S rRNA studies profile microbial communities bulk/single-cell RNA-seq studies study expression profiles cells. cases, transcripts sequenced number different types transcripts counted. important part sequencing samples small portion total genetic material available leads similar competition counted.","code":""},{"path":"https://jsilve24.github.io/fido/articles/introduction-to-fido.html","id":"the-pibble-model","dir":"Articles","previous_headings":"An introduction to fido","what":"The pibble model","title":"Introduction to fido::Pibble","text":"Pibble one type fido model. particular fido model multivariate linear regression. Let \\(Y\\) denote \\(D\\times N\\) matrix counts. Let us denote \\(j\\)-th column \\(Y\\) \\(Y_j\\). Thus “sample” dataset measurement relative amount \\(D\\) “types things”. Suppose also covariate information form \\(Q\\times N\\) matrix \\(X\\). following pibble model including likelihood priors: \\[ \\begin{align} Y_j & \\sim \\text{Multinomial}\\left(\\pi_j \\right)  \\\\ \\pi_j & = \\phi^{-1}(\\eta_j) \\\\ \\eta_j &\\sim N(\\Lambda X_j, \\Sigma) \\\\ \\Lambda &\\sim  MN_{(D-1) \\times Q}(\\Theta, \\Sigma, \\Gamma) \\\\ \\Sigma &\\sim W^{-1}(\\Xi, \\upsilon) \\end{align} \\] \\(MN_{(D-1) \\times Q}\\) denotes Matrix Normal distribution matrix \\(\\Lambda\\) regression coefficients dimension \\((D-1)\\times Q\\). Essentially can think Matrix normal two covariance matrices one describing covariation rows \\(\\Lambda\\) (\\(\\Sigma\\)) another describing covariation columns \\(\\Lambda\\) (\\(\\Gamma\\)). \\(W^{-1}\\) refers Inverse Wishart distribution (common distribution covariance matrices). line \\(\\pi_j = \\phi^{-1}(\\eta_j)\\) represents transformation parameters \\(\\pi_j\\) exist simplex (e.g., \\(\\pi_j\\) must sum 1) transformed parameters \\(\\eta_j\\) exist real space. particular define \\(\\phi^{-1}\\) inverse additive log ratio transform (conversely implies \\(\\eta_j = ALR(\\pi_j)\\)) also known identified softmax transform (commonly known Machine Learning community). say later tutorial, one thing know model implemented using ALR transform computationally simple fast; results model can viewed number transforms used (instead ALR) including isometric log-ratio transform, centered log-ratio transform. moving , like give intuitive description pibble. Essentially main modeling component pibble third equation (\\(\\eta_j \\sim N(\\Lambda X_j, \\Sigma)\\)) just multivariate linear model. , \\(X\\) covariates (can continuous, discrete, binary, etc…), \\(\\Sigma\\) covariance matrix regression residuals.","code":""},{"path":"https://jsilve24.github.io/fido/articles/introduction-to-fido.html","id":"example-analysis-of-microbiome-data","dir":"Articles","previous_headings":"","what":"Example analysis of microbiome data","title":"Introduction to fido::Pibble","text":"analysis presented fido manuscript (Justin D. Silverman et al. 2019). reanalyze previously published study comparing microbial composition terminal ileum subjects Crohn’s Disease (CD) healthy controls (Gevers et al. 2014). fit pibble model using CD status, inflammation status age covariates (plus constant intercept term). Create Design Matrix OTU Table Next specify priors. going start specifying prior covariance log-ratios \\(\\Sigma\\). like thinking prior covariance taxa log-scale (.e., log absolute abundances log-ratios). refer covariance log-absolute abundances \\(\\Omega\\). example, build prior states mean \\(\\Omega\\) identity matrix \\(I_D\\). Aitchison (1986), know assume taxa covariance \\(\\Omega\\) terms log-absolute abundance correlation \\(\\text{ALR}_D\\) given \\[ \\Sigma = G \\Omega G^T \\] \\(G\\) \\(D-1 \\times D\\) matrix given \\(G = [I_{D-1}; -1_{D-1}]\\) (.e., \\(G\\) \\(\\text{ALR}_D\\) contrast matrix). Additionally, know Inverse Wishart mode given \\(\\frac{\\Xi}{\\upsilon + D}\\). Finally, note \\(\\upsilon\\) essentially controls uncertainty \\(\\Sigma\\) prior mean. take \\(\\upsilon = D+3\\). gives us \\(\\Xi = (\\upsilon - D) GIG^T\\). scale \\(\\Xi\\) factor 1/2 make \\(Tr(\\Xi)=D-1\\). Finally specify priors \\(\\Theta\\) (mean \\(\\Lambda\\)) \\(\\Gamma\\) (covariance columns \\(\\Lambda\\); .e., covariance covariates). center prior \\(\\Lambda\\) zero, assume covariates independent. strongly recommend users perform prior predictive checks make sure priors make sense . fido makes easy, main fitting functions (e.g., pibble) automatically sample prior predictive distribution Y left NULL (e.g., without data posterior just prior). main fitting functions fido package output special fit objects (e.g., pibble outputs object class pibblefit). fit objects just lists extra metadata allows special method dispatch. example, call print pibblefit object get nice summary object. Note: Currently, function pibble takes expects inputs outputs “default” coordinate system; simply ALR coordinate system last category (49 ) taken reference (generalized future versions). specifically vector \\(x\\) representing proportions categories \\(\\{1, \\dots, D\\}\\) can write \\[x^* = \\left( \\log \\frac{x_1}{x_D}, \\dots, \\log \\frac{x_{D-1}}{x_D}\\right).\\] mentioned however, designed fido work many different coordinate systems including ALR (respect category), CLR, ILR, proportions. help transform things coordinate systems written series transformation functions transform pibblefit object desired coordinate system. Importantly, pibblefit objects keep track coordinate system currently user need specify coordinate system want change . Keep mind covariance matrices represented proportions visualizations summaries based covariance matrices suppressed pibblefit objects proportions coordinate system. example, lets look viewing summary prior \\(\\Lambda\\) respect CLR coordinate system1. default summary function returns list (possible elements Lambda, Sigma, Eta) summarizing posterior parameter based quantiles mean (e.g., p2.5 0.025 percentile posterior distribution). type table may hard take due large , pibblefit objects also come default plotting option parameters. Also returned plot objects ggplot objects normal ggplot2 commands work . though going use one names functions pibblefit objects provide specific names covariates (helpful plot).  looks fairly reasonable . going go ahead fit model data. fido provides helper method called refit use avoid passing prior parameters . Unlike main pibble function, refit method can called objects coordinate system transformations default coordinate system handled internally2. one nice thing using refit method. said, new objects added pibblefit object need added proper coordinates example, wanted replace prior \\(\\Xi\\) object CLR coordinates, transform prior Xi CLR coordinates adding priors object. Now also going add taxa names make easier interpret results. anything else lets look posterior predictive distribution assess model fit. can accessed method ppc3.  things note plot. First, zoomed like looks hard make much . fairly large dataset analyzing hard view uncertainty interval; case plotting median 95% confidence interval grey black observed counts green. fido also simpler function summarizes posterior predictive check. see model appears fitting well (least based posterior predictive check) 1.5% observations fall outside 95% posterior predictive density (good). readers look ppc plots think “looks like -fitting”. However, note two ways using ppc. One predict counts based samples \\(\\eta\\) (Eta; ); predict “scratch” predict starting form posterior samples \\(\\Lambda\\) (Lambda) sampling \\(\\eta\\) sampling \\(Y\\). later functionality can accessed also passing parameters from_scratch=TRUE ppc function. Note: two posterior predictive checks different meanings, one better .  Now going finally look posterior distribution regression parameters, many focus just 95% credible interval including zero (.e., model fairly certain non-zero). also going ignore intercept term just look parameters associated age disease status.  first, obvious ting notice covariate age pretty much effect , whatever effect may incredibly weak. going remove age plot just look coordinates non-zero effect diagnosis CD","code":"library(MicrobeDS) library(phyloseq) library(dplyr) library(fido)  set.seed(899)  data(\"RISK_CCFA\") # drop low abundant taxa and samples dat <- RISK_CCFA %>%    subset_samples(disease_stat!=\"missing\",                   immunosup!=\"missing\") %>%    subset_samples(diagnosis %in% c(\"no\", \"CD\")) %>%    subset_samples(steroids==\"false\") %>%    subset_samples(antibiotics==\"false\") %>%    subset_samples(biologics==\"false\") %>%    subset_samples(biopsy_location==\"Terminal ileum\") %>%    tax_glom(\"Family\") %>%    prune_samples(sample_sums(.) >= 5000,.) %>%   filter_taxa(function(x) sum(x > 3) > 0.10*length(x), TRUE) sample_dat <- as.data.frame(as(sample_data(dat),\"matrix\")) %>%    mutate(age = as.numeric(as.character(age)),          diagnosis = relevel(factor(diagnosis, ordered = FALSE), ref=\"no\"),           disease_stat = relevel(factor(disease_stat, ordered = FALSE), ref=\"non-inflamed\")) X <- t(model.matrix(~diagnosis + disease_stat+age, data=sample_dat)) Y <- otu_table(dat)  # Investigate X and Y look like X[,1:5] #>                      1939.SKBTI.0175 1939.SKBTI047 1939.SKBTI051 1939.SKBTI063 #> (Intercept)                  1.00000       1.00000          1.00       1.00000 #> diagnosisCD                  1.00000       1.00000          1.00       1.00000 #> disease_statinflamed         0.00000       1.00000          1.00       1.00000 #> age                         15.16667      14.33333         15.75      13.58333 #>                      1939.SKBTI072 #> (Intercept)                   1.00 #> diagnosisCD                   1.00 #> disease_statinflamed          1.00 #> age                          15.75 Y[1:5,1:5] #> OTU Table:          [5 taxa and 5 samples] #>                      taxa are rows #>         1939.SKBTI.0175 1939.SKBTI047 1939.SKBTI051 1939.SKBTI063 1939.SKBTI072 #> 4442127               0             9             0            14             2 #> 74305                 1             2            35             1             0 #> 663573               36             1             0             2             1 #> 2685602              10           264           211           276            83 #> 4339819               0            37            42            70            22 upsilon <- ntaxa(dat)+3  Omega <- diag(ntaxa(dat)) G <- cbind(diag(ntaxa(dat)-1), -1) Xi <- (upsilon-ntaxa(dat))*G%*%Omega%*%t(G) Theta <- matrix(0, ntaxa(dat)-1, nrow(X)) Gamma <- diag(nrow(X)) priors <- pibble(NULL, X, upsilon, Theta, Gamma, Xi)   print(priors) #>  pibblefit Object (Priors Only):  #>   Number of Samples:      250  #>   Number of Categories:       49  #>   Number of Covariates:       4  #>   Number of Posterior Samples:    2000  #>   Contains Samples of Parameters:Eta  Lambda  Sigma #>   Coordinate System:      alr, reference category: 49 priors <- to_clr(priors)   summary(priors, pars=\"Lambda\", gather_prob=TRUE, as_factor=TRUE, use_names=TRUE)   #> $Lambda #> # A tibble: 784 x 9 #>    Parameter coord covariate         val .lower .upper .width .point .interval #>    <chr>     <int>     <int>       <dbl>  <dbl>  <dbl>  <dbl> <chr>  <chr>     #>  1 Lambda        1         1  0.0509     -0.528  0.596    0.5 mean   qi        #>  2 Lambda        1         2  0.00199    -0.567  0.575    0.5 mean   qi        #>  3 Lambda        1         3 -0.0373     -0.620  0.532    0.5 mean   qi        #>  4 Lambda        1         4 -0.00205    -0.554  0.549    0.5 mean   qi        #>  5 Lambda        2         1  0.00991    -0.564  0.535    0.5 mean   qi        #>  6 Lambda        2         2 -0.00000782 -0.572  0.580    0.5 mean   qi        #>  7 Lambda        2         3 -0.0247     -0.570  0.518    0.5 mean   qi        #>  8 Lambda        2         4  0.0165     -0.536  0.589    0.5 mean   qi        #>  9 Lambda        3         1  0.0138     -0.584  0.620    0.5 mean   qi        #> 10 Lambda        3         2 -0.00502    -0.542  0.581    0.5 mean   qi        #> # ... with 774 more rows names_covariates(priors) <- rownames(X) p <- plot(priors, par=\"Lambda\")  #> Scale for 'colour' is already present. Adding another scale for 'colour', which will #> replace the existing scale. p + ggplot2::xlim(c(-10, 10)) priors$Y <- Y # remember pibblefit objects are just lists posterior <- refit(priors, optim_method=\"lbfgs\") tax <- tax_table(dat)[,c(\"Class\", \"Family\")] tax <- apply(tax, 1, paste, collapse=\"_\") names_categories(posterior) <- tax ppc(posterior) + ggplot2::coord_cartesian(ylim=c(0, 30000)) ppc_summary(posterior) #> Proportions of Observations within 95% Credible Interval: 0.9898776 ppc(posterior, from_scratch=TRUE) +ggplot2::coord_cartesian(ylim=c(0, 30000)) ppc_summary(posterior, from_scratch=TRUE) #> Proportions of Observations within 95% Credible Interval: 0.9721633 posterior_summary <- summary(posterior, pars=\"Lambda\")$Lambda focus <- posterior_summary[sign(posterior_summary$p2.5) == sign(posterior_summary$p97.5),] focus <- unique(focus$coord) plot(posterior, par=\"Lambda\", focus.coord = focus, focus.cov = rownames(X)[2:4]) #> Scale for 'colour' is already present. Adding another scale for 'colour', which will #> replace the existing scale. posterior_summary <- filter(posterior_summary, covariate==\"diagnosisCD\")  focus <- posterior_summary[sign(posterior_summary$p2.5) == sign(posterior_summary$p97.5),] focus <- unique(focus$coord)  tax_table(dat)[taxa_names(dat)[which(names_coords(posterior) %in% focus)]] #> Taxonomy Table:     [12 taxa by 7 taxonomic ranks]: #>         Kingdom    Phylum           Class                   Order               #> 74305   \"Bacteria\" \"Proteobacteria\" \"Epsilonproteobacteria\" \"Campylobacterales\" #> 4449236 \"Bacteria\" \"Proteobacteria\" \"Betaproteobacteria\"    \"Burkholderiales\"   #> 1105919 \"Bacteria\" \"Proteobacteria\" \"Betaproteobacteria\"    \"Burkholderiales\"   #> 4477696 \"Bacteria\" \"Proteobacteria\" \"Gammaproteobacteria\"   \"Pasteurellales\"    #> 4448331 \"Bacteria\" \"Proteobacteria\" \"Gammaproteobacteria\"   \"Enterobacteriales\" #> 4154872 \"Bacteria\" \"Bacteroidetes\"  \"Flavobacteriia\"        \"Flavobacteriales\"  #> 4452538 \"Bacteria\" \"Fusobacteria\"   \"Fusobacteriia\"         \"Fusobacteriales\"   #> 341322  \"Bacteria\" \"Firmicutes\"     \"Bacilli\"               \"Turicibacterales\"  #> 1015143 \"Bacteria\" \"Firmicutes\"     \"Bacilli\"               \"Gemellales\"        #> 176318  \"Bacteria\" \"Firmicutes\"     \"Clostridia\"            \"Clostridiales\"     #> 1788466 \"Bacteria\" \"Firmicutes\"     \"Clostridia\"            \"Clostridiales\"     #> 1896700 \"Bacteria\" \"Firmicutes\"     \"Clostridia\"            \"Clostridiales\"     #>         Family                  Genus Species #> 74305   \"Helicobacteraceae\"     NA    NA      #> 4449236 \"Alcaligenaceae\"        NA    NA      #> 1105919 \"Oxalobacteraceae\"      NA    NA      #> 4477696 \"Pasteurellaceae\"       NA    NA      #> 4448331 \"Enterobacteriaceae\"    NA    NA      #> 4154872 \"[Weeksellaceae]\"       NA    NA      #> 4452538 \"Fusobacteriaceae\"      NA    NA      #> 341322  \"Turicibacteraceae\"     NA    NA      #> 1015143 \"Gemellaceae\"           NA    NA      #> 176318  \"Christensenellaceae\"   NA    NA      #> 1788466 \"Lachnospiraceae\"       NA    NA      #> 1896700 \"Peptostreptococcaceae\" NA    NA plot(posterior, par=\"Lambda\", focus.coord = focus, focus.cov = rownames(X)[2]) #> Scale for 'colour' is already present. Adding another scale for 'colour', which will #> replace the existing scale."},{"path":[]},{"path":"https://jsilve24.github.io/fido/articles/introduction-to-fido.html","id":"a-few-notes-on-model-inference-and-parameter-collapsing","dir":"Articles","previous_headings":"More Technical Details","what":"A few notes on model inference and parameter collapsing","title":"Introduction to fido::Pibble","text":"Along algorithmic speed-ups enabled C++ Eigen library fido uses conjugate priors regression component model allowing last three lines model collapsed 1 line. last three lines model can re-expanded using fully conjugate sampling schemes require optimization MCMC (matrix operations). details: collapsed model given \\[ \\begin{align} Y_j & \\sim \\text{Multinomial}\\left(\\pi_j, n_j\\right)  \\\\ \\pi_j & = \\phi^{-1}(\\eta_j) \\\\ \\eta_j &\\sim T_{(D-1)\\times N}(\\upsilon, \\Theta X, \\Xi, I_N + X^T \\Gamma X) \\end{align} \\] \\(=(I_N + X^T \\Gamma, X)^{-1}\\) \\(T_{(D-1)\\times N}\\) refers Matrix T-distribution \\((D-1)\\times N\\) matrix \\(\\eta\\) log density given \\[\\log T_{(D-1)\\times N}(\\eta | \\upsilon, \\Theta X, \\Xi, ) \\propto -\\frac{\\upsilon+N-D-2}{2}\\log | I_{D-1}+\\Xi^{-1}(\\eta-\\Theta X)(\\eta-\\Theta X)^T |.\\] Rather using MCMC sample \\(\\eta\\) fido uses MAP estimation. Additionally, fido allows quantification uncertainty MAP estimates using Laplace approximation. found practice MAP based Laplace approximation produced comparable results full MCMC sampler tremendous improvements compute time. samples \\(\\eta\\) produced using Laplace approximation closed form solutions conditional density \\(\\Lambda\\) \\(\\Sigma\\) given \\(\\eta\\) used “uncollapse” collapsed model produce posterior samples target model. uncollapsing fast given following matrix equations: \\[ \\begin{align} \\upsilon_N &= \\upsilon+N \\\\ \\Gamma_N &= (XX^T+\\Gamma^{-1})^{-1} \\\\ \\Theta_N &= (\\eta X^T+\\Theta\\Gamma^{-1})\\Gamma_N \\\\ \\Xi_N &= \\Xi + (\\eta - \\Theta_N X)(\\eta - \\Theta_N X)^T + (\\Theta_N - \\Theta)\\Gamma(\\Theta_N- \\Theta)^T \\\\ p(\\Sigma | \\eta, X) &= W^{-1}(\\Xi_N, \\upsilon_N)\\\\ p(\\Lambda | \\Sigma, \\eta, X) &= MN_{(D-1)\\times Q}(\\Lambda_N, \\Sigma, \\Gamma_N). \\end{align} \\] Laplace approximation slow, unstable (see ) simply needed, default behavior pibble preform matrix calculations produce single point estimate \\(\\Sigma\\) \\(\\Lambda\\) based posterior means \\(p(\\Sigma | \\eta, X)\\) \\((\\Lambda | \\Sigma, \\eta, X)\\).","code":""},{"path":[]},{"path":"https://jsilve24.github.io/fido/articles/mitigating-pcrbias.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Example of using Fido for measuring and mitigating PCR Bias","text":"PCR bias can measured corrected combining specially designed calibration curve statistical models. figure gives brief overview calibration experiment. brief, samples pooled create “calibration sample”. calibration sample contains DNA every taxa study. calibration sample split multiple aliquots amplified varying number cycles. sequence resulting samples along original samples. turn modeling (focus vignette).  manuscript, show PCR bias well approximated simple multiplicative process. translated sequence count data, means PCR bias represents linear process log-ratio space: just need multinomial logistic-normal linear models (aka pibble models fido package). set model correctly PCR bias just linear model: bias parameter amount bias seen given sample parameter times number PCR cycles sample underwent prior sequencing. case estimate unbiased composition sample just becomes unique intercept sample (technical / biological replicates replicates share intercept; demonstrate well). Another way think want estimate composition number PCR cycles equal zero (aka intercept).","code":""},{"path":"https://jsilve24.github.io/fido/articles/mitigating-pcrbias.html","id":"an-example","dir":"Articles","previous_headings":"","what":"An Example","title":"Example of using Fido for measuring and mitigating PCR Bias","text":"show example data (including calibration samples can modeled). mock community data analyzed manuscript. Lets first take brief look data. two objects Y (count table already preprocessed just manuscript) metadata contains covariates need (including number PCR cycles sample undergone). non-obvious variable probably machine just categorical variable denoting 4 different PCR machines used amplify given sample. writing paper, thought might source bias included term model (just demonstrate ). fido doesn’t yet formula interface (write eventually), just need use formula interface provided base-R’s model.matrix function. can see created design matrix encoded PCR machine using series 3 dummy variables. also series dummy variables denoting samples biologically unique (e.g., sample_num). -1 formula just tells R unique intercept biological sample (e.g., use one-hot-encoding rather dummy encoding used PCR machines). Next going specify model priors fit model. detailed description general thought process like follow creating priors fido provided vignette Tips Specifying Priors. just going simple prior just change Gamma default values. wondering, manuscript choose multiplier 10 based maximum marginal likelihood. end vignette show example can done. Next going transform results CLR coordinates interpret space. ’s . Now just interpreting model results. Lets say want investigate estimated unbiased composition, just look inferred random intercepts corresponding sample_num variable. can plot results simply enough:  compositional bias introduced cycle can also visualized.  fido package bunch tools working fitted models depending ultimately want . See main pibble vignette fuller description can fitted models. One plot find particularly useful, visualizing calibration data fitted bias model. can done follows:  two things look plots. First, data look linear space. data look linear options: () something went wrong calibration experiment, (b) something wrong code plotting calibration data, (c) theory prior experiments wrong PCR bias well approximated log-ratio linear. Second, look make sure model good job fitting data. Just remember data sources variation model accounting plotting. example, batch variation (think PCR machine variable included ). also zeros; just add pseudo-count transform data, internally fido actually modeling zeros appropriate pseudo-count.","code":"library(fido) library(dplyr) library(tidyr) library(ggplot2)  set.seed(5903) # First load the data data(pcrbias_mock) Y[1:5,1:5] #>               cycle13.1 cycle13.2 cycle13.3 cycle14.1 cycle14.2 #> B.longum             27        28        22        37        44 #> B.subtilis          320       299       272       513       650 #> C.aerofaciens        35        32        39        43        84 #> C.hathewayi          61        52        59        93       117 #> C.innocuum          121        91       112       197       208  head(metadata) #>   sample_name  sample_num cycle_num machine #> 1   cycle13.1 Calibration        13       3 #> 2   cycle13.2 Calibration        13       3 #> 3   cycle13.3 Calibration        13       3 #> 4   cycle14.1 Calibration        14       4 #> 5   cycle14.2 Calibration        14       4 #> 6   cycle14.3 Calibration        14       4 X <- t(model.matrix(~ cycle_num + sample_num + machine  -1, data = metadata)) X[,1:5] #>                        1  2  3  4  5 #> cycle_num             13 13 13 14 14 #> sample_numCalibration  1  1  1  1  1 #> sample_numMock1        0  0  0  0  0 #> sample_numMock10       0  0  0  0  0 #> sample_numMock2        0  0  0  0  0 #> sample_numMock3        0  0  0  0  0 #> sample_numMock4        0  0  0  0  0 #> sample_numMock5        0  0  0  0  0 #> sample_numMock6        0  0  0  0  0 #> sample_numMock7        0  0  0  0  0 #> sample_numMock8        0  0  0  0  0 #> sample_numMock9        0  0  0  0  0 #> machine2               0  0  0  0  0 #> machine3               1  1  1  0  0 #> machine4               0  0  0  1  1 fit <- pibble(Y = Y, X=X, Gamma = 10*diag(nrow(X))) fit <- to_clr(fit) # pull out indices for random intercepts corresponding to `sample_num` focus.covariate <- rownames(X)[which(grepl(\"sample_num\", rownames(X)))]  # Also just so the plot fits nicely in Rmarkdown we are also going to just  # plot a few of the taxa focus.coord <- paste0(\"clr_\", c(\"S.gallolyticus\", \"R.intestinalis\", \"L.ruminis\"))   # Also to make the plot fit nicely, I just flip the orientation of the plot  plot(fit, par=\"Lambda\", focus.cov=focus.covariate, focus.coord=focus.coord) +   theme(strip.text.y=element_text(angle=0, hjust=1)) +   facet_grid(.data$covariate~.) #> Scale for 'colour' is already present. Adding another scale for 'colour', which will #> replace the existing scale. # Also to make the plot fit nicely, I just flip the orientation of the plot  plot(fit, par=\"Lambda\", focus.cov=\"cycle_num\") #> Scale for 'colour' is already present. Adding another scale for 'colour', which will #> replace the existing scale. # First transform the data into CLR coordinates (requires pseudo-count to deal with # zeros). Then will convert to tidy format for ggplot  tidy_calibration <- clr_array(Y+0.5, 1) %>% # transform to CLR   as.data.frame() %>%    select(starts_with(\"cycle\")) %>%  # select only samples from the calibration   t() %>%    as.data.frame() tidy_calibration$sample_name <- rownames(tidy_calibration) tidy_calibration <- tidy_calibration %>%    gather(coord, val, -sample_name) %>%    mutate(coord = as.numeric(substr(coord, 2, 4))) %>%    left_join(metadata, by=\"sample_name\") %>%    mutate(coord = names_coords(fit)[coord])     # Now the important part - lets grab the pibble result of interest X.tmp <- matrix(0, nrow(X), 2) # Create fake covariate data to predict the regression line based on  rownames(X.tmp) <- rownames(X) X.tmp[\"cycle_num\",2] <- 35 X.tmp[\"sample_numCalibration\",] <- 1 X.tmp # simple, just going to predict the composition for each of these two samples #>                       [,1] [,2] #> cycle_num                0   35 #> sample_numCalibration    1    1 #> sample_numMock1          0    0 #> sample_numMock10         0    0 #> sample_numMock2          0    0 #> sample_numMock3          0    0 #> sample_numMock4          0    0 #> sample_numMock5          0    0 #> sample_numMock6          0    0 #> sample_numMock7          0    0 #> sample_numMock8          0    0 #> sample_numMock9          0    0 #> machine2                 0    0 #> machine3                 0    0 #> machine4                 0    0       # for the plot  # Now predict the fitted regression line for cycle_num using X.tmp predicted <- predict(fit, newdata=X.tmp, summary=TRUE) %>%    mutate(cycle_num = c(0, 35)[sample])  # now plot  predicted %>%    ggplot(aes(x=cycle_num)) +   geom_ribbon(aes(ymin=p2.5, ymax=p97.5), fill=\"darkgrey\") +   geom_line(aes(y=mean)) +   geom_point(data=tidy_calibration, aes(y=val)) +   facet_grid(coord~.) +   theme_bw() +   theme(strip.text.y=element_text(angle=0)) +   ylab(\"CLR Coordinates\")"},{"path":"https://jsilve24.github.io/fido/articles/mitigating-pcrbias.html","id":"using-maximum-marginal-likelihood-to-estimate-a-scale-of-gamma","dir":"Articles","previous_headings":"","what":"Using Maximum Marginal Likelihood to estimate a scale of Gamma","title":"Example of using Fido for measuring and mitigating PCR Bias","text":"chose prior gamma diagonal matrix multiplied factor 10. choose 10? manuscript used something called maximum marginal likelihood. Essentially refit model different values (just 10) saw one fit data best (one highest marginal likelihood). example can done. notice essentially model tells us just want really big value sigma. ? actually corresponds situation multinomial alone enough explain variation technical replicates. happens occasionally. also see log marginal likelihood pretty much assemptotes around 10. rather picking 100000, just settled 10 numerically stable just seemed reasonable. model basically just says: “don’t choose value less 10”.","code":"sigma <- c(1, 2, 3, 10, 100, 1000) # candidate values  lml <- rep(NA, length(sigma)) # log marginal likelihood for (i in seq_along(sigma)){   fit <- pibble(Y=Y, X=X, Gamma = sigma[i]*diag(nrow(X)))   lml[i] <- fit$logMarginalLikelihood # this is calculated automatically by fido } base::plot(sigma, lml)"},{"path":"https://jsilve24.github.io/fido/articles/non-linear-models.html","id":"fidobasset-the-model","dir":"Articles","previous_headings":"","what":"fido::basset, the model","title":"Non-linear models with fido::basset","text":"fido can used non-linear modeling. going go one model based multivariate Gaussian processes. Gaussian processes type lazy learner, named model lazy dog: Basset Hound. Hence model called basset. basset model can written \\[ \\begin{align} Y_j & \\sim \\text{Multinomial}\\left(\\pi_j \\right)  \\\\ \\pi_j & = \\phi^{-1}(\\eta_j) \\\\ \\eta &\\sim N(\\Lambda[X], \\Sigma, I_N) \\\\ \\Lambda[X] &\\sim  \\textsf{GP}(\\Theta[X], \\Sigma, \\Gamma[X]) \\\\ \\Sigma &\\sim W^{-1}(\\Xi, \\upsilon) \\end{align} \\] now label quantities interpreted function square brackets. particular, use notation \\(\\Lambda[X]\\) function maps \\(Q \\times N\\) matrix covariates \\(X\\) matrix \\(\\eta\\). \\(\\Lambda\\) can interpreted smooth function relates covariates \\(X\\) composition \\(\\eta\\) potentially non-linear manner. \\(\\Theta[X]\\) mean function evaluated \\(X\\), \\(\\Gamma[X]\\) covariance matrix (gram matrix) formed evaluating positive semi-definite kernel function \\(K\\) set points \\(\\) \\(j\\), .e., \\(\\Gamma_{ij} = K(X_i, X_j)\\). Many different possible kernel functions makes flexible powerful model.","code":""},{"path":"https://jsilve24.github.io/fido/articles/non-linear-models.html","id":"non-linear-time-series-modeling","dir":"Articles","previous_headings":"","what":"Non-linear time-series modeling","title":"Non-linear models with fido::basset","text":"demonstrate basset going reanalyze mallard1 dataset Silverman et al. (2018) provided phyloseq object fido. dataset features 4 artificial gut vessels sampled daily hourly 1 month many technical replicates. accord prior analyses (make easy visualize results) going just analyze bacterial families frequently observed. Note: full dataset (sequence variant level without preprocessing) available run data(mallard). simplicity just look samples vessel 12. function basset wrapper around fido internals make fitting model easy. basset patterned function pibble requires Theta Gamma given matrix functions rather matrices. Theta must function given X outputs \\(D-1 \\times N\\) matrix (just like give pibble) Gamma must function given X outputs \\(N \\times N\\) covariance matrix (e.g., covariance samples). kernel functions meet requirements Gamma fido already. use Squared Exponential (SE) kernel Gamma set Theta zero function. SE kernel give us non-linear smoothing observed time-series. Important Note: Currently, Theta must output matrix represented default coordinate system (\\(ALR_D\\)). may generalized future. just specify Kernel parameters manually, generally parameters can chosen cross-validation. turns basset really just creating pibblefit object little special represents posterior non-linear functions. benefit many methods available pibblefit objects work bassetfit objects. example, can use transformation methods:  Really basset shows power use smooth. Now going create visual shows observed data CLR coordinates (need add pseudo-count) along smoothed estimates.","code":"library(fido) library(dplyr) library(tidyr) library(ggplot2) data(mallard_family)  # Just take vessel 1 sample.ids <- mallard_family$sample_data[mallard_family$sample_data$Vessel == 1,] # Just take hourly samples sample.ids <- sample.ids[(sample.ids$time > \"2015-11-20 15:00:00 UTC\") & (sample.ids$time < \"2015-11-25 16:00:00 UTC\"),]  # Subsetting the sample data and OTU data subset.sample_data <- mallard_family$sample_data[mallard_family$sample_data$X.SampleID %in% sample.ids$X.SampleID,]  subset.otu_table <- mallard_family$otu_table[rownames(mallard_family$otu_table) %in% sample.ids$X.SampleID,]  # Order samples - to make plotting easy later o <- order(subset.sample_data$time) subset.otu_table <- subset.otu_table[o,] subset.sample_data <- subset.sample_data[o,]  # Extract Data / dimensions from Phyloseq object Y <- t(as(subset.otu_table, \"matrix\")) D <- nrow(Y) N <- nrow(subset.sample_data)  # X in hours X <- as.numeric(subset.sample_data$time) X <- t((X-min(X)) / 3600) # Specify Priors Gamma <- function(X) SE(X, sigma=5, rho=10) # Create partial function  Theta <- function(X) matrix(0, D-1, ncol(X)) upsilon <- D-1+3 Xi <- matrix(.4, D-1, D-1) diag(Xi) <- 1  # Now fit the model fit <- fido::basset(Y, X, upsilon, Theta, Gamma, Xi) #> No rows of X were specified. Using all rows... fit.clr <- to_clr(fit)  # Plot Sigma in CLR plot(fit.clr, par=\"Sigma\", focus.coord=c(\"clr_seq_6\", \"clr_seq_5\", \"clr_seq_2\")) # predict not just missing days but also forecast into future X_predict <- t(1:(max(X))) predicted <- predict(fit.clr, X_predict, jitter=1) family_names <- as(mallard_family$tax_table$Family, \"vector\") Y_clr_tidy <- clr_array(Y+0.65, parts = 1) %>%   gather_array(mean, coord, sample) %>%   mutate(time = X[1,sample],          coord = paste0(\"CLR(\", family_names[coord],\")\"))  predicted_tidy <- gather_array(predicted, val, coord, sample, iter) %>%   mutate(time = X_predict[1,sample]) %>%   filter(!is.na(val)) %>%   group_by(time, coord) %>%   summarise_posterior(val, na.rm=TRUE) %>%   ungroup() %>%   mutate(coord = paste0(\"CLR(\", family_names[coord],\")\"))  ggplot(predicted_tidy, aes(x = time, y=mean)) +   geom_ribbon(aes(ymin=p2.5, ymax=p97.5), fill=\"darkgrey\", alpha=0.5) +   geom_ribbon(aes(ymin=p25, ymax=p75), fill=\"darkgrey\", alpha=0.9)+   geom_line(color=\"blue\") +   geom_point(data = Y_clr_tidy, alpha=0.5) +   facet_wrap(~coord, scales=\"free_y\") +   theme_minimal()+   theme(axis.title.y = element_blank(),         axis.title.x = element_blank(),         axis.text.x = element_text(angle=45))"},{"path":[]},{"path":"https://jsilve24.github.io/fido/articles/orthus.html","id":"fidoorthus-the-model","dir":"Articles","previous_headings":"","what":"fido::orthus, the model","title":"Joint Modeling  (e.g., Multiomics) with fido::Orthus","text":"fido can used jointly modeling multivariate count data multivariate Gaussian data. example, reasonable model jointly model 16S microbiome data metabolomics data jointly. “two-headed” nature model, e.g., two observed data-sets, named model orthus, two-headed dog brother Cerberus Greek Mythology. orthus model can written \\[ \\begin{align} Y_j & \\sim \\text{Multinomial}\\left(\\pi_j \\right)  \\\\ \\pi_j & = \\phi^{-1}(\\eta_j) \\\\ \\begin{bmatrix}\\eta_j \\\\ Z_j \\end{bmatrix} &\\sim N(\\Lambda X, \\Sigma) \\\\ \\Lambda &\\sim  N(\\Theta, \\Sigma, \\Gamma) \\\\ \\Sigma &\\sim W^{-1}(\\Xi, \\upsilon) \\end{align} \\] Note looks nearly identical pibble model appended second (Gaussian) dataset (\\(Z\\)) onto \\(\\eta\\). , definition \\(\\Lambda\\) changes (now larger bottom rows dictating covariates \\(X\\) influence second dataset). Similarly, \\(\\Sigma\\) now much larger can though \\[ \\Sigma = \\begin{bmatrix} \\Sigma_{(\\eta, \\eta)} & \\Sigma_{(\\eta, Z)} \\\\                           \\Sigma_{(Z, \\eta)} & \\Sigma_{(Z, Z)}\\end{bmatrix} \\] \\(\\Sigma_{(\\eta, \\eta)}\\) describes covariance log-ratios (e.g., covariance among multinomial categories log-ratio space), \\(\\Sigma_{(Z, Z)}\\) describes covariance dimensions \\(Z\\) (e.g., metabolites Z metabolomics data), \\(\\Sigma_{(\\eta, Z)} = \\Sigma_{(Z, \\eta)}^T\\) represents covariance log-ratios dimensions \\(Z\\) (e.g., microbial taxa metabolites). Similar \\(\\Sigma\\) \\(\\Lambda\\), parameters \\(\\Xi\\) \\(\\Theta\\) undergo similar expansion accommodate second dataset.","code":""},{"path":"https://jsilve24.github.io/fido/articles/orthus.html","id":"joint-modeling-of-microbial-16s-data-and-metabolomics","dir":"Articles","previous_headings":"","what":"Joint modeling of Microbial 16S data and Metabolomics","title":"Joint Modeling  (e.g., Multiomics) with fido::Orthus","text":"demonstrate orthus perform toy analysis data Kashyap et al. (2013) made available Callahan et al. (2016) part recently published microbiome data analysis workflow (Callahan et al. 2016). follow data preprocessing Callahan et al. (2016) just don’t drop taxa instead amalgamate don’t pass filtering category called “”. maintain proper variance multinomial model. Now going just bit processing get data format orthus. Note extra metadata just going use intercept model time. Now going set priors. priors going similar pibble now need think prior covariance among metabolites metabolites log-ratios taxa. Remember, priors must defined \\(ALR_D\\) (e.g., ALR reference D-th taxa; may changed future make specifying priors user friendly). going form prior \\(\\Sigma\\) specifying \\(\\upsilon\\) \\(\\Xi\\). specify weak prior belief taxa independent terms log absolute abundance. can translate statement covariance log absolute abundance statement log-ratio covariance pre- post-multiplying \\(ALR_D\\) contrast matrix (refer \\(GG\\) ). Additionally, believe likely substantial covariance taxa metabolites assume metabolites likely independent.  Note structure prior, everything independent moderate positive covariance log-ratios based shared definition terms \\(D\\)-th taxa. parts prior less interesting. going state mean \\(\\Lambda\\) centered \\(\\mathbf{0}\\) signal--noise ratio data approximately 1 (later part specified \\(\\Gamma=\\)). Finally fit model. Next going transform log-ratios \\(ALR_D\\) \\(CLR\\). written transformation functions, e.g., to_clr etc… work orthusfit objects similar manner work pibblefit objects. orthusfit objects transform log-ratio components parameters leaving parts inferred model parameters (.e., parts associated metabolites) untouched.","code":"metab_path <- system.file(\"extdata/Kashyap2013\", \"metabolites.csv\", package=\"fido\") microbe_path <- system.file(\"extdata/Kashyap2013\", \"microbe.rda\", package=\"fido\") metab <- read.csv(metab_path, row.names = 1) metab <- as.matrix(metab) microbe <- get(load(microbe_path))  ## Preprocessing ## # Metabolite Preprocessing keep_ix <- rowSums(metab == 0) <= 3 metab <- metab[keep_ix, ]  # 16S Preprocesing - plus some weirdness to rename amalgamated category to \"other\" keep_ix <- taxa_sums(microbe) > 4 keep_ix <- keep_ix & (rowSums(otu_table(microbe)>2)>3) microbe <- merge_taxa(microbe, taxa_names(microbe)[!keep_ix]) nms <- taxa_names(microbe) rnm <- which(taxa_names(microbe)==taxa_names(microbe)[!keep_ix][1]) nms[rnm] <- \"other\" taxa_names(microbe) <- nms rm(nms, rnm)  # bit of preprocessing  metab <- log10(1 + metab) Y <- otu_table(microbe, taxa_are_rows=TRUE) Z <- metab #(metabolites are rows) X <- matrix(1, 1, phyloseq::nsamples(microbe))  # save dims for easy reference N <- ncol(Y) P <- nrow(Z) Q <- nrow(X) D <- nrow(Y) upsilon <- (D-1+P)+10 # weak-ish prior on covariance over joint taxa and metabolites Xi <- diag(D-1+P) GG <- cbind(diag(D-1), -1) Xi[1:(D-1), 1:(D-1)] <- GG%*%diag(D) %*% t(GG) Xi <- Xi * (upsilon-D-P) # this scales Xi to have the proper mean we wanted image(Xi) Gamma <- diag(Q) Theta <- matrix(0, D-1+P, Q) fit <- orthus(Y, Z, X, Theta=Theta, Gamma=Gamma, Xi=Xi, upsilon=upsilon, n_samples=1000) fit <- to_clr(fit) print(fit) #> orthusfit Object:  #>   Number of Samples:      12  #>   Number of Categories:       114  #>   Number of Zdimensions:  405  #>   Number of Covariates:       1  #>   Number of Posterior Samples:    1000  #>   Contains Samples of Parameters:Eta  Lambda  Sigma #>   Coordinate System:      clr"},{"path":"https://jsilve24.github.io/fido/articles/orthus.html","id":"investigate-model-results","dir":"Articles","previous_headings":"","what":"Investigate Model Results","title":"Joint Modeling  (e.g., Multiomics) with fido::Orthus","text":"ton ways visualize inferred model. make network diagrams relating taxa taxa, taxa metabolites metabolites metabolites. look low dimensional representation joint covariance create something much akin canonical correlation analysis (CCA). look well metabolites predict taxa vice-versa. sake simplicity something much simpler. just going find list taxa metabolite covariances model confident . looks hundred covariances can fairly confident .","code":"# First just look ath the cross-covariances fit by the model # (covariance between taxa in CLR coordinates and metabolites) # This requires that we extract the corner of Sigma.  xcor <- fit$Sigma[1:D, D:(D-1+P),]  # Initial preprocessing to speed up computation of posterior intervals # As there are a lot of cross-covariance terms we are going to first  # weed down the list of things we have to look at by first pass  # selecting only those taxa that have a large posterior mean for the covariance xcor.mean <- apply(xcor, c(1,2), mean) to.analyze <- fido::gather_array(xcor.mean, cov, taxa, metabolite) %>%    arrange(-abs(cov)) %>%    .[1:1000,] %>%    mutate(tm =paste0(taxa, \"_\", metabolite))  # Subset Covariance to those we are interested in and calculate posterior  # confidence intervals.  xcor.summary <- fido::gather_array(xcor, cov, taxa, metabolite, iter) %>%   mutate(tm=paste0(taxa, \"_\", metabolite)) %>%    filter(tm %in% to.analyze$tm) %>%    mutate(taxa = rownames(Y)[taxa], metabolite = rownames(Z)[metabolite]) %>%    group_by(taxa, metabolite) %>%    fido:::summarise_posterior(cov) %>%    arrange(mean) %>%    filter(taxa != 'other') # we don't care about these  # Select those covariances where the model has high certainty (95%) that # the true covariance is not zero.  xcor.summary %>%    filter(sign(p2.5)==sign(p97.5)) %>%    filter(abs(mean) > 2) #> # A tibble: 218 x 8 #> # Groups:   taxa [17] #>    taxa  metabolite   p2.5   p25   p50  mean   p75  p97.5 #>    <chr> <chr>       <dbl> <dbl> <dbl> <dbl> <dbl>  <dbl> #>  1 722   206.0445922 -6.55 -3.96 -3.08 -3.33 -2.32 -1.51  #>  2 7816  206.0445922 -5.63 -3.23 -2.45 -2.65 -1.85 -1.05  #>  3 722   290.9298419 -5.18 -3.09 -2.42 -2.62 -1.85 -1.23  #>  4 18182 380.1846197 -5.20 -3.07 -2.38 -2.55 -1.83 -1.03  #>  5 722   181.4504354 -5.19 -3.04 -2.36 -2.55 -1.80 -1.13  #>  6 722   177.0565368 -4.98 -3.01 -2.30 -2.50 -1.78 -1.08  #>  7 722   180.072273  -5.03 -3.06 -2.30 -2.49 -1.71 -0.986 #>  8 19517 380.1846197 -5.15 -3.06 -2.33 -2.49 -1.71 -0.952 #>  9 2943  380.1846197 -4.89 -2.97 -2.34 -2.49 -1.83 -1.03  #> 10 722   176.0343919 -4.93 -2.95 -2.25 -2.48 -1.79 -1.09  #> # ... with 208 more rows"},{"path":"https://jsilve24.github.io/fido/articles/orthus.html","id":"qualifications-and-caution","dir":"Articles","previous_headings":"","what":"Qualifications and Caution","title":"Joint Modeling  (e.g., Multiomics) with fido::Orthus","text":"Please note, performed analysis demonstrate use orthus model repeatedly asked . think cool model quite useful right circumstances. like point philosophical points analysis performed . First, performed analysis just demonstrate orthus. really don’t know data showcased . metabolite 206.0445922? idea. reason metabolites dataset named. reason left taxa indexed sequence variant number. Second (important), identifying relationships taxa metabolites (two high-dimensional multivariate data-sets) really difficult! looking just 114 taxa 405 leads 46170 possible covariances 12 samples! Yes orthus Bayesian model, Yes, Bayesian models can quite useful parameters samples, limit reasonability. Really, Bayesian models great can perfectly capture prior beliefs prior. often can really done perfectly? caution users, use orthus carefully. Consider metabolites taxa really care can, isolate analyses . Alright, ’s probably enough philosophizing R package Vignette. hope enjoy orthus.","code":""},{"path":[]},{"path":"https://jsilve24.github.io/fido/articles/picking_priors.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Picking Priors","text":"Picking priors important difficult part Bayesian statistics. vignette intended introduction Bayesian statistics, assume readers already know prior/posterior . Just review, prior probability distribution representing analysts belief model parameters prior seeing data. posterior (sense optimal) probability distribution representing belief seen data (given prior beliefs). Since priors represent analysts belief prior seeing data, makes sense priors often specific given study. example, don’t necessarily believe parameters learned RNA-seq data analysis someone studying microbial communities political gerrymandering. ’s , probably different prior beliefs depending microbial community studying study set . (least) two important reasons think carefully priors. First, meaning posterior conditioned prior accurately reflecting beliefs. posterior represents optimal belief given data given prior beliefs. specified prior reflect beliefs well prior won’t right meaning. course priors imperfect best can. Second, practical note, really weird priors can lead numerical issues optimization uncertainty quantification fido. later problem can appear failure reach MAP estimate error trying invert Hessian. Overall, prior single function (probability distribution) specified jointly parameters interest. Still, can confusing think prior joint form. instead try simplify break prior distinct components. numerous models fido, focus prior pibble model , opinion, heart fido. Just review, pibble model given : \\[ \\begin{align} Y_j & \\sim \\text{Multinomial}\\left(\\pi_j \\right)  \\\\ \\pi_j & = \\phi^{-1}(\\eta_j) \\\\ \\eta_j &\\sim N(\\Lambda X_j, \\Sigma) \\\\ \\Lambda &\\sim  N(\\Theta, \\Sigma, \\Gamma) \\\\ \\Sigma &\\sim W^{-1}(\\Xi, \\upsilon). \\end{align} \\] consider first two lines part likelihood bottom three lines part prior. Therefore following three components prior: prior \\(\\Sigma\\): \\(\\Sigma \\sim W^{-1}(\\Xi, \\upsilon)\\) prior \\(\\Lambda\\): \\(\\Lambda \\sim N(\\Theta, \\Sigma, \\Gamma)\\) prior \\(\\eta_j\\): \\(\\eta_j \\sim N(\\Lambda X_j, \\Sigma)\\)","code":""},{"path":"https://jsilve24.github.io/fido/articles/picking_priors.html","id":"background-on-the-matrix-normal","dir":"Articles","previous_headings":"","what":"Background on the Matrix Normal","title":"Picking Priors","text":"three things explain going forward. vec operation, Kronecker product, matrix normal. first two needed understand matrix-normal.","code":""},{"path":"https://jsilve24.github.io/fido/articles/picking_priors.html","id":"the-vec-operation","dir":"Articles","previous_headings":"Background on the Matrix Normal","what":"The Vec Operation","title":"Picking Priors","text":"vec operation just special way saying column stacking. matrix \\[X = \\begin{bmatrix} & b \\\\ c & d \\end{bmatrix}\\] \\[vec(X) = \\begin{bmatrix} \\\\ c \\\\ b\\\\d\\end{bmatrix}.\\] ’s simple.","code":""},{"path":"https://jsilve24.github.io/fido/articles/picking_priors.html","id":"kronker-products","dir":"Articles","previous_headings":"Background on the Matrix Normal","what":"Kronker Products","title":"Picking Priors","text":"turns many different definitions multiply two matrices together. standard matrix multiplication, element-wise multiplication, also something called Kronecker product. Given two matrices \\(X = \\begin{bmatrix} x_{11} & x_{12} \\\\ x_{21} & x_{22} \\end{bmatrix}\\) \\(Y = \\begin{bmatrix} y_{11} & y_{12} \\\\ y_{21} & y_{22} \\end{bmatrix}\\), define Kronecker product \\(X\\) \\(Y\\) \\[ X \\otimes Y = \\begin{bmatrix}x_{11}Y & x_{12}Y \\\\ x_{21}Y & x_{22}Y \\end{bmatrix} = \\begin{bmatrix} x_{11}y_{11} & x_{11}y_{12} & x_{12}y_{11} & x_{12}y_{12} \\\\ x_{11}y_{21} & x_{11}y_{22} & x_{12}y_{21} & x_{12}y_{22} \\\\                 x_{21}y_{11} & x_{21}y_{12} & x_{22}y_{11} & x_{22}y_{12} \\\\ x_{21}y_{21} & x_{21}y_{22} & x_{22}y_{21} & x_{22}y_{22} \\\\   \\end{bmatrix}. \\] Notice essentially making larger matrix patterning Y X?","code":""},{"path":"https://jsilve24.github.io/fido/articles/picking_priors.html","id":"the-matrix-normal","dir":"Articles","previous_headings":"Background on the Matrix Normal","what":"The Matrix Normal","title":"Picking Priors","text":"going forward may wondering normal prior \\(\\Lambda\\) three parameters (\\(\\Theta\\), \\(\\Sigma\\), \\(\\Gamma\\)) rather two. means prior \\(\\Lambda\\) matrix normal rather multivariate normal. matrix normal generalization multivariate normal random matrices (just random vectors). simplified description matrix normal. multivariate normal mean vector covariance matrix describing spread distribution mean. matrix normal mean matrix, two covariance matrices describing spread distribution mean. first covariance matrix (\\(\\Sigma\\)) describes covariance rows \\(\\Lambda\\) second covariance matrix (\\(\\Gamma\\)). describes covariance columns \\(\\Lambda\\). relationship multivariate normal matrix normal follows. \\[\\Lambda \\sim N(\\Theta, \\Sigma, \\Gamma) \\leftrightarrow vec(\\Lambda) \\sim N(vec(\\Theta), \\Gamma \\otimes \\Sigma)\\] \\(\\otimes\\) represents Kronecker product \\(vec\\) represents vectorization operation (.e., column stacking matrix produce long vector). can now ask, distribution single element \\(\\Lambda\\)? answer simply \\[\\Lambda_{ij} \\sim N(\\Theta_{ij}, \\Sigma_{ii}\\Gamma_{jj}).\\] Similarly, can ask distribution single column \\(\\Lambda\\): \\[\\Lambda_{\\cdot j} \\sim N(\\Theta_{\\cdot j}, \\Gamma_{jj} \\Sigma).\\] Make sense? take look wikipedia complete treatment matrix-normal.","code":""},{"path":"https://jsilve24.github.io/fido/articles/picking_priors.html","id":"the-prior-for-sigma","dir":"Articles","previous_headings":"","what":"The prior for \\(\\Sigma\\)","title":"Picking Priors","text":"\\(\\Sigma\\) describes covariance log-ratios. \\(\\phi^{-1}\\) inverse \\(ALR_D\\) transform \\(\\Sigma\\) describes covariance \\(ALR_D\\) coordinates. Also note, section going hardest one, priors components faster describe probably easier understand.","code":""},{"path":"https://jsilve24.github.io/fido/articles/picking_priors.html","id":"background-on-the-prior","dir":"Articles","previous_headings":"The prior for \\(\\Sigma\\)","what":"Background on the Prior","title":"Picking Priors","text":"prior \\(\\Sigma\\) Inverse Wishart written \\[\\Sigma \\sim W^{-1}(\\Xi, \\upsilon)\\] \\(\\Xi\\) called scale matrix (must valid covariance matrix ), \\(\\upsilon\\) called degrees freedom parameter. \\(\\Sigma\\) \\((D-1)x(D-1)\\) matrix, constraint \\(\\upsilon\\) \\(\\upsilon \\geq D-1\\). inverse Wishart mildly complex form moments (e.g., mean variance). mean given \\[E[\\Sigma] = \\frac{\\Xi}{\\upsilon-D-2} \\quad \\text{} \\upsilon > D.\\] variance somewhat complicated (Wikipedia gives relationships) purposes can think \\(\\upsilon\\) setting variance, larger \\(\\upsilon\\) means less uncertainty (lower variance) mean, smaller \\(\\upsilon\\) means uncertainty (higher variance) mean.","code":""},{"path":"https://jsilve24.github.io/fido/articles/picking_priors.html","id":"choosing-upsilon-and-xi-","dir":"Articles","previous_headings":"The prior for \\(\\Sigma\\)","what":"Choosing \\(\\upsilon\\) and \\(\\Xi\\).","title":"Picking Priors","text":"Reading may seem intimidating: ’s form mean… ? ’s-think covariance log-ratios? ’s think . think -terms putting prior true abundances log-space transforming prior log-ratios. can really explain need explain bit background. Compositional Data Analysis Nutshell turns transforms \\(\\phi\\) examples log-ratio transforms studied field called compositional data analysis. Briefly, transforms can written form: \\(\\eta = \\Psi \\log \\pi\\). log-ratios (\\(\\eta\\)) just linear transform log-transformed relative-abundances. turns special properties \\(\\Psi\\), following also holds: \\(\\eta = \\Psi \\log w\\) \\(w\\) absolute (relative) abundances. can say log-ratios also just linear transform log-transformed absolute-abundances. Linear Transformations Covariance Matricies Recall \\(x \\sim N(\\mu, \\Sigma)\\) (multivariate \\(x\\)) matrix \\(\\Psi\\) \\(\\Psi x \\sim N(\\Psi \\mu, \\Psi \\Sigma \\Psi^T)\\). say think linear transformations covariance matrices applied pre post multiplying transformation matrix \\(\\Psi\\). Linear transformation Inverse Wishart turns \\(\\Omega \\sim W^{-1}(\\gamma, S)\\) \\(D\\times D\\) covariance matrix \\(\\Omega\\) \\(M\\times D\\) matrix \\(\\Psi\\) \\(\\Psi \\Omega \\Psi^T \\sim W^{-1}(\\upsilon, \\Psi S \\Psi^T)\\). Putting Together central question: reasonable prior log-ratios? used working log-ratios difficult. potentially simpler problem place prior log-absolute-abundances (\\(\\Omega\\)) whatever measuring, e.g., placing prior covariance log-absolute-abundances bacteria (\\(\\Omega \\sim W^{-1}(\\gamma, S)\\). example: Lets say given microbiome dataset, weak prior belief , average, taxa independent variance 1. want come values \\(\\gamma\\) \\(S\\) prior \\(\\Omega\\) reflect . Lets start specifying mean \\(\\Omega\\). \\[E[\\Omega] =I_D.\\] Next say little certainty mean (want high variance) set \\(\\gamma\\) close lower bound \\(D\\) (often like \\(\\gamma=D+3\\)). Now \\(\\gamma\\) need calculate \\(S\\) solving \\(S\\) equation Inverse-Wishart mean1: \\[S = E[\\Omega](\\gamma -D-1).\\] go ’s prior log-absolute-abundances. Next need transform prior log-ratios. Well allows us simplifying taking contrast matrix \\(\\Psi\\) log-ratio transform want transforming prior \\(\\Omega\\) \\(\\Sigma \\sim W^{-1}(\\gamma, \\Psi S \\Psi^T)\\). ’s prior log-ratios built form prior log-absolute-abundances. Note Phylogenetic priors: phylogenetic linear models, can make \\(S\\) (defined ) covariance derived phylogenetic differences taxa. allows fit phylogenetic linear models fido. Making Even Simpler Say prior \\(\\Omega \\sim W^{-1}(\\gamma, S)\\) covariance log-absolute-abundances (created example ). want transform prior \\(\\Sigma \\sim W^{-1}(\\upsilon, \\Xi)\\). simply taking \\(\\upsilon=\\gamma\\). calculate \\(\\Xi\\), rather worrying \\(\\Psi\\), functions driver package wrote , recipes: Hopefully simple enough useful folks.","code":"# To put prior on ALR_j coordinates for some j in (1,...,D-1) Xi <- clrvar2alrvar(S, j) # To put prior in a particular ILR coordinate defined by contrast matrix V Xi <- clrvar2ilrvar(S, V) # To put prior in CLR coordinates (this one needs two transforms) foo <- clrvar2alrvar(S, D) Xi <- alrvar2clrvar(foo, D)"},{"path":"https://jsilve24.github.io/fido/articles/picking_priors.html","id":"the-prior-for-lambda","dir":"Articles","previous_headings":"","what":"The prior for \\(\\Lambda\\)","title":"Picking Priors","text":"\\(\\Lambda\\) regression parameters linear model. prior \\(\\Lambda\\) just matrix-normal described : \\[\\Lambda \\sim N(\\Theta, \\Sigma, \\Gamma).\\] \\(\\Theta\\) mean matrix \\(\\Lambda\\), \\(\\Sigma\\) actually random (.e., don’t specify , specified prior \\(\\Sigma\\) discussed already), \\(\\Gamma\\) \\(QxQ\\)2 covariance matrix describing covariance columns \\(\\Lambda\\) (.e., effect different covariates). really need just discuss specifying \\(\\Theta\\) specifying \\(\\Gamma\\).","code":""},{"path":"https://jsilve24.github.io/fido/articles/picking_priors.html","id":"choosing-theta","dir":"Articles","previous_headings":"The prior for \\(\\Lambda\\)","what":"Choosing \\(\\Theta\\)","title":"Picking Priors","text":"really easy, situations simply matrix zeros. implies expect average, covariates interest associated composition.3. helps prevent inferrign effect isn’t one. Outside simple case lets say actually prior knowledge effects covariates. Perhaps knowledge mean effect covariates log-absolute-abundances describe \\(D\\times Q\\) matrix \\(\\). Well can just transform prior log-ratio coordinates want follows:","code":"# Transform from log-absolute-abundance effects to effects on absolute-abundances foo <- exp(A) # To put prior on ALR_j coordinates for some j in (1,...,D-1) Theta <- driver::alr_array(foo, j, parts=1) # To put prior in a particular ILR coordinate defined by contrast matrix V Theta <- driver::ilr_array(foo, V, parts=1) # To put prior in CLR coordinates Theta <- driver::clr_array(foo, parts=1)"},{"path":"https://jsilve24.github.io/fido/articles/picking_priors.html","id":"choosing-gamma","dir":"Articles","previous_headings":"The prior for \\(\\Lambda\\)","what":"Choosing \\(\\Gamma\\)","title":"Picking Priors","text":"Alright, get break \\(\\Gamma\\) doesn’t care log-ratio coordinates . ’s just \\(Q\\times Q\\) covariance matrix describing covariation effects \\(Q\\) covariates. example, Lets say data microbiome survey disease number healthy controls. goal figure different composition two groups. model may two covariates, intercept binary variable (1 sample disease, 0 healthy). probably want set prior allows intercept moderately large likely believe differences disease health small (want effect binary covariate modest). specify: \\[\\Gamma = \\alpha\\begin{bmatrix} 1 & 0 \\\\ 0& .2 \\end{bmatrix}\\] scalar \\(\\alpha\\) discuss depth . Note diagonals zero also specifies don’t think covariation intercept effect disease state (probably pretty good assumption example). choice alpha can important. describe later section choice \\(\\upsilon\\) \\(\\Xi\\) interact choice \\(\\Gamma\\). First need briefly describe prior \\(\\eta\\).","code":""},{"path":"https://jsilve24.github.io/fido/articles/picking_priors.html","id":"the-prior-for-eta","dir":"Articles","previous_headings":"","what":"The Prior for \\(\\eta\\)","title":"Picking Priors","text":"\\(\\eta\\) log-ratios regression relationship obscured noise. \\[\\eta_j \\sim N(\\Lambda X_j, \\Sigma).\\] Notice \\(\\Sigma\\) shows like prior \\(\\Lambda\\). Actually, parameters need specify, prior \\(\\eta\\) completely induced based priors \\(\\Lambda\\) \\(\\Sigma\\). reason discuss want readers recognize variation \\(\\eta\\) regression relationship specified \\(\\Sigma\\). means \\(\\Sigma\\) large noise, small less noise. also taken account specifying \\(\\upsilon\\) \\(\\Xi\\). next section expand idea.","code":""},{"path":"https://jsilve24.github.io/fido/articles/picking_priors.html","id":"how-the-choice-of-upsilon-and-xi-interacts-with-the-choice-of-gamma","dir":"Articles","previous_headings":"","what":"How the Choice of \\(\\upsilon\\) and \\(\\Xi\\) Interacts With the Choice of \\(\\Gamma\\)","title":"Picking Priors","text":"point subsection following, choice \\(\\Gamma\\), \\(\\Xi\\), \\(\\upsilon\\) senses place prior signal--noise ratio data. short: larger \\(\\Gamma\\) relative \\(\\Sigma\\) (specified \\(\\upsilon\\) \\(\\Xi\\)) signal, smaller \\(\\Gamma\\) realtive \\(\\Sigma\\) noise. describe . Notice alternatively write prior \\(\\eta\\) \\[\\eta \\sim N(\\Lambda X, \\Sigma, )\\] using matrix normal parallel prior \\(\\Lambda\\) \\[\\Lambda \\sim N(\\Theta, \\Sigma, \\Gamma).\\] can write vec form relationships \\[ \\begin{align} vec(\\eta) &\\sim N(vec(\\Lambda X), \\otimes\\Sigma) \\\\ vec(\\Lambda) &\\sim N(vec(\\Theta), \\Gamma \\otimes \\Sigma). \\end{align} \\] write \\(\\Gamma\\) multiplication scalar scaled matrix (matrix scaled sum diagonals equals 1) \\(\\Gamma=\\alpha \\bar{\\Gamma}\\) describing choice \\(\\Gamma\\) , equations turn : \\[ \\begin{align} vec(\\eta) &\\sim N(vec(\\Lambda X), 1(\\otimes\\Sigma)) \\\\ vec(\\Lambda) &\\sim N(vec(\\Theta), \\alpha(\\bar{\\Gamma}\\otimes \\Sigma)). \\end{align} \\] can see magnitude \\(\\Lambda\\) factor \\(\\alpha\\) times noise level. \\(\\alpha<1\\) magnitude \\(\\Lambda\\) smaller magnitude noise. \\(\\alpha > 1\\) magnitude \\(\\Lambda\\) greater magnitude noise. actual “signal” product \\(\\Lambda X\\) (depends scale \\(X\\)) well hopefully point clear: magnitude \\(\\Sigma\\) (specified \\(\\upsilon\\) \\(\\Xi\\)) comparision magnitude \\(\\Gamma\\) sets signal--noise ratio prior.","code":""},{"path":"https://jsilve24.github.io/fido/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Justin Silverman. Author. Kim Roche. Contributor. Michelle Nixon. Contributor, maintainer.","code":""},{"path":"https://jsilve24.github.io/fido/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Silverman, JD, Roche, K, Holmes, ZC, David, LA, Mukherjee, S. Bayesian Multinomial Logistic Normal Models Marginally Latent Matrix-T Processes. 2022, Journal Machine Learning Research.","code":"@Article{,   title = {Bayesian Multinomial Logistic Normal Models through Marginally Latent Matrix-T Processes},   author = {Justin D Silverman and Kim Roche and Zachary C Holmes and Lawrence A David and Sayan Mukherjee},   year = {2022},   volume = {23},   journal = {Journal of Machine Learning Research},   url = {https://www.jmlr.org/papers/v23/19-882.html}, }"},{"path":"https://jsilve24.github.io/fido/index.html","id":"fido-formerly-stray","dir":"","previous_headings":"","what":"Bayesian Multiniomial Logisic Normal Models (really fast)","title":"Bayesian Multiniomial Logisic Normal Models (really fast)","text":"Multinomial Logistic-Normal Models (really fast) little tar-ball joy","code":""},{"path":"https://jsilve24.github.io/fido/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Bayesian Multiniomial Logisic Normal Models (really fast)","text":"Silverman, JD, Roche, K, Holmes, ZC, David, LA, Mukherjee, S. Journal Machine Learning Research. 23(7), 2022:1−42.","code":""},{"path":"https://jsilve24.github.io/fido/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Bayesian Multiniomial Logisic Normal Models (really fast)","text":"source code freely availale GPL-3 License.","code":""},{"path":"https://jsilve24.github.io/fido/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Bayesian Multiniomial Logisic Normal Models (really fast)","text":"download development version GitHub: notes: version 1.0.0, fido now CRAN. installation options can greatly speed fido (often much 10-50 fold). detailed description installation, take look installation page. Vignettes prebuilt fido webpage. want vignettes build locally package installation must also pass build=TRUE build_opts = c(\"---resave-data\", \"---manual\") options install_github.","code":"install.packages(\"fido\") devtools::install_github(\"jsilve24/fido\", ref=\"develop\")"},{"path":"https://jsilve24.github.io/fido/index.html","id":"vignettes","dir":"","previous_headings":"","what":"Vignettes","title":"Bayesian Multiniomial Logisic Normal Models (really fast)","text":"Introduction fido::Pibble Non-linear models fido::basset Joint Modeling (e.g., Multinomics) fido::Orthus Tips Specifying Priors Mitigating PCR bias","code":""},{"path":"https://jsilve24.github.io/fido/index.html","id":"research-using-fido","dir":"","previous_headings":"","what":"Research Using fido","title":"Bayesian Multiniomial Logisic Normal Models (really fast)","text":"Silverman et al., Bayesian Multinomial Logistic Normal Models Marginally Latent Matrix-T Processes Silverman et al., Measuring Mitigating PCR Bias Microbiome Data Holmes et al., Short-Chain Fatty Acid Production Gut Microbiota Children Obesity Differs According Prebiotic Choice Bacterial Community Composition Silverman et al., Using Influenza surveillance ntworks estimate state-specific prevalance SARS-CoV-2 United States","code":""},{"path":"https://jsilve24.github.io/fido/index.html","id":"bugsfeature-requests","dir":"","previous_headings":"","what":"Bugs/Feature requests","title":"Bayesian Multiniomial Logisic Normal Models (really fast)","text":"checked FAQ? appreciate bug reports feature requests. Please post github issue tracker .","code":""},{"path":"https://jsilve24.github.io/fido/reference/access_dims.html","id":null,"dir":"Reference","previous_headings":"","what":"Generic method for accessing model fit dimensions — ncategories.pibblefit","title":"Generic method for accessing model fit dimensions — ncategories.pibblefit","text":"Generic method accessing model fit dimensions","code":""},{"path":"https://jsilve24.github.io/fido/reference/access_dims.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generic method for accessing model fit dimensions — ncategories.pibblefit","text":"","code":"# S3 method for pibblefit ncategories(m)  # S3 method for pibblefit nsamples(m)  # S3 method for pibblefit ncovariates(m)  # S3 method for pibblefit niter(m)  # S3 method for orthusfit ncategories(m)  # S3 method for orthusfit nsamples(m)  # S3 method for orthusfit ncovariates(m)  # S3 method for orthusfit niter(m)  ncategories(m)  nsamples(m)  ncovariates(m)  niter(m)"},{"path":"https://jsilve24.github.io/fido/reference/access_dims.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generic method for accessing model fit dimensions — ncategories.pibblefit","text":"m object class pibblefit","code":""},{"path":"https://jsilve24.github.io/fido/reference/access_dims.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generic method for accessing model fit dimensions — ncategories.pibblefit","text":"integer","code":""},{"path":"https://jsilve24.github.io/fido/reference/access_dims.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generic method for accessing model fit dimensions — ncategories.pibblefit","text":"alternative approach accessing dimensions    access directly pibblefit object using list indexing.  * ncategories equivalent m$D * nsamples equivalent m$N * ncovariates equivalent m$Q","code":""},{"path":"https://jsilve24.github.io/fido/reference/alr.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the ALR of a matrix — alr","title":"Compute the ALR of a matrix — alr","text":"Compute ALR matrix","code":""},{"path":"https://jsilve24.github.io/fido/reference/alr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the ALR of a matrix — alr","text":"","code":"alr(x, d = NULL)"},{"path":"https://jsilve24.github.io/fido/reference/alr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the ALR of a matrix — alr","text":"x matrix rows samples d Index column used reference. Defaults last column","code":""},{"path":"https://jsilve24.github.io/fido/reference/alr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the ALR of a matrix — alr","text":"matrix","code":""},{"path":"https://jsilve24.github.io/fido/reference/alrInv.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the inverse ALR of a matrix — alrInv","title":"Compute the inverse ALR of a matrix — alrInv","text":"Compute inverse ALR matrix","code":""},{"path":"https://jsilve24.github.io/fido/reference/alrInv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the inverse ALR of a matrix — alrInv","text":"","code":"alrInv(y, d = NULL)"},{"path":"https://jsilve24.github.io/fido/reference/alrInv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the inverse ALR of a matrix — alrInv","text":"y ALR transformed matrix d Index column used reference. Defaults last column","code":""},{"path":"https://jsilve24.github.io/fido/reference/alrInv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the inverse ALR of a matrix — alrInv","text":"matrix","code":""},{"path":"https://jsilve24.github.io/fido/reference/alrInv_array.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the ALR of an array — alrInv_array","title":"Compute the ALR of an array — alrInv_array","text":"Compute ALR array","code":""},{"path":"https://jsilve24.github.io/fido/reference/alrInv_array.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the ALR of an array — alrInv_array","text":"","code":"alrInv_array(y, d = dim(y)[coords] + 1, coords)"},{"path":"https://jsilve24.github.io/fido/reference/alrInv_array.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the ALR of an array — alrInv_array","text":"y multidimensional ALR transformed array d Index column used reference. Defaults last column coords index dimension `x` represents coordinates","code":""},{"path":"https://jsilve24.github.io/fido/reference/alrInv_array.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the ALR of an array — alrInv_array","text":"array","code":""},{"path":"https://jsilve24.github.io/fido/reference/alr_array.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the ALR of an array — alr_array","title":"Compute the ALR of an array — alr_array","text":"Compute ALR array","code":""},{"path":"https://jsilve24.github.io/fido/reference/alr_array.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the ALR of an array — alr_array","text":"","code":"alr_array(x, d = dim(x)[parts], parts)"},{"path":"https://jsilve24.github.io/fido/reference/alr_array.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the ALR of an array — alr_array","text":"x multidimensional array simplex d Index column used reference. Defaults last column parts index dimension `x` represents parts","code":""},{"path":"https://jsilve24.github.io/fido/reference/alr_array.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the ALR of an array — alr_array","text":"array","code":""},{"path":"https://jsilve24.github.io/fido/reference/as.list.orthusfit.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert object of class orthusfit to a list — as.list.orthusfit","title":"Convert object of class orthusfit to a list — as.list.orthusfit","text":"Convert object class orthusfit list","code":""},{"path":"https://jsilve24.github.io/fido/reference/as.list.orthusfit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert object of class orthusfit to a list — as.list.orthusfit","text":"","code":"# S3 method for orthusfit as.list(x, ...)"},{"path":"https://jsilve24.github.io/fido/reference/as.list.orthusfit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert object of class orthusfit to a list — as.list.orthusfit","text":"x object class orthusfit ... currently unused","code":""},{"path":"https://jsilve24.github.io/fido/reference/as.list.orthusfit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert object of class orthusfit to a list — as.list.orthusfit","text":"list converted orthusfit object","code":""},{"path":"https://jsilve24.github.io/fido/reference/as.list.pibblefit.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert object of class pibblefit to a list — as.list.pibblefit","title":"Convert object of class pibblefit to a list — as.list.pibblefit","text":"Convert object class pibblefit list","code":""},{"path":"https://jsilve24.github.io/fido/reference/as.list.pibblefit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert object of class pibblefit to a list — as.list.pibblefit","text":"","code":"# S3 method for pibblefit as.list(x, ...)"},{"path":"https://jsilve24.github.io/fido/reference/as.list.pibblefit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert object of class pibblefit to a list — as.list.pibblefit","text":"x object class pibblefit ... currently unused","code":""},{"path":"https://jsilve24.github.io/fido/reference/as.list.pibblefit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert object of class pibblefit to a list — as.list.pibblefit","text":"list converted pibblefit object.","code":""},{"path":"https://jsilve24.github.io/fido/reference/as.orthusfit.html","id":null,"dir":"Reference","previous_headings":"","what":"convert list to orthusfit — as.orthusfit","title":"convert list to orthusfit — as.orthusfit","text":"convert list orthusfit","code":""},{"path":"https://jsilve24.github.io/fido/reference/as.orthusfit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"convert list to orthusfit — as.orthusfit","text":"","code":"as.orthusfit(object)"},{"path":"https://jsilve24.github.io/fido/reference/as.orthusfit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"convert list to orthusfit — as.orthusfit","text":"object list object","code":""},{"path":"https://jsilve24.github.io/fido/reference/as.orthusfit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"convert list to orthusfit — as.orthusfit","text":"orthusfit object","code":""},{"path":"https://jsilve24.github.io/fido/reference/as.pibblefit.html","id":null,"dir":"Reference","previous_headings":"","what":"convert list to pibblefit — as.pibblefit","title":"convert list to pibblefit — as.pibblefit","text":"convert list pibblefit","code":""},{"path":"https://jsilve24.github.io/fido/reference/as.pibblefit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"convert list to pibblefit — as.pibblefit","text":"","code":"as.pibblefit(object)"},{"path":"https://jsilve24.github.io/fido/reference/as.pibblefit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"convert list to pibblefit — as.pibblefit","text":"object list object","code":""},{"path":"https://jsilve24.github.io/fido/reference/as.pibblefit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"convert list to pibblefit — as.pibblefit","text":"pibblefit object","code":""},{"path":"https://jsilve24.github.io/fido/reference/basset_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Interface to fit basset models — basset_fit","title":"Interface to fit basset models — basset_fit","text":"Basset (Lazy Learner) - non-linear regression models fido","code":""},{"path":"https://jsilve24.github.io/fido/reference/basset_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Interface to fit basset models — basset_fit","text":"","code":"basset(   Y = NULL,   X,   upsilon = NULL,   Theta = NULL,   Gamma = NULL,   Xi = NULL,   linear = NULL,   init = NULL,   pars = c(\"Eta\", \"Lambda\", \"Sigma\"),   newdata = NULL,   ... )  # S3 method for bassetfit refit(m, pars = c(\"Eta\", \"Lambda\", \"Sigma\"), ...)"},{"path":"https://jsilve24.github.io/fido/reference/basset_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Interface to fit basset models — basset_fit","text":"Y D x N matrix counts (NULL uses priors ) X Q x N matrix covariates (NULL) upsilon dof inverse wishart prior (numeric must > D) (default: D+3) Theta function dimensions dim(X) -> (D-1)xN (prior mean gaussian process). additive GP model, can list functions dimensions dim(X) -> (D-1)xN + (optional) matrix size (D-1)xQ prior linear component desired. Gamma function dimension dim(X) -> NxN (kernel matrix gaussian process). additive GP model, can list functions dimension dim(X) -> NxN + QxQ prior covariance matrix linear component specified. assumed order matches order Theta. Xi (D-1)x(D-1) prior covariance matrix (default: ALR transform diag(1)*(upsilon-D)/2 - essentially iid \"base scale\" using Aitchison terminology) linear vector denoting rows X used  linear component specified. Default rows. init (D-1) x Q initialization Eta optimization pars character vector posterior parameters return newdata Default NULL. non-null, newdata used uncollapse sampler place X. ... arguments passed pibble (used internally fit basset model) m object class bassetfit","code":""},{"path":"https://jsilve24.github.io/fido/reference/basset_fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Interface to fit basset models — basset_fit","text":"object class bassetfit","code":""},{"path":"https://jsilve24.github.io/fido/reference/basset_fit.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Interface to fit basset models — basset_fit","text":"full model given : $$Y_j \\sim Multinomial(\\Pi_j)$$ $$\\Pi_j = \\Phi^{-1}(\\Eta_j)$$ $$\\Eta \\sim MN_{D-1 x N}(\\Lambda, \\Sigma, I_N)$$ $$\\Lambda \\sim GP_{D-1 x Q}(\\Theta(X), \\Sigma, \\Gamma(X))$$ $$\\Sigma \\sim InvWish(\\upsilon, \\Xi)$$ Gamma(X) short hand Gram matrix Kernel function. Alternatively can used fit additive GP form: $$Y_j \\sim Multinomial(\\Pi_j)$$ $$\\Pi_j = \\Phi^{-1}(\\Eta_j)$$ $$\\Eta \\sim MN_{D-1 x N}(\\Lambda, \\Sigma, I_N)$$ $$\\Lambda = \\Lambda_1 + ... + \\Lambda_p + \\Beta X$$ $$\\Lambda_1 \\sim GP_{D-1 x Q}(\\Theta_1(X), \\Sigma, \\Gamma_p(X))$$ ... $$\\Lambda_p \\sim GP_{D-1 x Q}(\\Theta_1(X), \\Sigma, \\Gamma_1(X))$$ $$\\Beta \\sim MN(\\Theta_B, \\Sigma, \\Gamma_B)$$ $$\\Sigma \\sim InvWish(\\upsilon, \\Xi)$$ Gamma(X) short hand Gram matrix Kernel function. Default behavior use MAP estimate uncollaping LTP model laplace approximation preformed.","code":""},{"path":"https://jsilve24.github.io/fido/reference/check_dims.html","id":null,"dir":"Reference","previous_headings":"","what":"Check vector/matrix/data.frame for expected dimensions or throw error — check_dims","title":"Check vector/matrix/data.frame for expected dimensions or throw error — check_dims","text":"Check vector/matrix/data.frame expected dimensions throw error","code":""},{"path":"https://jsilve24.github.io/fido/reference/check_dims.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check vector/matrix/data.frame for expected dimensions or throw error — check_dims","text":"","code":"check_dims(x, d, par)"},{"path":"https://jsilve24.github.io/fido/reference/check_dims.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check vector/matrix/data.frame for expected dimensions or throw error — check_dims","text":"x object check d expected dimensions par character name x (error message)","code":""},{"path":"https://jsilve24.github.io/fido/reference/check_dims.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check vector/matrix/data.frame for expected dimensions or throw error — check_dims","text":"nothing error, otherwise throws error","code":""},{"path":"https://jsilve24.github.io/fido/reference/check_dims.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check vector/matrix/data.frame for expected dimensions or throw error — check_dims","text":"","code":"y <- c(1,3,4) check_dims(y, 3, \"y\")"},{"path":"https://jsilve24.github.io/fido/reference/clr_array.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the CLR of an array — clr_array","title":"Compute the CLR of an array — clr_array","text":"Compute CLR array","code":""},{"path":"https://jsilve24.github.io/fido/reference/clr_array.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the CLR of an array — clr_array","text":"","code":"clr_array(x, parts)"},{"path":"https://jsilve24.github.io/fido/reference/clr_array.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the CLR of an array — clr_array","text":"x multidimensional array index parts index dimension `x` represents parts","code":""},{"path":"https://jsilve24.github.io/fido/reference/clr_array.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the CLR of an array — clr_array","text":"array","code":""},{"path":"https://jsilve24.github.io/fido/reference/coef.orthusfit.html","id":null,"dir":"Reference","previous_headings":"","what":"Return regression coefficients of orthus object — coef.orthusfit","title":"Return regression coefficients of orthus object — coef.orthusfit","text":"Orthus: Returned array dimension (D-1+P) x Q x iter (ALR ILR)  otherwise (D+P) x Q x iter.","code":""},{"path":"https://jsilve24.github.io/fido/reference/coef.orthusfit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return regression coefficients of orthus object — coef.orthusfit","text":"","code":"# S3 method for orthusfit coef(object, ...)"},{"path":"https://jsilve24.github.io/fido/reference/coef.orthusfit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Return regression coefficients of orthus object — coef.orthusfit","text":"object object class orthusfit ... options passed coef.orthusfit (see details)","code":""},{"path":"https://jsilve24.github.io/fido/reference/coef.orthusfit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Return regression coefficients of orthus object — coef.orthusfit","text":"Array dimension (D-1) x Q x iter","code":""},{"path":"https://jsilve24.github.io/fido/reference/coef.orthusfit.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Return regression coefficients of orthus object — coef.orthusfit","text":"arguments: use_names column row names passed Y X  call pibble, names applied output  array.","code":""},{"path":"https://jsilve24.github.io/fido/reference/coef.pibblefit.html","id":null,"dir":"Reference","previous_headings":"","what":"Return regression coefficients of pibblefit object — coef.pibblefit","title":"Return regression coefficients of pibblefit object — coef.pibblefit","text":"Pibble: Returned array dimension (D-1) x Q x iter (ALR ILR) otherwise DxQxiter (proportions clr).","code":""},{"path":"https://jsilve24.github.io/fido/reference/coef.pibblefit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return regression coefficients of pibblefit object — coef.pibblefit","text":"","code":"# S3 method for pibblefit coef(object, ...)"},{"path":"https://jsilve24.github.io/fido/reference/coef.pibblefit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Return regression coefficients of pibblefit object — coef.pibblefit","text":"object object class pibblefit ... options passed coef.pibblefit (see details)","code":""},{"path":"https://jsilve24.github.io/fido/reference/coef.pibblefit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Return regression coefficients of pibblefit object — coef.pibblefit","text":"Array dimension (D-1) x Q x iter","code":""},{"path":"https://jsilve24.github.io/fido/reference/coef.pibblefit.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Return regression coefficients of pibblefit object — coef.pibblefit","text":"arguments: `use_names` column row names passed Y X  call pibble, names applied output  array.","code":""},{"path":"https://jsilve24.github.io/fido/reference/conjugateLinearModel.html","id":null,"dir":"Reference","previous_headings":"","what":"Solve Bayesian Multivariate Conjugate Linear Model — conjugateLinearModel","title":"Solve Bayesian Multivariate Conjugate Linear Model — conjugateLinearModel","text":"See details model.  Notation: N number samples, D dimension response, Q number covariates.","code":""},{"path":"https://jsilve24.github.io/fido/reference/conjugateLinearModel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Solve Bayesian Multivariate Conjugate Linear Model — conjugateLinearModel","text":"","code":"conjugateLinearModel(Y, X, Theta, Gamma, Xi, upsilon, n_samples = 2000L)"},{"path":"https://jsilve24.github.io/fido/reference/conjugateLinearModel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Solve Bayesian Multivariate Conjugate Linear Model — conjugateLinearModel","text":"Y matrix dimension D x N X matrix covariates dimension Q x N Theta matrix prior mean dimension D x Q Gamma covariance matrix dimension Q x Q Xi covariance matrix dimension D x D upsilon scalar (must > D-1) degrees freedom InvWishart prior n_samples number samples draw (default: 2000)","code":""},{"path":"https://jsilve24.github.io/fido/reference/conjugateLinearModel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Solve Bayesian Multivariate Conjugate Linear Model — conjugateLinearModel","text":"List components Lambda Array dimension (D-1) x Q x n_samples (posterior samples) Sigma Array dimension (D-1) x (D-1) x n_samples (posterior samples)","code":""},{"path":"https://jsilve24.github.io/fido/reference/conjugateLinearModel.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Solve Bayesian Multivariate Conjugate Linear Model — conjugateLinearModel","text":"$$Y ~ MN_{D-1 x N}(Lambda*X, Sigma, I_N)$$ $$Lambda ~ MN_{D-1 x Q}(Theta, Sigma, Gamma)$$ $$Sigma ~ InvWish(upsilon, Xi)$$ function provides means sampling posterior distribution Lambda Sigma.","code":""},{"path":"https://jsilve24.github.io/fido/reference/conjugateLinearModel.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Solve Bayesian Multivariate Conjugate Linear Model — conjugateLinearModel","text":"","code":"sim <- pibble_sim() eta.hat <- t(alr(t(sim$Y+0.65))) fit <- conjugateLinearModel(eta.hat, sim$X, sim$Theta, sim$Gamma,                              sim$Xi, sim$upsilon, n_samples=2000)"},{"path":"https://jsilve24.github.io/fido/reference/convert_orthus_covariance.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert orthus covariance matricies between representations — convert_orthus_covariance","title":"Convert orthus covariance matricies between representations — convert_orthus_covariance","text":"Convert orthus covariance matricies representations","code":""},{"path":"https://jsilve24.github.io/fido/reference/convert_orthus_covariance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert orthus covariance matricies between representations — convert_orthus_covariance","text":"","code":"oilrvar2ilrvar(Sigma, s, V1, V2)  oilrvar2clrvar(Sigma, s, V)  oclrvar2ilrvar(Sigma, s, V)  oalrvar2clrvar(Sigma, s, d1)  oclrvar2alrvar(Sigma, s, d2)  oalrvar2alrvar(Sigma, s, d1, d2)  oalrvar2ilrvar(Sigma, s, d1, V2)  oilrvar2alrvar(Sigma, s, V1, d2)"},{"path":"https://jsilve24.github.io/fido/reference/convert_orthus_covariance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert orthus covariance matricies between representations — convert_orthus_covariance","text":"Sigma covariance matrix arrat specified transformed space  (dim(Sigma)[3]=iter) s first s rows colums Sigma transformed V1 ILR contrast matrix basis Sigma already V2 ILR contrast matrix basis Sigma desired V ILR contrast matrix (.e., transformation matrix ILR) d1 alr reference element Sigma already expressed respec d2 alr reference element Sigma expressed respect ","code":""},{"path":"https://jsilve24.github.io/fido/reference/convert_orthus_covariance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert orthus covariance matricies between representations — convert_orthus_covariance","text":"matrix","code":""},{"path":"https://jsilve24.github.io/fido/reference/create_default_ilr_base.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a default ILR base — create_default_ilr_base","title":"Create a default ILR base — create_default_ilr_base","text":"Create default ILR base","code":""},{"path":"https://jsilve24.github.io/fido/reference/create_default_ilr_base.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a default ILR base — create_default_ilr_base","text":"","code":"create_default_ilr_base(D)"},{"path":"https://jsilve24.github.io/fido/reference/create_default_ilr_base.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a default ILR base — create_default_ilr_base","text":"D number parts (e.g., number columns untransformed data)","code":""},{"path":"https://jsilve24.github.io/fido/reference/create_default_ilr_base.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a default ILR base — create_default_ilr_base","text":"matrix","code":""},{"path":"https://jsilve24.github.io/fido/reference/fido_package.html","id":null,"dir":"Reference","previous_headings":"","what":"fido: Fitting and Analysis of Multinomial Logistic Normal  Models — fido_package","title":"fido: Fitting and Analysis of Multinomial Logistic Normal  Models — fido_package","text":"Provides methods fitting inspection Bayesian Multinomial   Logistic Normal Models using MAP estimation Laplace Approximation.  Key functionality implemented C++ scalability.","code":""},{"path":[]},{"path":"https://jsilve24.github.io/fido/reference/fido_package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"fido: Fitting and Analysis of Multinomial Logistic Normal  Models — fido_package","text":"Maintainer: Michelle Nixon pistner@psu.edu [contributor] Authors: Justin Silverman Justin.Silverman@psu.edu contributors: Kim Roche kimberly.roche@duke.edu [contributor]","code":""},{"path":"https://jsilve24.github.io/fido/reference/fido_transforms.html","id":null,"dir":"Reference","previous_headings":"","what":"Transform Fit fido Parameters to other representations — fido_transforms","title":"Transform Fit fido Parameters to other representations — fido_transforms","text":"collection convenience functions transforming fido fit objects number different representations including ILR bases, CLR coordinates, ALR coordinates, proportions.","code":""},{"path":"https://jsilve24.github.io/fido/reference/fido_transforms.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transform Fit fido Parameters to other representations — fido_transforms","text":"","code":"to_proportions(m)  to_alr(m, d)  to_ilr(m, V = NULL)  to_clr(m)  # S3 method for pibblefit to_proportions(m)  # S3 method for orthusfit to_proportions(m)  # S3 method for pibblefit to_alr(m, d)  # S3 method for orthusfit to_alr(m, d)  # S3 method for pibblefit to_ilr(m, V = NULL)  # S3 method for orthusfit to_ilr(m, V = NULL)  # S3 method for pibblefit to_clr(m)  # S3 method for orthusfit to_clr(m)"},{"path":"https://jsilve24.github.io/fido/reference/fido_transforms.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transform Fit fido Parameters to other representations — fido_transforms","text":"m object class pibblefit orthusfit (e.g., output pibble orthus) d (integer) multinomial category take new alr reference V (matrix) contrast matrix ILR basis transform (defaults  create_default_ilr_base(D))","code":""},{"path":"https://jsilve24.github.io/fido/reference/fido_transforms.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transform Fit fido Parameters to other representations — fido_transforms","text":"object","code":""},{"path":"https://jsilve24.github.io/fido/reference/fido_transforms.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Transform Fit fido Parameters to other representations — fido_transforms","text":"orthus, transforms appleid log-ratio parameters Note: degeneracy representations covariance  matrix represented terms proportions. function  to_proportions attempt transform parameters Sigma prior Xi instead just removes pibblefit object returned.","code":""},{"path":"https://jsilve24.github.io/fido/reference/gather_array.html","id":null,"dir":"Reference","previous_headings":"","what":"Gather Multidimensional Array to Tidy Tibble — gather_array","title":"Gather Multidimensional Array to Tidy Tibble — gather_array","text":"Gather Multidimensional Array Tidy Tibble","code":""},{"path":"https://jsilve24.github.io/fido/reference/gather_array.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gather Multidimensional Array to Tidy Tibble — gather_array","text":"","code":"gather_array(a, value, ..., .id = NULL)"},{"path":"https://jsilve24.github.io/fido/reference/gather_array.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gather Multidimensional Array to Tidy Tibble — gather_array","text":"multidimensional array value unquoted name column values (defaults \"var\") ... unquoted dimension names (defaults \"dim_1\", \"dim_2\", etc...) .id specified, name column created name captured","code":""},{"path":"https://jsilve24.github.io/fido/reference/gather_array.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gather Multidimensional Array to Tidy Tibble — gather_array","text":"data.frame","code":""},{"path":[]},{"path":"https://jsilve24.github.io/fido/reference/gather_array.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gather Multidimensional Array to Tidy Tibble — gather_array","text":"","code":"a <- array(1:100, dim =c(10, 5, 2)) gather_array(a, sequence, A, B, C) #>      A B C sequence #> 1    1 1 1        1 #> 2    2 1 1        2 #> 3    3 1 1        3 #> 4    4 1 1        4 #> 5    5 1 1        5 #> 6    6 1 1        6 #> 7    7 1 1        7 #> 8    8 1 1        8 #> 9    9 1 1        9 #> 10  10 1 1       10 #> 11   1 2 1       11 #> 12   2 2 1       12 #> 13   3 2 1       13 #> 14   4 2 1       14 #> 15   5 2 1       15 #> 16   6 2 1       16 #> 17   7 2 1       17 #> 18   8 2 1       18 #> 19   9 2 1       19 #> 20  10 2 1       20 #> 21   1 3 1       21 #> 22   2 3 1       22 #> 23   3 3 1       23 #> 24   4 3 1       24 #> 25   5 3 1       25 #> 26   6 3 1       26 #> 27   7 3 1       27 #> 28   8 3 1       28 #> 29   9 3 1       29 #> 30  10 3 1       30 #> 31   1 4 1       31 #> 32   2 4 1       32 #> 33   3 4 1       33 #> 34   4 4 1       34 #> 35   5 4 1       35 #> 36   6 4 1       36 #> 37   7 4 1       37 #> 38   8 4 1       38 #> 39   9 4 1       39 #> 40  10 4 1       40 #> 41   1 5 1       41 #> 42   2 5 1       42 #> 43   3 5 1       43 #> 44   4 5 1       44 #> 45   5 5 1       45 #> 46   6 5 1       46 #> 47   7 5 1       47 #> 48   8 5 1       48 #> 49   9 5 1       49 #> 50  10 5 1       50 #> 51   1 1 2       51 #> 52   2 1 2       52 #> 53   3 1 2       53 #> 54   4 1 2       54 #> 55   5 1 2       55 #> 56   6 1 2       56 #> 57   7 1 2       57 #> 58   8 1 2       58 #> 59   9 1 2       59 #> 60  10 1 2       60 #> 61   1 2 2       61 #> 62   2 2 2       62 #> 63   3 2 2       63 #> 64   4 2 2       64 #> 65   5 2 2       65 #> 66   6 2 2       66 #> 67   7 2 2       67 #> 68   8 2 2       68 #> 69   9 2 2       69 #> 70  10 2 2       70 #> 71   1 3 2       71 #> 72   2 3 2       72 #> 73   3 3 2       73 #> 74   4 3 2       74 #> 75   5 3 2       75 #> 76   6 3 2       76 #> 77   7 3 2       77 #> 78   8 3 2       78 #> 79   9 3 2       79 #> 80  10 3 2       80 #> 81   1 4 2       81 #> 82   2 4 2       82 #> 83   3 4 2       83 #> 84   4 4 2       84 #> 85   5 4 2       85 #> 86   6 4 2       86 #> 87   7 4 2       87 #> 88   8 4 2       88 #> 89   9 4 2       89 #> 90  10 4 2       90 #> 91   1 5 2       91 #> 92   2 5 2       92 #> 93   3 5 2       93 #> 94   4 5 2       94 #> 95   5 5 2       95 #> 96   6 5 2       96 #> 97   7 5 2       97 #> 98   8 5 2       98 #> 99   9 5 2       99 #> 100 10 5 2      100"},{"path":"https://jsilve24.github.io/fido/reference/kernels.html","id":null,"dir":"Reference","previous_headings":"","what":"Multivariate RBF Kernel — kernels","title":"Multivariate RBF Kernel — kernels","text":"Designed partially specified. (see examples)","code":""},{"path":"https://jsilve24.github.io/fido/reference/kernels.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multivariate RBF Kernel — kernels","text":"","code":"SE(X, sigma = 1, rho = median(as.matrix(dist(t(X)))), jitter = 1e-10)  LINEAR(X, sigma = 1, c = rep(0, nrow(X)))"},{"path":"https://jsilve24.github.io/fido/reference/kernels.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multivariate RBF Kernel — kernels","text":"X covariate (dimension Q x N; .e., covariates x samples) sigma scalar parameter rho scalar bandwidth parameter jitter small scalar add -diagonal gram matrix  (numerical underflow issues) c vector parameter defining intercept linear kernel","code":""},{"path":"https://jsilve24.github.io/fido/reference/kernels.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multivariate RBF Kernel — kernels","text":"Gram Matrix (N x N) (e.g., Kernel evaluated  pair points)","code":""},{"path":"https://jsilve24.github.io/fido/reference/kernels.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Multivariate RBF Kernel — kernels","text":"Gram matrix G given SE (squared exponential): $$G = \\sigma^2 * exp(-[(X-c)'(X-c)]/(s*\\rho^2))$$ LINEAR: $$G = \\sigma^2*(X-c)'(X-c)$$","code":""},{"path":"https://jsilve24.github.io/fido/reference/lambda_to_iqlr.html","id":null,"dir":"Reference","previous_headings":"","what":"Transform Lambda into IQLR (Inter-Quantile Log-Ratio) — lambda_to_iqlr","title":"Transform Lambda into IQLR (Inter-Quantile Log-Ratio) — lambda_to_iqlr","text":"Takes idea Wu et al. (citation ) calculates IQLR    Lambda, potentially useful believe invariant group    categories (e.g., taxa / genes) changing (absolute abundance)    samples. IQLR defined    $$IQLR_x = log(x_i/g(IQVF))$$   1,...,D.    IQVF CLR coordinates whose variance within inter-quantile range   (defined probs argument function).    different IQVF fit posteior sample IQVFs calculted   based posterior estimates Lambda. variance CLR coordinate   defined norm row Lambda[,focus.cov] (.e.,    covariation Eta, explained covariates). definition    variance allows uses exclude variation technical / trivial sources   calculation IQVF/IQLR.","code":""},{"path":"https://jsilve24.github.io/fido/reference/lambda_to_iqlr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transform Lambda into IQLR (Inter-Quantile Log-Ratio) — lambda_to_iqlr","text":"","code":"lambda_to_iqlr(m, focus.cov = NULL, probs = c(0.25, 0.75))"},{"path":"https://jsilve24.github.io/fido/reference/lambda_to_iqlr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transform Lambda into IQLR (Inter-Quantile Log-Ratio) — lambda_to_iqlr","text":"m object class pibblefit (e.g., output pibble) focus.cov vector integers characters specifying columns (covariates) Lambda include calculating IQLR (NULL, default, uses covariates) probs bounds categories (.e., features / genes / taxa) include  calculation iqlr (smaller bounds means stringent inclusion criteria)","code":""},{"path":"https://jsilve24.github.io/fido/reference/lambda_to_iqlr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transform Lambda into IQLR (Inter-Quantile Log-Ratio) — lambda_to_iqlr","text":"array dimension (D, Q, iter) D number taxa, Q number covariates, iter number posterior samples.","code":""},{"path":"https://jsilve24.github.io/fido/reference/lambda_to_iqlr.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Transform Lambda into IQLR (Inter-Quantile Log-Ratio) — lambda_to_iqlr","text":"Primarily intended differential expression analysis  assumption small group categories (e.g., taxa / genes) changing","code":""},{"path":"https://jsilve24.github.io/fido/reference/lambda_to_iqlr.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Transform Lambda into IQLR (Inter-Quantile Log-Ratio) — lambda_to_iqlr","text":"Jia R. Wu, Jean M. Macklaim, Briana L. Genge, Gregory B. Gloor (2017)   Finding center: corrections asymmetry high-throughput sequencing   datasets. arxiv:1704.01841v1","code":""},{"path":"https://jsilve24.github.io/fido/reference/lambda_to_iqlr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Transform Lambda into IQLR (Inter-Quantile Log-Ratio) — lambda_to_iqlr","text":"","code":"sim <- pibble_sim() fit <- pibble(sim$Y, sim$X) # Use first two covariates to define iqlr, just show first 5 samples lambda_to_iqlr(fit, 1:2)[,,1:5]  #> , , 1 #>  #>              [,1]       [,2] #>  [1,]  2.58249657  6.8209952 #>  [2,] -3.11052569 -2.7167130 #>  [3,]  6.49900999 -0.9183486 #>  [4,]  0.96090295 -1.3229594 #>  [5,]  0.14008132  1.1903585 #>  [6,]  0.49972573 -1.3370605 #>  [7,]  0.08957466  0.2489264 #>  [8,]  0.98513706  2.2548793 #>  [9,] -2.44576574  0.4051406 #> [10,]  1.32535003 -0.1768482 #>  #> , , 2 #>  #>             [,1]       [,2] #>  [1,]  2.5587883  6.1883850 #>  [2,] -3.0405870 -3.0912526 #>  [3,]  5.8512540 -0.6003824 #>  [4,]  0.9609548 -1.9479886 #>  [5,]  0.1591712  0.6891760 #>  [6,]  1.1055174 -0.9062200 #>  [7,] -0.1774132 -0.1424990 #>  [8,]  0.2053178  3.0132894 #>  [9,] -2.2717900 -0.1590809 #> [10,]  0.8722740 -0.3306140 #>  #> , , 3 #>  #>              [,1]        [,2] #>  [1,]  2.60530636  5.21789900 #>  [2,] -2.54326545 -2.38212939 #>  [3,]  7.08497756 -0.21955481 #>  [4,]  1.31994025 -0.76897135 #>  [5,]  0.31169726  1.00375772 #>  [6,]  1.08657901 -1.45658403 #>  [7,]  0.04131485 -0.06377461 #>  [8,]  0.32288955  2.57115035 #>  [9,] -2.72940881 -0.34559497 #> [10,]  1.47805346 -0.38137550 #>  #> , , 4 #>  #>             [,1]        [,2] #>  [1,]  3.3439506  4.57514801 #>  [2,] -3.7370334 -3.32615210 #>  [3,]  5.8688759 -0.94841909 #>  [4,]  1.0464624 -1.07088958 #>  [5,]  0.5365942 -0.07507684 #>  [6,]  0.8422877 -1.53300228 #>  [7,] -0.1707247 -0.73045076 #>  [8,]  0.4358403  2.39571374 #>  [9,] -1.1074033 -0.13226070 #> [10,]  1.2253342 -0.65615197 #>  #> , , 5 #>  #>             [,1]        [,2] #>  [1,]  2.7120487  6.38024654 #>  [2,] -2.4680663 -2.88067266 #>  [3,]  5.2612425 -0.03676643 #>  [4,]  1.1926378 -1.48758213 #>  [5,] -0.1243978  0.88179646 #>  [6,]  0.8403210 -1.32344167 #>  [7,] -0.4971559 -0.48544153 #>  [8,]  0.9497406  2.72186980 #>  [9,] -2.9826994  0.08915400 #> [10,]  1.1840482  0.09361379 #>"},{"path":"https://jsilve24.github.io/fido/reference/lmvgamma.html","id":null,"dir":"Reference","previous_headings":"","what":"Log of Multivarate Gamma Function - Gamma_p(a) — lmvgamma","title":"Log of Multivarate Gamma Function - Gamma_p(a) — lmvgamma","text":"Log Multivarate Gamma Function - Gamma_p()","code":""},{"path":"https://jsilve24.github.io/fido/reference/lmvgamma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log of Multivarate Gamma Function - Gamma_p(a) — lmvgamma","text":"","code":"lmvgamma(a, p)"},{"path":"https://jsilve24.github.io/fido/reference/lmvgamma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log of Multivarate Gamma Function - Gamma_p(a) — lmvgamma","text":"defined Gamma_p() p defined Gamma_p()","code":""},{"path":"https://jsilve24.github.io/fido/reference/lmvgamma.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Log of Multivarate Gamma Function - Gamma_p(a) — lmvgamma","text":"Numeric","code":""},{"path":"https://jsilve24.github.io/fido/reference/lmvgamma.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Log of Multivarate Gamma Function - Gamma_p(a) — lmvgamma","text":"https://en.wikipedia.org/wiki/Multivariate_gamma_function","code":""},{"path":"https://jsilve24.github.io/fido/reference/lmvgamma_deriv.html","id":null,"dir":"Reference","previous_headings":"","what":"Derivative of Log of Multivariate Gamma Function - Gamma_p(a) — lmvgamma_deriv","title":"Derivative of Log of Multivariate Gamma Function - Gamma_p(a) — lmvgamma_deriv","text":"Derivative Log Multivariate Gamma Function - Gamma_p()","code":""},{"path":"https://jsilve24.github.io/fido/reference/lmvgamma_deriv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Derivative of Log of Multivariate Gamma Function - Gamma_p(a) — lmvgamma_deriv","text":"","code":"lmvgamma_deriv(a, p)"},{"path":"https://jsilve24.github.io/fido/reference/lmvgamma_deriv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Derivative of Log of Multivariate Gamma Function - Gamma_p(a) — lmvgamma_deriv","text":"defined Gamma_p() p defined Gamma_p()","code":""},{"path":"https://jsilve24.github.io/fido/reference/lmvgamma_deriv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Derivative of Log of Multivariate Gamma Function - Gamma_p(a) — lmvgamma_deriv","text":"Numeric","code":""},{"path":"https://jsilve24.github.io/fido/reference/lmvgamma_deriv.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Derivative of Log of Multivariate Gamma Function - Gamma_p(a) — lmvgamma_deriv","text":"https://en.wikipedia.org/wiki/Multivariate_gamma_function","code":""},{"path":"https://jsilve24.github.io/fido/reference/loglikMaltipooCollapsed.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculations for the Collapsed Maltipoo Model — loglikMaltipooCollapsed","title":"Calculations for the Collapsed Maltipoo Model — loglikMaltipooCollapsed","text":"Functions providing access Log Likelihood, Gradient, Hessian collapsed maltipoo model. Note: convenience functions optimized direct coding MaltipooCollapsed C++ class due lack Memoization. contrast function optimMaltipooCollapsed much optimized massively cuts repeated calculations. efficient Rcpp module based implementation functions may following future. model details see optimMaltipooCollapsed documentation","code":""},{"path":"https://jsilve24.github.io/fido/reference/loglikMaltipooCollapsed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculations for the Collapsed Maltipoo Model — loglikMaltipooCollapsed","text":"","code":"loglikMaltipooCollapsed(Y, upsilon, Theta, X, KInv, U, eta, ell, sylv = FALSE)  gradMaltipooCollapsed(Y, upsilon, Theta, X, KInv, U, eta, ell, sylv = FALSE)  hessMaltipooCollapsed(Y, upsilon, Theta, X, KInv, U, eta, ell, sylv = FALSE)"},{"path":"https://jsilve24.github.io/fido/reference/loglikMaltipooCollapsed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculations for the Collapsed Maltipoo Model — loglikMaltipooCollapsed","text":"Y D x N matrix counts upsilon (must > D) Theta D-1 x Q matrix prior mean regression coefficients X Q x N matrix covariates KInv D-1 x D-1 symmetric positive-definite matrix U PQxQ matrix stacked variance components eta matrix (D-1)xN parameter values calculate quantities ell P-vector scale factors variance component (aka VCScale) sylv (default:false) true N < D-1 use sylvester determinant identity speed computation","code":""},{"path":"https://jsilve24.github.io/fido/reference/loglikMaltipooCollapsed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculations for the Collapsed Maltipoo Model — loglikMaltipooCollapsed","text":"see  loglikMaltipooCollapsed - double gradMaltipooCollapsed - vector hessMaltipooCollapsed- matrix","code":""},{"path":"https://jsilve24.github.io/fido/reference/loglikPibbleCollapsed.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculations for the Collapsed Pibble Model — loglikPibbleCollapsed","title":"Calculations for the Collapsed Pibble Model — loglikPibbleCollapsed","text":"Functions providing access Log Likelihood, Gradient, Hessian collapsed pibble model. Note: convenience functions optimized direct coding PibbleCollapsed C++ class due lack Memoization. contrast function optimPibbleCollapsed much optimized massively cuts repeated calculations. efficient Rcpp module based implementation functions may following future. model details see optimPibbleCollapsed documentation","code":""},{"path":"https://jsilve24.github.io/fido/reference/loglikPibbleCollapsed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculations for the Collapsed Pibble Model — loglikPibbleCollapsed","text":"","code":"loglikPibbleCollapsed(Y, upsilon, ThetaX, KInv, AInv, eta, sylv = FALSE)  gradPibbleCollapsed(Y, upsilon, ThetaX, KInv, AInv, eta, sylv = FALSE)  hessPibbleCollapsed(Y, upsilon, ThetaX, KInv, AInv, eta, sylv = FALSE)"},{"path":"https://jsilve24.github.io/fido/reference/loglikPibbleCollapsed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculations for the Collapsed Pibble Model — loglikPibbleCollapsed","text":"Y D x N matrix counts upsilon (must > D) ThetaX D-1 x N matrix formed Theta*X (Theta Prior mean regression coefficients) KInv Inverse K LTP (Pibble defined KInv = solve(Xi)) AInv Inverse LTP (Pibble defined AInv = solve(diag(N)+ X'GammaX) ) eta matrix (D-1)xN parameter values calculate quantities sylv (default:false) true N < D-1 use sylvester determinant identity speed computation","code":""},{"path":"https://jsilve24.github.io/fido/reference/loglikPibbleCollapsed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculations for the Collapsed Pibble Model — loglikPibbleCollapsed","text":"see loglikPibbleCollapsed - double gradPibbleCollapsed - vector hessPibbleCollapsed- matrix","code":""},{"path":"https://jsilve24.github.io/fido/reference/loglikPibbleCollapsed.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculations for the Collapsed Pibble Model — loglikPibbleCollapsed","text":"","code":"D <- 10 Q <- 2 N <- 30  # Simulate Data Sigma <- diag(sample(1:8, D-1, replace=TRUE)) Sigma[2, 3] <- Sigma[3,2] <- -1 Gamma <- diag(sqrt(rnorm(Q)^2)) Theta <- matrix(0, D-1, Q) Phi <-  Theta + t(chol(Sigma))%*%matrix(rnorm(Q*(D-1)), nrow=D-1)%*%chol(Gamma) X <- matrix(rnorm(N*(Q-1)), Q-1, N) X <- rbind(1, X) Eta <- Phi%*%X + t(chol(Sigma))%*%matrix(rnorm(N*(D-1)), nrow=D-1) Pi <- t(alrInv(t(Eta))) Y <- matrix(0, D, N) for (i in 1:N) Y[,i] <- rmultinom(1, sample(5000:10000), prob = Pi[,i])  # Priors upsilon <- D+10 Xi <- Sigma*(upsilon-D)  # Precompute KInv <- solve(Xi) AInv <- solve(diag(N)+ t(X)%*%Gamma%*%X) ThetaX <- Theta%*%X   loglikPibbleCollapsed(Y, upsilon, ThetaX, KInv, AInv, Eta) #> [1] -195095.9 gradPibbleCollapsed(Y, upsilon, ThetaX, KInv, AInv, Eta)[1:5] #> [1] -4.7284477 -0.1509676  1.2405685  0.2829217  2.6895085 hessPibbleCollapsed(Y, upsilon, ThetaX, KInv, AInv, Eta)[1:5,1:5] #>               [,1]       [,2]        [,3]        [,4]          [,5] #> [1,] -395.55832129  0.3806120 -0.02360702 -0.06801042  393.92582730 #> [2,]    0.38061199 -8.4987346 -0.31053592 -0.10707949    6.35296890 #> [3,]   -0.02360702 -0.3105359 -1.22834285  0.10121428    0.81696424 #> [4,]   -0.06801042 -0.1070795  0.10121428 -0.48603619    0.04496538 #> [5,]  393.92582730  6.3529689  0.81696424  0.04496538 -413.36822195"},{"path":"https://jsilve24.github.io/fido/reference/mallard.html","id":null,"dir":"Reference","previous_headings":"","what":"Data from Silverman et al. (2018) Microbiome — mallard","title":"Data from Silverman et al. (2018) Microbiome — mallard","text":"High Resolution (hourly daily) sampling 4 vitro artificial gut models many technical replicates identify technical variation.","code":""},{"path":"https://jsilve24.github.io/fido/reference/mallard.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Data from Silverman et al. (2018) Microbiome — mallard","text":"","code":"data(mallard)"},{"path":"https://jsilve24.github.io/fido/reference/mallard.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Data from Silverman et al. (2018) Microbiome — mallard","text":"list containing \"otu_table\", \"sample_data\", \"tax_table\", \"refseq\".","code":""},{"path":"https://jsilve24.github.io/fido/reference/mallard.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Data from Silverman et al. (2018) Microbiome — mallard","text":"data sequence variant level. Data family level processed Silverman et al. 2018 given mallard_family","code":""},{"path":"https://jsilve24.github.io/fido/reference/mallard.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Data from Silverman et al. (2018) Microbiome — mallard","text":"Silverman et al. \"Dynamic linear models guide design    analysis microbiota studies within artificial human guts\".    Microbiome 2018 6:202","code":""},{"path":"https://jsilve24.github.io/fido/reference/mallard_family.html","id":null,"dir":"Reference","previous_headings":"","what":"Data from Silverman et al. (2018) Microbiome — mallard_family","title":"Data from Silverman et al. (2018) Microbiome — mallard_family","text":"High Resolution (hourly daily) sampling 4 vitro artificial gut models many technical replicates identify technical variation.","code":""},{"path":"https://jsilve24.github.io/fido/reference/mallard_family.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Data from Silverman et al. (2018) Microbiome — mallard_family","text":"","code":"data(mallard_family)"},{"path":"https://jsilve24.github.io/fido/reference/mallard_family.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Data from Silverman et al. (2018) Microbiome — mallard_family","text":"list containing \"otu_table\", \"sample_data\", \"tax_table\", \"refseq\".","code":""},{"path":"https://jsilve24.github.io/fido/reference/mallard_family.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Data from Silverman et al. (2018) Microbiome — mallard_family","text":"data family level processed Silverman et al. 2018. Data sequence variant level without preprocessing given mallard","code":""},{"path":"https://jsilve24.github.io/fido/reference/mallard_family.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Data from Silverman et al. (2018) Microbiome — mallard_family","text":"Silverman et al. \"Dynamic linear models guide design    analysis microbiota studies within artificial human guts\".    Microbiome 2018 6:202","code":""},{"path":"https://jsilve24.github.io/fido/reference/maltipoofit.html","id":null,"dir":"Reference","previous_headings":"","what":"Create maltipoofit object — maltipoofit","title":"Create maltipoofit object — maltipoofit","text":"Create maltipoofit object","code":""},{"path":"https://jsilve24.github.io/fido/reference/maltipoofit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create maltipoofit object — maltipoofit","text":"","code":"maltipoofit(   D,   N,   Q,   P,   coord_system,   iter = NULL,   alr_base = NULL,   ilr_base = NULL,   Eta = NULL,   Lambda = NULL,   Sigma = NULL,   Sigma_default = NULL,   Y = NULL,   X = NULL,   upsilon = NULL,   Theta = NULL,   Xi = NULL,   Xi_default = NULL,   Gamma = NULL,   init = NULL,   ellinit = NULL,   names_categories = NULL,   names_samples = NULL,   names_covariates = NULL,   VCScale = NULL,   U = NULL )"},{"path":"https://jsilve24.github.io/fido/reference/maltipoofit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create maltipoofit object — maltipoofit","text":"D number multinomial categories N number samples Q number covariates P number variance components coord_system coordinate system objects represented (options  include \"alr\", \"clr\", \"ilr\", \"proportions\") iter number posterior samples alr_base integer category used reference  (required coord_system==\"alr\") ilr_base (D x D-1) contrast matrix (required coord_system==\"ilr\") Eta Array samples Eta Lambda Array samples Lambda Sigma Array samples Sigma (null coord_system==\"proportions\") Sigma_default Array samples Sigma alr base D, used  coord_system==\"proportions\" Y DxN matrix observed counts X QxN design matrix upsilon scalar prior dof inverse wishart prior Theta prior mean Lambda Xi Matrix prior covariance inverse wishart  (null coord_system==\"proportions\") Xi_default Matrix prior covariance inverse wishart alr  base D (used coord_system==\"proportions\") Gamma QxQ covariance matrix prior Lambda init matrix initial guess Lambda used optimization ellinit P vector initialization values ell optimization names_categories character vector names_samples character vector names_covariates character vector VCScale scale factors (delta) variance components U PQ x Q matrix stacked variance components (dimension Q x Q)","code":""},{"path":"https://jsilve24.github.io/fido/reference/maltipoofit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create maltipoofit object — maltipoofit","text":"object class maltipoofit","code":""},{"path":[]},{"path":"https://jsilve24.github.io/fido/reference/maltipoo_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Interface to fit maltipoo models — maltipoo_fit","title":"Interface to fit maltipoo models — maltipoo_fit","text":"function largely user friendly wrapper around  optimMaltipooCollapsed  uncollapsePibble.  See details model specification.   Notation: N number samples,  D number multinomial categories, Q number  covariates, P number variance components   iter number samples eta (e.g.,  parameter n_samples function   optimPibbleCollapsed)","code":""},{"path":"https://jsilve24.github.io/fido/reference/maltipoo_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Interface to fit maltipoo models — maltipoo_fit","text":"","code":"maltipoo(   Y = NULL,   X = NULL,   upsilon = NULL,   Theta = NULL,   U = NULL,   Xi = NULL,   init = NULL,   ellinit = NULL,   pars = c(\"Eta\", \"Lambda\", \"Sigma\"),   ... )"},{"path":"https://jsilve24.github.io/fido/reference/maltipoo_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Interface to fit maltipoo models — maltipoo_fit","text":"Y D x N matrix counts (NULL uses priors ) X Q x N matrix covariates (design matrix) (NULL uses priors , must present sample Eta) upsilon dof inverse wishart prior (numeric must > D) (default: D+3) Theta (D-1) x Q matrix prior mean regression parameters (default: matrix(0, D-1, Q)) U PQ x Q matrix stacked variance components (dimension Q x Q) Xi (D-1)x(D-1) prior covariance matrix (default: ALR transform diag(1)*(upsilon-D)/2 - essentially iid \"base scale\" using Aitchison terminology) init (D-1) x Q initialization Eta optimization ellinit P vector initialization values ell optimization pars character vector posterior parameters return ... arguments passed optimPibbleCollapsed uncollapsePibble","code":""},{"path":"https://jsilve24.github.io/fido/reference/maltipoo_fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Interface to fit maltipoo models — maltipoo_fit","text":"object class maltipoofit","code":""},{"path":"https://jsilve24.github.io/fido/reference/maltipoo_fit.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Interface to fit maltipoo models — maltipoo_fit","text":"full model given :    $$Y_j \\sim Multinomial(Pi_j)$$    $$Pi_j = Phi^{-1}(Eta_j)$$    $$Eta \\sim MN_{D-1 x N}(Lambda*X, Sigma, I_N)$$    $$Lambda \\sim MN_{D-1 x Q}(Theta, Sigma, Gamma)$$    $$Gamma = e^{ell_1} U_1 + ... + e^{ell_P} U_P$$    $$Sigma \\sim InvWish(upsilon, Xi)$$ \\(= (I_N + X * Gamma * X')^{-1}\\), \\(K^{-1} = Xi\\) (D-1)x(D-1)   covariance matrix, \\(U_1\\) Q x Q covariance matrix (variance component),   \\(e^{ell_i}\\) scale variance component \\(Phi^{-1}\\)   ALRInv_D transform. Default behavior use MAP estimate uncollaping collapsed maltipoo   model laplace approximation preformed. Parameters ell treated fixed estimated MAP estimation.","code":""},{"path":"https://jsilve24.github.io/fido/reference/metadata.html","id":null,"dir":"Reference","previous_headings":"","what":"Data from Silverman et al. (2019) bioRxiv — metadata","title":"Data from Silverman et al. (2019) bioRxiv — metadata","text":"Mock communities calibration samples created measuring validating model PCR bias. data preprocessed original manuscript.","code":""},{"path":"https://jsilve24.github.io/fido/reference/metadata.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Data from Silverman et al. (2019) bioRxiv — metadata","text":"data.frame metadata associated counts matrix `Y`","code":""},{"path":"https://jsilve24.github.io/fido/reference/metadata.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Data from Silverman et al. (2019) bioRxiv — metadata","text":"Justin D. Silverman, Rachael J. Bloom, Sharon Jiang, Heather K. Durand, Sayan Mukherjee,  Lawrence . David. (2019) Measuring Mitigating PCR Bias Microbiome Data.  bioRxiv 604025; doi: https://doi.org/10.1101/604025","code":""},{"path":"https://jsilve24.github.io/fido/reference/miniclo.html","id":null,"dir":"Reference","previous_headings":"","what":"Closure operator — miniclo","title":"Closure operator — miniclo","text":"Closure operator","code":""},{"path":"https://jsilve24.github.io/fido/reference/miniclo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Closure operator — miniclo","text":"","code":"miniclo(x)"},{"path":"https://jsilve24.github.io/fido/reference/miniclo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Closure operator — miniclo","text":"x vector matrix (rows samples, parts columns) data simplex","code":""},{"path":"https://jsilve24.github.io/fido/reference/miniclo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Closure operator — miniclo","text":"x row entries divided sum row (converts vectors row matricies)","code":""},{"path":"https://jsilve24.github.io/fido/reference/miniclo.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Closure operator — miniclo","text":"","code":"x <- matrix(runif(30), 10, 3) x <- miniclo(x)"},{"path":"https://jsilve24.github.io/fido/reference/miniclo_array.html","id":null,"dir":"Reference","previous_headings":"","what":"Closure Operation applied to array on margin — miniclo_array","title":"Closure Operation applied to array on margin — miniclo_array","text":"Array version miniclo.","code":""},{"path":"https://jsilve24.github.io/fido/reference/miniclo_array.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Closure Operation applied to array on margin — miniclo_array","text":"","code":"miniclo_array(x, parts)"},{"path":"https://jsilve24.github.io/fido/reference/miniclo_array.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Closure Operation applied to array on margin — miniclo_array","text":"x multidimensional array parts index dimension x represents parts (e.g., compositional variables)","code":""},{"path":"https://jsilve24.github.io/fido/reference/miniclo_array.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Closure Operation applied to array on margin — miniclo_array","text":"array","code":""},{"path":"https://jsilve24.github.io/fido/reference/miniclo_array.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Closure Operation applied to array on margin — miniclo_array","text":"","code":"x <- array(1:100, dim=c(10, 5, 2)) miniclo_array(x, parts=2) #> , , 1 #>  #>             [,1]      [,2] [,3]      [,4]      [,5] #>  [1,] 0.00952381 0.1047619  0.2 0.2952381 0.3904762 #>  [2,] 0.01818182 0.1090909  0.2 0.2909091 0.3818182 #>  [3,] 0.02608696 0.1130435  0.2 0.2869565 0.3739130 #>  [4,] 0.03333333 0.1166667  0.2 0.2833333 0.3666667 #>  [5,] 0.04000000 0.1200000  0.2 0.2800000 0.3600000 #>  [6,] 0.04615385 0.1230769  0.2 0.2769231 0.3538462 #>  [7,] 0.05185185 0.1259259  0.2 0.2740741 0.3481481 #>  [8,] 0.05714286 0.1285714  0.2 0.2714286 0.3428571 #>  [9,] 0.06206897 0.1310345  0.2 0.2689655 0.3379310 #> [10,] 0.06666667 0.1333333  0.2 0.2666667 0.3333333 #>  #> , , 2 #>  #>            [,1]      [,2] [,3]      [,4]      [,5] #>  [1,] 0.1436620 0.1718310  0.2 0.2281690 0.2563380 #>  [2,] 0.1444444 0.1722222  0.2 0.2277778 0.2555556 #>  [3,] 0.1452055 0.1726027  0.2 0.2273973 0.2547945 #>  [4,] 0.1459459 0.1729730  0.2 0.2270270 0.2540541 #>  [5,] 0.1466667 0.1733333  0.2 0.2266667 0.2533333 #>  [6,] 0.1473684 0.1736842  0.2 0.2263158 0.2526316 #>  [7,] 0.1480519 0.1740260  0.2 0.2259740 0.2519481 #>  [8,] 0.1487179 0.1743590  0.2 0.2256410 0.2512821 #>  [9,] 0.1493671 0.1746835  0.2 0.2253165 0.2506329 #> [10,] 0.1500000 0.1750000  0.2 0.2250000 0.2500000 #>"},{"path":"https://jsilve24.github.io/fido/reference/mongrel-deprecated.html","id":null,"dir":"Reference","previous_headings":"","what":"mongrel — mongrel-deprecated","title":"mongrel — mongrel-deprecated","text":"function deprecated, please use pibble  instead.","code":""},{"path":"https://jsilve24.github.io/fido/reference/mongrel-deprecated.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"mongrel — mongrel-deprecated","text":"","code":"mongrel(   Y = NULL,   X = NULL,   upsilon = NULL,   Theta = NULL,   Gamma = NULL,   Xi = NULL,   init = NULL,   pars = c(\"Eta\", \"Lambda\", \"Sigma\"),   ... )"},{"path":"https://jsilve24.github.io/fido/reference/mongrel-deprecated.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"mongrel — mongrel-deprecated","text":"Y D x N matrix counts (NULL uses priors ) X Q x N matrix covariates (design matrix) (NULL uses priors , must present sample Eta) upsilon dof inverse wishart prior (numeric must > D) (default: D+3) Theta (D-1) x Q matrix prior mean regression parameters (default: matrix(0, D-1, Q)) Gamma QxQ prior covariance matrix (default: diag(Q)) Xi (D-1)x(D-1) prior covariance matrix (default: ALR transform diag(1)*(upsilon-D)/2 - essentially iid \"base scale\" using Aitchison terminology) init (D-1) x N initialization Eta optimization pars character vector posterior parameters return ... arguments passed optimPibbleCollapsed uncollapsePibble","code":""},{"path":"https://jsilve24.github.io/fido/reference/mongrel-deprecated.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"mongrel — mongrel-deprecated","text":"object class pibblefit","code":""},{"path":"https://jsilve24.github.io/fido/reference/name.html","id":null,"dir":"Reference","previous_headings":"","what":"Generic method for applying names to an object — name","title":"Generic method for applying names to an object — name","text":"Intended called internally package","code":""},{"path":"https://jsilve24.github.io/fido/reference/name.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generic method for applying names to an object — name","text":"","code":"name(m, ...)"},{"path":"https://jsilve24.github.io/fido/reference/name.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generic method for applying names to an object — name","text":"m object ... arguments passed","code":""},{"path":"https://jsilve24.github.io/fido/reference/name.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generic method for applying names to an object — name","text":"object class names applied dimensions","code":""},{"path":"https://jsilve24.github.io/fido/reference/name.orthusfit.html","id":null,"dir":"Reference","previous_headings":"","what":"S3 for orthusfit apply names to orthusfit object — name.orthusfit","title":"S3 for orthusfit apply names to orthusfit object — name.orthusfit","text":"avoid confusion, assigned default names multinomial categories (c1 etc...)  zdimensions (z1 etc...)","code":""},{"path":"https://jsilve24.github.io/fido/reference/name.orthusfit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"S3 for orthusfit apply names to orthusfit object — name.orthusfit","text":"","code":"# S3 method for orthusfit name(m, ...)"},{"path":"https://jsilve24.github.io/fido/reference/name.orthusfit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"S3 for orthusfit apply names to orthusfit object — name.orthusfit","text":"m object class orthusfit ... currently ignored","code":""},{"path":"https://jsilve24.github.io/fido/reference/name.orthusfit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"S3 for orthusfit apply names to orthusfit object — name.orthusfit","text":"object class orthusfit","code":""},{"path":"https://jsilve24.github.io/fido/reference/name.pibblefit.html","id":null,"dir":"Reference","previous_headings":"","what":"S3 for pibblefit apply names to pibblefit object — name.pibblefit","title":"S3 for pibblefit apply names to pibblefit object — name.pibblefit","text":"S3 pibblefit apply names pibblefit object","code":""},{"path":"https://jsilve24.github.io/fido/reference/name.pibblefit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"S3 for pibblefit apply names to pibblefit object — name.pibblefit","text":"","code":"# S3 method for pibblefit name(m, ...)"},{"path":"https://jsilve24.github.io/fido/reference/name.pibblefit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"S3 for pibblefit apply names to pibblefit object — name.pibblefit","text":"m object class pibblefit ... currently ignored","code":""},{"path":"https://jsilve24.github.io/fido/reference/name.pibblefit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"S3 for pibblefit apply names to pibblefit object — name.pibblefit","text":"object class pibblefit","code":""},{"path":"https://jsilve24.github.io/fido/reference/name_dims.html","id":null,"dir":"Reference","previous_headings":"","what":"Generic method for getting and setting dimension names of fit object — names_covariates.pibblefit","title":"Generic method for getting and setting dimension names of fit object — names_covariates.pibblefit","text":"Generic method getting setting dimension names fit object","code":""},{"path":"https://jsilve24.github.io/fido/reference/name_dims.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generic method for getting and setting dimension names of fit object — names_covariates.pibblefit","text":"","code":"# S3 method for pibblefit names_covariates(m)  # S3 method for pibblefit names_samples(m)  # S3 method for pibblefit names_categories(m)  # S3 method for pibblefit names_coords(m)  # S3 method for pibblefit names_covariates(m) <- value  # S3 method for pibblefit names_samples(m) <- value  # S3 method for pibblefit names_categories(m) <- value  names_covariates(m)  names_samples(m)  names_categories(m)  names_coords(m)  names_covariates(m) <- value  names_samples(m) <- value  names_categories(m) <- value"},{"path":"https://jsilve24.github.io/fido/reference/name_dims.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generic method for getting and setting dimension names of fit object — names_covariates.pibblefit","text":"m object value character vector (NULL)","code":""},{"path":"https://jsilve24.github.io/fido/reference/name_dims.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generic method for getting and setting dimension names of fit object — names_covariates.pibblefit","text":"vector names","code":""},{"path":"https://jsilve24.github.io/fido/reference/name_dims.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generic method for getting and setting dimension names of fit object — names_covariates.pibblefit","text":"names_coords different names_categories.  names_categories provides access basic names multinomial  category. contrast, names_coords provides access  names coordinates object represented. coordinate names based category names. example, category names may ,  (OTU1, ..., OTUD) coordinate names (log(OTU1/OTUD), etc...) object default coordinate system.","code":""},{"path":"https://jsilve24.github.io/fido/reference/optimMaltipooCollapsed.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to Optimize the Collapsed Maltipoo Model — optimMaltipooCollapsed","title":"Function to Optimize the Collapsed Maltipoo Model — optimMaltipooCollapsed","text":"See details model. likely followed function uncollapsePibble. Notation: N number samples, D number multinomial categories, Q number covariates.","code":""},{"path":"https://jsilve24.github.io/fido/reference/optimMaltipooCollapsed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to Optimize the Collapsed Maltipoo Model — optimMaltipooCollapsed","text":"","code":"optimMaltipooCollapsed(   Y,   upsilon,   Theta,   X,   KInv,   U,   init,   ellinit,   n_samples = 2000L,   calcGradHess = TRUE,   b1 = 0.9,   b2 = 0.99,   step_size = 0.003,   epsilon = 1e-06,   eps_f = 1e-10,   eps_g = 1e-04,   max_iter = 10000L,   verbose = FALSE,   verbose_rate = 10L,   decomp_method = \"cholesky\",   eigvalthresh = 0,   jitter = 0 )"},{"path":"https://jsilve24.github.io/fido/reference/optimMaltipooCollapsed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to Optimize the Collapsed Maltipoo Model — optimMaltipooCollapsed","text":"Y D x N matrix counts upsilon (must > D) Theta D-1 x Q matrix prior mean regression coefficients X Q x N matrix covariates KInv D-1 x D-1 symmetric positive-definite matrix U PQxQ matrix stacked variance components init D-1 x N matrix initial guess eta used optimization ellinit P vector initial guess ell used optimization n_samples number samples Laplace Approximation (=0 fast inversion decomposition Hessian required) calcGradHess n_samples=0 Gradient Hessian still calculated using closed form solutions? b1 (ADAM) 1st moment decay parameter (recommend 0.9) \"aka momentum\" b2 (ADAM) 2nd moment decay parameter (recommend 0.99 0.999) step_size (ADAM) step size descent (recommend 0.001-0.003) epsilon (ADAM) parameter avoid divide zero eps_f (ADAM) normalized function improvement stopping criteria eps_g (ADAM) normalized gradient magnitude stopping criteria max_iter (ADAM) maximum number iterations stopping verbose (ADAM) true print stats stopping criteria iteration number verbose_rate (ADAM) rate print verbose stats screen decomp_method decomposition hessian Laplace approximation 'eigen' (stable-slightly, slower) 'cholesky' (less stable, faster, default) eigvalthresh threshold negative eigenvalues decomposition negative inverse hessian (<=0) jitter (default: 0) >0 adds factor diagonal Hessian decomposition (improve matrix conditioning)","code":""},{"path":"https://jsilve24.github.io/fido/reference/optimMaltipooCollapsed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to Optimize the Collapsed Maltipoo Model — optimMaltipooCollapsed","text":"List containing (respect found optima) LogLik - Log Likelihood collapsed model (proportionality constant) Gradient - (calcGradHess=true) Hessian - (calcGradHess=true) POSITIVE log posterior Pars - Parameter value eta Samples - (D-1) x N x n_samples array containing posterior samples eta based Laplace approximation (n_samples>0) VCScale - value e^ell_i optima logInvNegHessDet - log determinant covariacne Laplace approximation, useful calculating marginal likelihood","code":""},{"path":"https://jsilve24.github.io/fido/reference/optimMaltipooCollapsed.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Function to Optimize the Collapsed Maltipoo Model — optimMaltipooCollapsed","text":"Notation: Let Z_j denote J-th row matrix Z. Model: $$Y_j \\sim Multinomial(Pi_j)$$ $$Pi_j = Phi^{-1}(Eta_j)$$ $$Eta \\sim T_{D-1, N}(upsilon, Theta*X, K, )$$ \\(= (I_N + e^{ell_1}*X*U_1*X' + ... + e^{ell_P}*X*U_P*X' )\\), K D-1xD-1 covariance Phi ALRInv_D transform. Gradient Hessian calculations fast computed using closed form solutions. said, Hessian matrix can quite large [N\\(D-1) x N\\(D-1)] storage may issue. Note: Warnings large negative eigenvalues can either signal optimizer reach optima (commonly experience) prior / degrees freedom covariance (given parameters upsilon KInv) specific odds observed data. get warning try following. Try restarting optimization using different initial guess eta Try decreasing (even increasing)step_size (increments 0.001 0.002) increasing max_iter parameters optimizer. Also can try increasing b1 0.99 decreasing eps_f orders magnitude Try relaxing prior assumptions regarding covariance matrix. (e.g., may want consider decreasing parameter upsilon closer minimum value D) Try adding small amount jitter (e.g., set jitter=1e-5) address potential floating point errors.","code":""},{"path":"https://jsilve24.github.io/fido/reference/optimMaltipooCollapsed.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Function to Optimize the Collapsed Maltipoo Model — optimMaltipooCollapsed","text":"S. Ruder (2016) overview gradient descent optimization algorithms. arXiv 1609.04747","code":""},{"path":[]},{"path":"https://jsilve24.github.io/fido/reference/optimPibbleCollapsed.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to Optimize the Collapsed Pibble Model — optimPibbleCollapsed","title":"Function to Optimize the Collapsed Pibble Model — optimPibbleCollapsed","text":"See details model. likely followed function uncollapsePibble. Notation: N number samples, D number multinomial categories, Q number covariates.","code":""},{"path":"https://jsilve24.github.io/fido/reference/optimPibbleCollapsed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to Optimize the Collapsed Pibble Model — optimPibbleCollapsed","text":"","code":"optimPibbleCollapsed(   Y,   upsilon,   ThetaX,   KInv,   AInv,   init,   n_samples = 2000L,   calcGradHess = TRUE,   b1 = 0.9,   b2 = 0.99,   step_size = 0.003,   epsilon = 1e-06,   eps_f = 1e-10,   eps_g = 1e-04,   max_iter = 10000L,   verbose = FALSE,   verbose_rate = 10L,   decomp_method = \"cholesky\",   optim_method = \"lbfgs\",   eigvalthresh = 0,   jitter = 0,   multDirichletBoot = -1,   useSylv = TRUE,   ncores = -1L,   seed = -1L )"},{"path":"https://jsilve24.github.io/fido/reference/optimPibbleCollapsed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to Optimize the Collapsed Pibble Model — optimPibbleCollapsed","text":"Y D x N matrix counts upsilon (must > D) ThetaX D-1 x N matrix formed Theta*X (Theta Prior mean regression coefficients) KInv D-1 x D-1 precision matrix (inverse Xi) AInv N x N precision matrix given \\((I_N + X'*Gamma*X)^{-1}\\) init D-1 x N matrix initial guess eta used optimization n_samples number samples Laplace Approximation (=0 fast inversion decomposition Hessian required) calcGradHess n_samples=0 Gradient Hessian still calculated using closed form solutions? b1 (ADAM) 1st moment decay parameter (recommend 0.9) \"aka momentum\" b2 (ADAM) 2nd moment decay parameter (recommend 0.99 0.999) step_size (ADAM) step size descent (recommend 0.001-0.003) epsilon (ADAM) parameter avoid divide zero eps_f (ADAM) normalized function improvement stopping criteria eps_g (ADAM) normalized gradient magnitude stopping criteria max_iter (ADAM) maximum number iterations stopping verbose (ADAM) true print stats stopping criteria iteration number verbose_rate (ADAM) rate print verbose stats screen decomp_method decomposition hessian Laplace approximation 'eigen' (stable-slightly, slower) 'cholesky' (less stable, faster, default) optim_method (default:\"lbfgs\") \"adam\" eigvalthresh threshold negative eigenvalues decomposition negative inverse hessian (<=0) jitter (default: 0) >=0 adds factor diagonal Hessian decomposition (improve matrix conditioning) multDirichletBoot >0 overrides laplace approximation samples eta efficiently MAP estimate pseudo Multinomial-Dirichlet posterior. useSylv (default: true) N<D-1 uses Sylvester Determinant Identity speed calculation log-likelihood gradients. ncores (default:-1) number cores use, ncores==-1 uses default OpenMP typically use available cores. seed (random seed Laplace approximation -- integer)","code":""},{"path":"https://jsilve24.github.io/fido/reference/optimPibbleCollapsed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to Optimize the Collapsed Pibble Model — optimPibbleCollapsed","text":"List containing (respect found optima) LogLik - Log Likelihood collapsed model (proportionality constant) Gradient - (calcGradHess=true) Hessian - (calcGradHess=true) POSITIVE LOG POSTERIOR Pars - Parameter value eta optima Samples - (D-1) x N x n_samples array containing posterior samples eta based Laplace approximation (n_samples>0) Timer - Vector Execution Times logInvNegHessDet - log determinant covariacne Laplace approximation, useful calculating marginal likelihood logMarginalLikelihood - calculation log marginal likelihood based laplace approximation","code":""},{"path":"https://jsilve24.github.io/fido/reference/optimPibbleCollapsed.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Function to Optimize the Collapsed Pibble Model — optimPibbleCollapsed","text":"Notation: Let Z_j denote J-th row matrix Z. Model: $$Y_j \\sim Multinomial(Pi_j)$$ $$Pi_j = Phi^{-1}(Eta_j)$$ $$Eta \\sim T_{D-1, N}(upsilon, Theta*X, K, )$$ \\(= I_N + X * Gamma * X'\\), K (D-1)x(D-1) covariance matrix, Gamma Q x Q covariance matrix, \\(Phi^{-1}\\) ALRInv_D transform. Gradient Hessian calculations fast computed using closed form solutions. said, Hessian matrix can quite large [N*(D-1) x N*(D-1)] storage may issue. Note: Warnings large negative eigenvalues can either signal optimizer reach optima (commonly experience) prior / degrees freedom covariance (given parameters upsilon KInv) specific odds observed data. get warning try following. Try restarting optimization using different initial guess eta Try decreasing (even increasing )step_size (increments 0.001 0.002) increasing max_iter parameters optimizer. Also can try increasing b1 0.99 decreasing eps_f orders magnitude Try relaxing prior assumptions regarding covariance matrix. (e.g., may want consider decreasing parameter upsilon closer minimum value D) Try adding small amount jitter (e.g., set jitter=1e-5) address potential floating point errors.","code":""},{"path":"https://jsilve24.github.io/fido/reference/optimPibbleCollapsed.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Function to Optimize the Collapsed Pibble Model — optimPibbleCollapsed","text":"S. Ruder (2016) overview gradient descent optimization algorithms. arXiv 1609.04747 JD Silverman K Roche, ZC Holmes, LA David, S Mukherjee. Bayesian Multinomial Logistic Normal Models Marginally Latent Matrix-T Processes. 2022, Journal Machine Learning","code":""},{"path":[]},{"path":"https://jsilve24.github.io/fido/reference/optimPibbleCollapsed.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Function to Optimize the Collapsed Pibble Model — optimPibbleCollapsed","text":"","code":"sim <- pibble_sim()  # Fit model for eta fit <- optimPibbleCollapsed(sim$Y, sim$upsilon, sim$Theta%*%sim$X, sim$KInv,                               sim$AInv, random_pibble_init(sim$Y))"},{"path":"https://jsilve24.github.io/fido/reference/orthusfit.html","id":null,"dir":"Reference","previous_headings":"","what":"Create orthusfit object — orthusfit","title":"Create orthusfit object — orthusfit","text":"Create orthusfit object","code":""},{"path":"https://jsilve24.github.io/fido/reference/orthusfit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create orthusfit object — orthusfit","text":"","code":"orthusfit(   D,   N,   Q,   P,   coord_system,   iter = NULL,   alr_base = NULL,   ilr_base = NULL,   Eta = NULL,   Lambda = NULL,   Sigma = NULL,   Sigma_default = NULL,   Z = NULL,   Y = NULL,   X = NULL,   upsilon = NULL,   Theta = NULL,   Xi = NULL,   Xi_default = NULL,   Gamma = NULL,   init = NULL,   names_categories = NULL,   names_samples = NULL,   names_Zdimensions = NULL,   names_covariates = NULL )"},{"path":"https://jsilve24.github.io/fido/reference/orthusfit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create orthusfit object — orthusfit","text":"D number multinomial categories N number samples Q number covariates P Dimension second dataset (e.g., nrows(Z) ) coord_system coordinate system objects represented (options  include \"alr\", \"clr\", \"ilr\", \"proportions\") iter number posterior samples alr_base integer category used reference  (required coord_system==\"alr\") ilr_base (D x D-1) contrast matrix (required coord_system==\"ilr\") Eta Array samples Eta Lambda Array samples Lambda Sigma Array samples Sigma (null coord_system==\"proportions\") Sigma_default Array samples Sigma alr base D, used  coord_system==\"proportions\" Z PxN matrix real valued observations Y DxN matrix observed counts X QxN design matrix upsilon scalar prior dof inverse wishart prior Theta prior mean Lambda Xi Matrix prior covariance inverse wishart  (null coord_system==\"proportions\") Xi_default Matrix prior covariance inverse wishart alr  base D (used coord_system==\"proportions\") Gamma QxQ covariance matrix prior Lambda init matrix initial guess Lambda used optimization names_categories character vector names_samples character vector names_Zdimensions character vector names_covariates character vector","code":""},{"path":"https://jsilve24.github.io/fido/reference/orthusfit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create orthusfit object — orthusfit","text":"object class orthusfit","code":""},{"path":[]},{"path":"https://jsilve24.github.io/fido/reference/orthus_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Interface to fit orthus models — orthus_fit","title":"Interface to fit orthus models — orthus_fit","text":"function largely user friendly wrapper around optimPibbleCollapsed uncollapsePibble fitting orthus models. See details model specification. Notation: N number samples, P number dimensions observations second dataset, D number multinomial categories, Q number covariates, iter number samples eta (e.g., parameter n_samples function optimPibbleCollapsed)","code":""},{"path":"https://jsilve24.github.io/fido/reference/orthus_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Interface to fit orthus models — orthus_fit","text":"","code":"orthus(   Y = NULL,   Z = NULL,   X = NULL,   upsilon = NULL,   Theta = NULL,   Gamma = NULL,   Xi = NULL,   init = NULL,   pars = c(\"Eta\", \"Lambda\", \"Sigma\"),   ... )"},{"path":"https://jsilve24.github.io/fido/reference/orthus_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Interface to fit orthus models — orthus_fit","text":"Y D x N matrix counts (NULL uses priors ) Z P x N matrix counts (NULL uses priors - must present/absent Y present/absent) X Q x N matrix covariates (design matrix) (NULL uses priors , must present sample Eta) upsilon dof inverse wishart prior (numeric must > D) (default: D+3) Theta (D-1+P) x Q matrix prior mean regression parameters (default: matrix(0, D-1+P, Q)) Gamma QxQ prior covariance matrix (default: diag(Q)) Xi (D-1+P)x(D-1+P) prior covariance matrix (default: ALR transform diag(1)*(upsilon-D)/2 - essentially iid \"base scale\" using Aitchison terminology) init (D-1) x Q initialization Eta optimization pars character vector posterior parameters return ... arguments passed optimPibbleCollapsed uncollapsePibble","code":""},{"path":"https://jsilve24.github.io/fido/reference/orthus_fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Interface to fit orthus models — orthus_fit","text":"object class pibblefit","code":""},{"path":"https://jsilve24.github.io/fido/reference/orthus_fit.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Interface to fit orthus models — orthus_fit","text":"full model given : $$Y_j \\sim Multinomial(Pi_j)$$ $$Pi_j = Phi^{-1}(Eta_j)$$ $$cbind(Eta, Z) \\sim MN_{D-1+P x N}(Lambda*X, Sigma, I_N)$$ $$Lambda \\sim MN_{D-1+P x Q}(Theta, Sigma, Gamma)$$ $$Sigma \\sim InvWish(upsilon, Xi)$$ Gamma Q x Q covariance matrix, \\(Phi^{-1}\\) ALRInv_D transform. , orthus model models latent multinomial log-ratios (Eta) observations second dataset jointly linear model. allows Sigma also describe covariation two datasets. Default behavior use MAP estimate uncollaping LTP model laplace approximation preformed.","code":""},{"path":"https://jsilve24.github.io/fido/reference/orthus_fit.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Interface to fit orthus models — orthus_fit","text":"JD Silverman K Roche, ZC Holmes, LA David, S Mukherjee.    Bayesian Multinomial Logistic Normal Models Marginally Latent Matrix-T Processes.    2019, arXiv e-prints, arXiv:1903.11695","code":""},{"path":[]},{"path":"https://jsilve24.github.io/fido/reference/orthus_fit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Interface to fit orthus models — orthus_fit","text":"","code":"sim <- orthus_sim() fit <- orthus(sim$Y, sim$Z, sim$X)"},{"path":"https://jsilve24.github.io/fido/reference/orthus_lr_transforms.html","id":null,"dir":"Reference","previous_headings":"","what":"Log-Ratio transforms for orthus objects — orthus_lr_transforms","title":"Log-Ratio transforms for orthus objects — orthus_lr_transforms","text":"Log-Ratio transforms orthus objects","code":""},{"path":"https://jsilve24.github.io/fido/reference/orthus_lr_transforms.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log-Ratio transforms for orthus objects — orthus_lr_transforms","text":"","code":"oglr(x, s, V)  oglrInv(x, s, V)  oalr(x, s, d = NULL)  oalrInv(y, s, d = NULL)  oilr(x, s, V = NULL)  oilrInv(y, s, V = NULL)  oclr(x, s)  oclrInv(x, s)"},{"path":"https://jsilve24.github.io/fido/reference/orthus_lr_transforms.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log-Ratio transforms for orthus objects — orthus_lr_transforms","text":"x orthus data array (e.g., first s rows multinomial parameters log-ratios) s first s rows x transformed V transformation matrix (defines transform) d ALR, component (integer position) take reference (default ncol(x)) alrInv corresponds column position untransformed matrix. y orthus data array (e.g., first s rows multinomial parameters log-ratios)","code":""},{"path":"https://jsilve24.github.io/fido/reference/orthus_lr_transforms.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Log-Ratio transforms for orthus objects — orthus_lr_transforms","text":"matrix","code":""},{"path":"https://jsilve24.github.io/fido/reference/orthus_sim.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate simple orthus dataset and priors (for testing) — orthus_sim","title":"Simulate simple orthus dataset and priors (for testing) — orthus_sim","text":"Simulate simple orthus dataset priors (testing)","code":""},{"path":"https://jsilve24.github.io/fido/reference/orthus_sim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate simple orthus dataset and priors (for testing) — orthus_sim","text":"","code":"orthus_sim(   D = 10,   P = 10,   N = 30,   Q = 2,   use_names = TRUE,   true_priors = FALSE )"},{"path":"https://jsilve24.github.io/fido/reference/orthus_sim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate simple orthus dataset and priors (for testing) — orthus_sim","text":"D number multinomial categories P number dimensions second dataset Z N number samples Q number covariates (first one intercept, must > 1) use_names samples, covariates, categories named true_priors Xi upsilon chosen mean true  simulated value","code":""},{"path":"https://jsilve24.github.io/fido/reference/orthus_sim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate simple orthus dataset and priors (for testing) — orthus_sim","text":"list","code":""},{"path":"https://jsilve24.github.io/fido/reference/orthus_sim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate simple orthus dataset and priors (for testing) — orthus_sim","text":"","code":"sim <- orthus_sim()"},{"path":"https://jsilve24.github.io/fido/reference/orthus_tidy_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert orthus samples of Eta Lambda and Sigma to tidy format — orthus_tidy_samples","title":"Convert orthus samples of Eta Lambda and Sigma to tidy format — orthus_tidy_samples","text":"Combines single tibble, see example formatting  column headers. Primarily designed used  summary.orthusfit.","code":""},{"path":"https://jsilve24.github.io/fido/reference/orthus_tidy_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert orthus samples of Eta Lambda and Sigma to tidy format — orthus_tidy_samples","text":"","code":"orthus_tidy_samples(m, use_names = FALSE, as_factor = FALSE)"},{"path":"https://jsilve24.github.io/fido/reference/orthus_tidy_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert orthus samples of Eta Lambda and Sigma to tidy format — orthus_tidy_samples","text":"m object class orthusfit use_names dimension indices replaced dimension names provided data used fit pibble model. as_factor use_names names returned factor?","code":""},{"path":"https://jsilve24.github.io/fido/reference/orthus_tidy_samples.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert orthus samples of Eta Lambda and Sigma to tidy format — orthus_tidy_samples","text":"tibble","code":""},{"path":"https://jsilve24.github.io/fido/reference/orthus_tidy_samples.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert orthus samples of Eta Lambda and Sigma to tidy format — orthus_tidy_samples","text":"","code":"sim <- orthus_sim() fit <- orthus(sim$Y, sim$Z, sim$X) fit_tidy <- orthus_tidy_samples(fit, use_names=TRUE) head(fit_tidy) #>   Parameter       coord sample iter        val covariate coord2 #> 1       Eta log(c1/c10)     s1    1  1.7727815      <NA>   <NA> #> 2       Eta log(c2/c10)     s1    1  1.7654507      <NA>   <NA> #> 3       Eta log(c3/c10)     s1    1 -0.6052307      <NA>   <NA> #> 4       Eta log(c4/c10)     s1    1 -0.9468327      <NA>   <NA> #> 5       Eta log(c5/c10)     s1    1  0.2249392      <NA>   <NA> #> 6       Eta log(c6/c10)     s1    1 -2.3106465      <NA>   <NA>"},{"path":"https://jsilve24.github.io/fido/reference/pcrbias_mock.html","id":null,"dir":"Reference","previous_headings":"","what":"Data from Silverman et al. (2019) bioRxiv — pcrbias_mock","title":"Data from Silverman et al. (2019) bioRxiv — pcrbias_mock","text":"Mock communities calibration samples created measuring validating model PCR bias. data preprocessed original manuscript.","code":""},{"path":"https://jsilve24.github.io/fido/reference/pcrbias_mock.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Data from Silverman et al. (2019) bioRxiv — pcrbias_mock","text":"","code":"data(pcrbias_mock)"},{"path":"https://jsilve24.github.io/fido/reference/pcrbias_mock.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Data from Silverman et al. (2019) bioRxiv — pcrbias_mock","text":"matrix Y (counts community member) data.frame metadata","code":""},{"path":"https://jsilve24.github.io/fido/reference/pcrbias_mock.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Data from Silverman et al. (2019) bioRxiv — pcrbias_mock","text":"Justin D. Silverman, Rachael J. Bloom, Sharon Jiang, Heather K. Durand, Sayan Mukherjee,  Lawrence . David. (2019) Measuring Mitigating PCR Bias Microbiome Data.  bioRxiv 604025; doi: https://doi.org/10.1101/604025","code":""},{"path":"https://jsilve24.github.io/fido/reference/pibblefit.html","id":null,"dir":"Reference","previous_headings":"","what":"Create pibblefit object — pibblefit","title":"Create pibblefit object — pibblefit","text":"Create pibblefit object","code":""},{"path":"https://jsilve24.github.io/fido/reference/pibblefit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create pibblefit object — pibblefit","text":"","code":"pibblefit(   D,   N,   Q,   coord_system,   iter = NULL,   alr_base = NULL,   ilr_base = NULL,   Eta = NULL,   Lambda = NULL,   Sigma = NULL,   Sigma_default = NULL,   Y = NULL,   X = NULL,   upsilon = NULL,   Theta = NULL,   Xi = NULL,   Xi_default = NULL,   Gamma = NULL,   init = NULL,   names_categories = NULL,   names_samples = NULL,   names_covariates = NULL )"},{"path":"https://jsilve24.github.io/fido/reference/pibblefit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create pibblefit object — pibblefit","text":"D number multinomial categories N number samples Q number covariates coord_system coordinate system objects represented (options  include \"alr\", \"clr\", \"ilr\", \"proportions\") iter number posterior samples alr_base integer category used reference  (required coord_system==\"alr\") ilr_base (D x D-1) contrast matrix (required coord_system==\"ilr\") Eta Array samples Eta Lambda Array samples Lambda Sigma Array samples Sigma (null coord_system==\"proportions\") Sigma_default Array samples Sigma alr base D, used  coord_system==\"proportions\" Y DxN matrix observed counts X QxN design matrix upsilon scalar prior dof inverse wishart prior Theta prior mean Lambda Xi Matrix prior covariance inverse wishart  (null coord_system==\"proportions\") Xi_default Matrix prior covariance inverse wishart alr  base D (used coord_system==\"proportions\") Gamma QxQ covariance matrix prior Lambda init matrix initial guess Lambda used optimization names_categories character vector names_samples character vector names_covariates character vector","code":""},{"path":"https://jsilve24.github.io/fido/reference/pibblefit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create pibblefit object — pibblefit","text":"object class pibblefit","code":""},{"path":[]},{"path":"https://jsilve24.github.io/fido/reference/pibble_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Interface to fit pibble models — pibble_fit","title":"Interface to fit pibble models — pibble_fit","text":"function largely user friendly wrapper around optimPibbleCollapsed uncollapsePibble. See details model specification. Notation: N number samples, D number multinomial categories, Q number covariates, iter number samples eta (e.g., parameter n_samples function optimPibbleCollapsed)","code":""},{"path":"https://jsilve24.github.io/fido/reference/pibble_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Interface to fit pibble models — pibble_fit","text":"","code":"pibble(   Y = NULL,   X = NULL,   upsilon = NULL,   Theta = NULL,   Gamma = NULL,   Xi = NULL,   init = NULL,   pars = c(\"Eta\", \"Lambda\", \"Sigma\"),   newdata = NULL,   ... )  # S3 method for pibblefit refit(m, pars = c(\"Eta\", \"Lambda\", \"Sigma\"), ...)"},{"path":"https://jsilve24.github.io/fido/reference/pibble_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Interface to fit pibble models — pibble_fit","text":"Y D x N matrix counts (NULL uses priors ) X Q x N matrix covariates (design matrix) (NULL uses priors , must present sample Eta) upsilon dof inverse wishart prior (numeric must > D) (default: D+3) Theta (D-1) x Q matrix prior mean regression parameters (default: matrix(0, D-1, Q)) Gamma QxQ prior covariance matrix (default: diag(Q)) Xi (D-1)x(D-1) prior covariance matrix (default: ALR transform diag(1)*(upsilon-D)/2 - essentially iid \"base scale\" using Aitchison terminology) init (D-1) x N initialization Eta optimization pars character vector posterior parameters return newdata Default NULL. non-null, newdata used uncollapse sampler place X. ... arguments passed optimPibbleCollapsed uncollapsePibble m object class pibblefit","code":""},{"path":"https://jsilve24.github.io/fido/reference/pibble_fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Interface to fit pibble models — pibble_fit","text":"object class pibblefit","code":""},{"path":"https://jsilve24.github.io/fido/reference/pibble_fit.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Interface to fit pibble models — pibble_fit","text":"full model given : $$Y_j \\sim Multinomial(Pi_j)$$ $$Pi_j = Phi^{-1}(Eta_j)$$ $$Eta \\sim MN_{D-1 x N}(Lambda*X, Sigma, I_N)$$ $$Lambda \\sim MN_{D-1 x Q}(Theta, Sigma, Gamma)$$ $$Sigma \\sim InvWish(upsilon, Xi)$$ Gamma Q x Q covariance matrix, \\(Phi^{-1}\\) ALRInv_D transform. Default behavior use MAP estimate uncollaping LTP model laplace approximation preformed.","code":""},{"path":"https://jsilve24.github.io/fido/reference/pibble_fit.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Interface to fit pibble models — pibble_fit","text":"JD Silverman K Roche, ZC Holmes, LA David, S Mukherjee.    Bayesian Multinomial Logistic Normal Models Marginally Latent Matrix-T Processes.    2019, arXiv e-prints, arXiv:1903.11695","code":""},{"path":[]},{"path":"https://jsilve24.github.io/fido/reference/pibble_fit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Interface to fit pibble models — pibble_fit","text":"","code":"sim <- pibble_sim() fit <- pibble(sim$Y, sim$X)"},{"path":"https://jsilve24.github.io/fido/reference/pibble_sim.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate simple pibble dataset and priors (for testing) — pibble_sim","title":"Simulate simple pibble dataset and priors (for testing) — pibble_sim","text":"Simulate simple pibble dataset priors (testing)","code":""},{"path":"https://jsilve24.github.io/fido/reference/pibble_sim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate simple pibble dataset and priors (for testing) — pibble_sim","text":"","code":"pibble_sim(D = 10, N = 30, Q = 2, use_names = TRUE, true_priors = FALSE)"},{"path":"https://jsilve24.github.io/fido/reference/pibble_sim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate simple pibble dataset and priors (for testing) — pibble_sim","text":"D number multinomial categories N number samples Q number covariates (first one intercept, must > 1) use_names samples, covariates, categories named true_priors Xi upsilon chosen mean true  simulated value","code":""},{"path":"https://jsilve24.github.io/fido/reference/pibble_sim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate simple pibble dataset and priors (for testing) — pibble_sim","text":"list","code":""},{"path":"https://jsilve24.github.io/fido/reference/pibble_sim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate simple pibble dataset and priors (for testing) — pibble_sim","text":"","code":"sim <- pibble_sim()"},{"path":"https://jsilve24.github.io/fido/reference/pibble_tidy_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert pibble samples of Eta Lambda and Sigma to tidy format — pibble_tidy_samples","title":"Convert pibble samples of Eta Lambda and Sigma to tidy format — pibble_tidy_samples","text":"Combines single tibble, see example formatting  column headers. Primarily designed used  summary.pibblefit.","code":""},{"path":"https://jsilve24.github.io/fido/reference/pibble_tidy_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert pibble samples of Eta Lambda and Sigma to tidy format — pibble_tidy_samples","text":"","code":"pibble_tidy_samples(m, use_names = FALSE, as_factor = FALSE)"},{"path":"https://jsilve24.github.io/fido/reference/pibble_tidy_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert pibble samples of Eta Lambda and Sigma to tidy format — pibble_tidy_samples","text":"m object class pibblefit use_names dimension indices replaced dimension names provided data used fit pibble model. as_factor use_names names returned factor?","code":""},{"path":"https://jsilve24.github.io/fido/reference/pibble_tidy_samples.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert pibble samples of Eta Lambda and Sigma to tidy format — pibble_tidy_samples","text":"tibble","code":""},{"path":"https://jsilve24.github.io/fido/reference/pibble_tidy_samples.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert pibble samples of Eta Lambda and Sigma to tidy format — pibble_tidy_samples","text":"","code":"sim <- pibble_sim() fit <- pibble(sim$Y, sim$X) fit_tidy <- pibble_tidy_samples(fit, use_names=TRUE) head(fit_tidy) #>   Parameter       coord sample iter          val covariate coord2 #> 1       Eta log(c1/c10)     s1    1  4.092298753      <NA>   <NA> #> 2       Eta log(c2/c10)     s1    1  4.480205759      <NA>   <NA> #> 3       Eta log(c3/c10)     s1    1 -0.969638768      <NA>   <NA> #> 4       Eta log(c4/c10)     s1    1  5.575328028      <NA>   <NA> #> 5       Eta log(c5/c10)     s1    1  0.001909711      <NA>   <NA> #> 6       Eta log(c6/c10)     s1    1  1.116070821      <NA>   <NA>"},{"path":"https://jsilve24.github.io/fido/reference/plot.pibblefit.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Summaries of Posterior Distribution of pibblefit Parameters — plot.pibblefit","title":"Plot Summaries of Posterior Distribution of pibblefit Parameters — plot.pibblefit","text":"Plot Summaries Posterior Distribution pibblefit Parameters","code":""},{"path":"https://jsilve24.github.io/fido/reference/plot.pibblefit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Summaries of Posterior Distribution of pibblefit Parameters — plot.pibblefit","text":"","code":"# S3 method for pibblefit plot(x, ...)"},{"path":"https://jsilve24.github.io/fido/reference/plot.pibblefit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Summaries of Posterior Distribution of pibblefit Parameters — plot.pibblefit","text":"x object class pibblefit ... arguments passed plot.pibblefit (see details)","code":""},{"path":"https://jsilve24.github.io/fido/reference/plot.pibblefit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Summaries of Posterior Distribution of pibblefit Parameters — plot.pibblefit","text":"ggplot object","code":""},{"path":"https://jsilve24.github.io/fido/reference/plot.pibblefit.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Summaries of Posterior Distribution of pibblefit Parameters — plot.pibblefit","text":"arguments: `par` parameter plot (options: Lambda, Eta, Sigma)    (default=\"Lambda\") `focus.cov` vector covariates include plot (plots NULL) `focus.coord` vector coordinates include plot (plots NULL) `focus.sample` vector samples include plot (plots NULL) `use_names` TRUE, uses dimension names found data plot labels   rather using dimension integer indices.","code":""},{"path":"https://jsilve24.github.io/fido/reference/plot.pibblefit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Summaries of Posterior Distribution of pibblefit Parameters — plot.pibblefit","text":"","code":"sim <- pibble_sim(N=10, D=4, Q=3) fit <- pibble(sim$Y, sim$X) plot(fit, par=\"Lambda\") #> Scale for colour is already present. #> Adding another scale for colour, which will replace the existing scale.  plot(fit, par=\"Sigma\")"},{"path":"https://jsilve24.github.io/fido/reference/ppc.html","id":null,"dir":"Reference","previous_headings":"","what":"Generic method for visualizing posterior predictive checks — ppc","title":"Generic method for visualizing posterior predictive checks — ppc","text":"Generic method visualizing posterior predictive checks","code":""},{"path":"https://jsilve24.github.io/fido/reference/ppc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generic method for visualizing posterior predictive checks — ppc","text":"","code":"ppc(m, ...)"},{"path":"https://jsilve24.github.io/fido/reference/ppc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generic method for visualizing posterior predictive checks — ppc","text":"m object ... arguments passed control visualization","code":""},{"path":"https://jsilve24.github.io/fido/reference/ppc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generic method for visualizing posterior predictive checks — ppc","text":"plot","code":""},{"path":"https://jsilve24.github.io/fido/reference/ppc.pibblefit.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualization of Posterior Predictive Check of fit model — ppc.pibblefit","title":"Visualization of Posterior Predictive Check of fit model — ppc.pibblefit","text":"Visualization Posterior Predictive Check fit model","code":""},{"path":"https://jsilve24.github.io/fido/reference/ppc.pibblefit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualization of Posterior Predictive Check of fit model — ppc.pibblefit","text":"","code":"# S3 method for pibblefit ppc(m, ...)"},{"path":"https://jsilve24.github.io/fido/reference/ppc.pibblefit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualization of Posterior Predictive Check of fit model — ppc.pibblefit","text":"m object class pibblefit ... options passed ppc (see details)","code":""},{"path":"https://jsilve24.github.io/fido/reference/ppc.pibblefit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualization of Posterior Predictive Check of fit model — ppc.pibblefit","text":"ggplot object","code":""},{"path":"https://jsilve24.github.io/fido/reference/ppc.pibblefit.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Visualization of Posterior Predictive Check of fit model — ppc.pibblefit","text":"ppc.pibblefit accepts following additional arguments: \"type\" type plot (options \"lines\",  \"points\", \"bounds\") \"iter\" number samples posterior predictive distribution plot   (currently must <= m$iter) type==\"lines\" default 50, type==\"ribbon\"   default use available iterations. \"from_scratch\" predictions Y come fitted Eta    predictions Eta posterior Lambda? (default: false)","code":""},{"path":"https://jsilve24.github.io/fido/reference/ppc.pibblefit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualization of Posterior Predictive Check of fit model — ppc.pibblefit","text":"","code":"sim <- pibble_sim() fit <- pibble(sim$Y, sim$X) ppc(fit)"},{"path":"https://jsilve24.github.io/fido/reference/ppc_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Generic Method to Plot Posterior Predictive Summaries — ppc_summary.pibblefit","title":"Generic Method to Plot Posterior Predictive Summaries — ppc_summary.pibblefit","text":"Generic Method Plot Posterior Predictive Summaries","code":""},{"path":"https://jsilve24.github.io/fido/reference/ppc_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generic Method to Plot Posterior Predictive Summaries — ppc_summary.pibblefit","text":"","code":"# S3 method for pibblefit ppc_summary(m, from_scratch = FALSE, ...)  ppc_summary(m, ...)"},{"path":"https://jsilve24.github.io/fido/reference/ppc_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generic Method to Plot Posterior Predictive Summaries — ppc_summary.pibblefit","text":"m model object from_scratch predictions Y come fitted Eta  predictions Eta posterior Lambda? (default: false) ... arguments pass","code":""},{"path":"https://jsilve24.github.io/fido/reference/ppc_summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generic Method to Plot Posterior Predictive Summaries — ppc_summary.pibblefit","text":"vector","code":""},{"path":"https://jsilve24.github.io/fido/reference/predict.bassetfit.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict using basset — predict.bassetfit","title":"Predict using basset — predict.bassetfit","text":"Predict using basset","code":""},{"path":"https://jsilve24.github.io/fido/reference/predict.bassetfit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict using basset — predict.bassetfit","text":"","code":"# S3 method for bassetfit predict(   object,   newdata = NULL,   response = \"Lambda\",   size = NULL,   use_names = TRUE,   summary = FALSE,   iter = NULL,   from_scratch = FALSE,   ... )"},{"path":"https://jsilve24.github.io/fido/reference/predict.bassetfit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict using basset — predict.bassetfit","text":"object object class pibblefit newdata optional matrix evaluate prediction. response Options = \"Lambda\":Mean regression, \"Eta\", \"Y\": counts size number counts per sample response=\"Y\" (vector matrix),  default newdata=NULL response=\"Y\" use colsums m$Y. Otherwise uses median colsums object$Y default. passed matrix dimensions ncol(newdata) x iter. use_names TRUE apply names output summary TRUE, posterior summary predictions returned rather samples iter number iterations return NULL uses object$iter from_scratch predictions Y come fitted Eta  predictions Eta posterior Lambda? (default: false) ... arguments passed summarise_posterior","code":""},{"path":"https://jsilve24.github.io/fido/reference/predict.bassetfit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict using basset — predict.bassetfit","text":"(summary==FALSE) array D x N x iter; (summary==TRUE)  tibble calculated posterior summaries","code":""},{"path":"https://jsilve24.github.io/fido/reference/predict.bassetfit.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict using basset — predict.bassetfit","text":"currently implemented pibblefit objects coord_system \"default\" \"alr\", \"ilr\".","code":""},{"path":"https://jsilve24.github.io/fido/reference/predict.pibblefit.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict response from new data — predict.pibblefit","title":"Predict response from new data — predict.pibblefit","text":"Predict response new data","code":""},{"path":"https://jsilve24.github.io/fido/reference/predict.pibblefit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict response from new data — predict.pibblefit","text":"","code":"# S3 method for pibblefit predict(   object,   newdata = NULL,   response = \"LambdaX\",   size = NULL,   use_names = TRUE,   summary = FALSE,   iter = NULL,   from_scratch = FALSE,   ... )"},{"path":"https://jsilve24.github.io/fido/reference/predict.pibblefit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict response from new data — predict.pibblefit","text":"object object class pibblefit newdata optional matrix evaluate predictions. NULL (default), original data model used. response Options = \"LambdaX\":Mean regression, \"Eta\", \"Y\": counts size number counts per sample response=\"Y\" (vector matrix),  default newdata=NULL response=\"Y\" use colsums m$Y. Otherwise uses median colsums m$Y default. passed matrix dimensions ncol(newdata) x iter. use_names TRUE apply names output summary TRUE, posterior summary predictions returned rather samples iter number iterations return NULL uses object$iter from_scratch predictions Y come fitted Eta  predictions Eta posterior Lambda? (default: false) ... arguments passed summarise_posterior","code":""},{"path":"https://jsilve24.github.io/fido/reference/predict.pibblefit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict response from new data — predict.pibblefit","text":"(summary==FALSE) array D x N x iter; (summary==TRUE)  tibble calculated posterior summaries","code":""},{"path":"https://jsilve24.github.io/fido/reference/predict.pibblefit.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict response from new data — predict.pibblefit","text":"currently implemented pibblefit objects coord_system \"default\" \"alr\", \"ilr\".","code":""},{"path":"https://jsilve24.github.io/fido/reference/predict.pibblefit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predict response from new data — predict.pibblefit","text":"","code":"sim <- pibble_sim() fit <- pibble(sim$Y, sim$X) predict(fit)[,,1:2] # just show 2 samples #> , , 1 #>  #>                      s1          s2         s3         s4          s5 #> log(c1/c10) -0.70404170  -1.0723053 -0.5401210 -0.9485413 -0.63356566 #> log(c2/c10) -0.18980937  -7.7979140  3.1966933 -5.2410247  1.26618322 #> log(c3/c10) -2.63165792 -10.9043126  1.0506478 -8.1240850 -1.04848781 #> log(c4/c10) -0.18526606  -8.3487948  3.4484658 -5.6052416  1.37702019 #> log(c5/c10)  2.19245163   6.1463273  0.4325113  4.8175308  1.43578307 #> log(c6/c10) -0.01765007  -0.5256616  0.2084749 -0.3549319  0.07957007 #> log(c7/c10)  3.96296538   0.9533097  5.3026167  1.9647779  4.53893491 #> log(c8/c10) -1.06290426   4.3362744 -3.4661747  2.5217486 -2.09616608 #> log(c9/c10) -4.14987279  -4.2936457 -4.0858769 -4.2453273 -4.12235841 #>                      s6         s7         s8           s9        s10 #> log(c1/c10) -0.72281157 -0.8824675 -0.7842723 -0.777165454 -0.5425485 #> log(c2/c10) -0.57758358 -3.8759788 -1.8473252 -1.700502257  3.1465432 #> log(c3/c10) -3.05330330 -6.6398056 -4.4339538 -4.274306273  0.9961171 #> log(c4/c10) -0.60134944 -4.1405416 -1.9637876 -1.806245966  3.3946544 #> log(c5/c10)  2.39397502  4.1081266  3.0538503  2.977547539  0.4585739 #> log(c6/c10) -0.04354269 -0.2637845 -0.1283264 -0.118522677  0.2051262 #> log(c7/c10)  3.80956753  2.5047703  3.3072762  3.365357208  5.2827780 #> log(c8/c10) -0.78771584  1.5530281  0.1133708  0.009176261 -3.4305850 #> log(c9/c10) -4.15720069 -4.2195316 -4.1811954 -4.178420864 -4.0868246 #>                     s11         s12        s13          s14        s15 #> log(c1/c10) -0.70474316 -0.76041767 -0.4192360 -0.776121738 -0.8240135 #> log(c2/c10) -0.20430126 -1.35450317  5.6941047 -1.678939717 -2.6683549 #> log(c3/c10) -2.64741564 -3.89808498  3.7662021 -4.250860296 -5.3266986 #> log(c4/c10) -0.20081592 -1.43498747  6.1281988 -1.783109269 -2.8447560 #> log(c5/c10)  2.19998296  2.79773438 -0.8653749  2.966341646  3.4805334 #> log(c6/c10) -0.01861773 -0.09541948  0.3752331 -0.117082895 -0.1831485 #> log(c7/c10)  3.95723260  3.50222942  6.2905563  3.373887036  2.9824887 #> log(c8/c10) -1.05261992 -0.23636596 -5.2384913 -0.006125842  0.6960240 #> log(c9/c10) -4.15014665 -4.17188240 -4.0386825 -4.178013390 -4.1967107 #>                    s16        s17        s18        s19        s20        s21 #> log(c1/c10) -0.9556897 -0.8554379 -0.7868995 -0.3634543 -0.8001980 -0.4876735 #> log(c2/c10) -5.3887062 -3.3175632 -1.9016024  6.8465218 -2.1763403  4.2802265 #> log(c3/c10) -8.2846662 -6.0326137 -4.4929720  5.0192802 -4.7917077  2.2288251 #> log(c4/c10) -5.7637045 -3.5413592 -2.0220273  7.3647473 -2.3168223  4.6111015 #> log(c5/c10)  4.8942798  3.8179221  3.0820578 -1.4642776  3.2248371 -0.1305929 #> log(c6/c10) -0.3647929 -0.2264977 -0.1319506  0.4521827 -0.1502955  0.2808250 #> log(c7/c10)  1.9063573  2.7256714  3.2858049  6.7464358  3.1771226  5.7312467 #> log(c8/c10)  2.6265524  1.1567421  0.1518893 -6.0563173  0.3468602 -4.2351164 #> log(c9/c10) -4.2481181 -4.2089790 -4.1822211 -4.0169049 -4.1874129 -4.0654010 #>                    s22        s23        s24         s25        s26        s27 #> log(c1/c10) -0.8731613 -0.6065824 -0.4267227 -0.65880368 -0.7858590 -0.9922782 #> log(c2/c10) -3.6837192  1.8236416  5.5394347  0.74478081 -1.8801062 -6.1446032 #> log(c3/c10) -6.4307526 -0.4423368  3.5980221 -1.61543349 -4.4695982 -9.1065889 #> log(c4/c10) -3.9342462  1.9751754  5.9622373  0.81755318 -1.9989618 -6.5747852 #> log(c5/c10)  4.0082107  1.1460761 -0.7849941  1.70675204  3.0708864  5.2871139 #> log(c6/c10) -0.2509469  0.1167929  0.3649054  0.04475477 -0.1305153 -0.4152660 #> log(c7/c10)  2.5808254  4.7594573  6.2293711  4.33267568  3.2943085  1.6073354 #> log(c8/c10)  1.4165889 -2.4917728 -5.1287280 -1.72614688  0.1366343  3.1629834 #> log(c9/c10) -4.2158984 -4.1118239 -4.0416053 -4.13221152 -4.1818149 -4.2624025 #>                    s28        s29        s30 #> log(c1/c10) -0.7340740 -0.6745065 -0.9711141 #> log(c2/c10) -0.8102577  0.4203703 -5.7073648 #> log(c3/c10) -3.3063010 -1.9681804 -8.6311589 #> log(c4/c10) -0.8510098  0.4694594 -6.1056266 #> log(c5/c10)  2.5148941  1.8753458  5.0598843 #> log(c6/c10) -0.0590789  0.0230931 -0.3860706 #> log(c7/c10)  3.7175250  4.2043436  1.7803005 #> log(c8/c10) -0.6225960 -1.4959253  2.8526922 #> log(c9/c10) -4.1615976 -4.1383420 -4.2541399 #>  #> , , 2 #>  #>                      s1          s2          s3         s4         s5 #> log(c1/c10) -0.78034714  -0.6578935 -0.83485344 -0.6990470 -0.8037816 #> log(c2/c10)  0.09605189  -7.0955013  3.29714012 -4.6786043  1.4723274 #> log(c3/c10) -3.23050215 -10.4350195 -0.02364334 -8.0137656 -1.8517456 #> log(c4/c10)  0.49931591  -7.0058217  3.83998616 -4.4835370  1.9356033 #> log(c5/c10)  1.35801089   5.7621210 -0.60233686  4.2820123  0.5151792 #> log(c6/c10) -0.30332304   0.9731533 -0.87150535  0.5441622 -0.5476073 #> log(c7/c10)  3.99882759   3.0602134  4.41662145  3.3756576  4.1784538 #> log(c8/c10) -2.04712903   3.5101742 -4.52078356  1.6425068 -3.1106518 #> log(c9/c10) -4.68344683  -2.8566426 -5.49658988 -3.4705848 -5.0330495 #>                     s6         s7          s8          s9         s10 #> log(c1/c10) -0.7741059 -0.7210177 -0.75366916 -0.75603230 -0.83404626 #> log(c2/c10) -0.2704913 -3.3882960 -1.47071326 -1.33192903  3.24973572 #> log(c3/c10) -3.5977061 -6.7211313 -4.80009170 -4.66105728 -0.07113319 #> log(c4/c10)  0.1167898 -3.1369654 -1.13576733 -0.99093148  3.79051472 #> log(c5/c10)  1.5824821  3.4918270  2.31749851  2.23250699 -0.57330639 #> log(c6/c10) -0.2382629  0.3151369 -0.02522754 -0.04986127 -0.86309123 #> log(c7/c10)  3.9509878  3.5440638  3.79433936  3.81245295  4.41043441 #> log(c8/c10) -1.7638812  0.6454156 -0.83640460 -0.94365071 -4.48415161 #> log(c9/c10) -4.5903372 -3.7983499 -4.28545587 -4.32070995 -5.48454818 #>                     s11        s12        s13        s14        s15        s16 #> log(c1/c10) -0.78011389 -0.7616012 -0.8750497 -0.7563793 -0.7404546 -0.6966701 #> log(c2/c10)  0.08235345 -1.0048737  5.6578157 -1.3115471 -2.2467908 -4.8182001 #> log(c3/c10) -3.24422529 -4.3334124  2.3412878 -4.6406386 -5.5775682 -8.1536130 #> log(c4/c10)  0.48502016 -0.6496151  6.3035979 -0.9696608 -1.9456854 -4.6292198 #> log(c5/c10)  1.36639982  2.0322182 -2.0480155  2.2200251  2.7927687  4.3675008 #> log(c6/c10) -0.30089161 -0.1079125 -1.2905173 -0.0534790  0.1125236  0.5689400 #> log(c7/c10)  3.99703972  3.8551390  4.7247278  3.8151131  3.6930487  3.3574381 #> log(c8/c10) -2.03654350 -1.1963841 -6.3450056 -0.9594010 -0.2366874  1.7503800 #> log(c9/c10) -4.67996714 -4.4037888 -6.0962506 -4.3258874 -4.0883160 -3.4351245 #>                    s17         s18       s19         s20        s21        s22 #> log(c1/c10) -0.7300054 -0.75279556 -0.893598 -0.74837361 -0.8522931 -0.7241121 #> log(c2/c10) -2.8604542 -1.52201871  6.747137 -1.78171450  4.3213488 -3.2065628 #> log(c3/c10) -6.1923379 -4.85148964  3.432573 -5.11165358  1.0024117 -6.5390705 #> log(c4/c10) -2.5861073 -1.18930994  7.440418 -1.46032964  4.9088550 -2.9473079 #> log(c5/c10)  3.1685764  2.34891799 -2.715116  2.50795579 -1.2295627  3.3805335 #> log(c6/c10)  0.2214468 -0.01612099 -1.483868  0.02997413 -1.0532989  0.2828799 #> log(c7/c10)  3.6129557  3.78764317  4.866902  3.75374867  4.5502973  3.5677829 #> log(c8/c10)  0.2375236 -0.79675809 -7.186783 -0.59607707 -5.3122451  0.5049805 #> log(c9/c10) -3.9324327 -4.27242321 -6.372961 -4.20645508 -5.7567602 -3.8445139 #>                    s23        s24        s25         s26        s27        s28 #> log(c1/c10) -0.8127540 -0.8725602 -0.7953895 -0.75314154 -0.6845038 -0.7703609 #> log(c2/c10)  1.9992643  5.5116140  0.9794723 -1.50169947 -5.5327109 -0.4904263 #> log(c3/c10) -1.3238588  2.1948226 -2.3454892 -4.83113377 -8.8694119 -3.8180376 #> log(c4/c10)  2.4855171  6.1510212  1.4212575 -1.16810468 -5.3748866 -0.1127354 #> log(c5/c10)  0.1924828 -1.9584816  0.8170039  2.33647448  4.8050675  1.7171704 #> log(c6/c10) -0.6411368 -1.2645670 -0.4601272 -0.01972759  0.6957633 -0.1992251 #> log(c7/c10)  4.2472276  4.7056462  4.1141283  3.79029516  3.2641829  3.9222827 #> log(c8/c10) -3.5178445 -6.2320277 -2.7297959 -0.81245987  2.3025213 -1.5939255 #> log(c9/c10) -5.1669024 -6.0591124 -4.9078540 -4.27758472 -3.2536239 -4.5344692 #>                    s29        s30 #> log(c1/c10) -0.7901681 -0.6915412 #> log(c2/c10)  0.6728236 -5.1194118 #> log(c3/c10) -2.6526907 -8.4553677 #> log(c4/c10)  1.1012375 -4.9435658 #> log(c5/c10)  1.0047956  4.5519630 #> log(c6/c10) -0.4056981  0.6224041 #> log(c7/c10)  4.0741056  3.3181251 #> log(c8/c10) -2.4928319  1.9831427 #> log(c9/c10) -4.8299589 -3.3586105 #>"},{"path":"https://jsilve24.github.io/fido/reference/print.orthusfit.html","id":null,"dir":"Reference","previous_headings":"","what":"Print dimensions and coordinate system information for orthusfit object. — print.orthusfit","title":"Print dimensions and coordinate system information for orthusfit object. — print.orthusfit","text":"Print dimensions coordinate system information orthusfit object.","code":""},{"path":"https://jsilve24.github.io/fido/reference/print.orthusfit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print dimensions and coordinate system information for orthusfit object. — print.orthusfit","text":"","code":"# S3 method for orthusfit print(x, summary = FALSE, ...)"},{"path":"https://jsilve24.github.io/fido/reference/print.orthusfit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print dimensions and coordinate system information for orthusfit object. — print.orthusfit","text":"x object class orthusfit summary true also calculates prints summary ... arguments pass summary function","code":""},{"path":"https://jsilve24.github.io/fido/reference/print.orthusfit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print dimensions and coordinate system information for orthusfit object. — print.orthusfit","text":"direct return, prints summary","code":""},{"path":[]},{"path":"https://jsilve24.github.io/fido/reference/print.orthusfit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print dimensions and coordinate system information for orthusfit object. — print.orthusfit","text":"","code":"sim <- orthus_sim() fit <- orthus(sim$Y, sim$Z, sim$X) print(fit) #> orthusfit Object:  #>   Number of Samples:\t\t 30  #>   Number of Categories:\t\t 10  #>   Number of Zdimensions:\t 10  #>   Number of Covariates:\t\t 2  #>   Number of Posterior Samples:\t 2000  #>   Contains Samples of Parameters:Eta  Lambda  Sigma #>   Coordinate System:\t\t alr, reference category: 10 [c10]"},{"path":"https://jsilve24.github.io/fido/reference/print.pibblefit.html","id":null,"dir":"Reference","previous_headings":"","what":"Print dimensions and coordinate system information for pibblefit object. — print.pibblefit","title":"Print dimensions and coordinate system information for pibblefit object. — print.pibblefit","text":"Print dimensions coordinate system information pibblefit object.","code":""},{"path":"https://jsilve24.github.io/fido/reference/print.pibblefit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print dimensions and coordinate system information for pibblefit object. — print.pibblefit","text":"","code":"# S3 method for pibblefit print(x, summary = FALSE, ...)"},{"path":"https://jsilve24.github.io/fido/reference/print.pibblefit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print dimensions and coordinate system information for pibblefit object. — print.pibblefit","text":"x object class pibblefit summary true also calculates prints summary ... arguments pass summary function","code":""},{"path":"https://jsilve24.github.io/fido/reference/print.pibblefit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print dimensions and coordinate system information for pibblefit object. — print.pibblefit","text":"direct return, prints summary","code":""},{"path":[]},{"path":"https://jsilve24.github.io/fido/reference/print.pibblefit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print dimensions and coordinate system information for pibblefit object. — print.pibblefit","text":"","code":"sim <- pibble_sim() fit <- pibble(sim$Y, sim$X) print(fit) #> pibblefit Object:  #>   Number of Samples:\t\t 30  #>   Number of Categories:\t\t 10  #>   Number of Covariates:\t\t 2  #>   Number of Posterior Samples:\t 2000  #>   Contains Samples of Parameters:Eta  Lambda  Sigma #>   Coordinate System:\t\t alr, reference category: 10 [c10]  #>   Log Marginal Likelihood:\t -1973.695"},{"path":"https://jsilve24.github.io/fido/reference/r2.html","id":null,"dir":"Reference","previous_headings":"","what":"Generic Method to Calculate R2 for Fitted Model — r2","title":"Generic Method to Calculate R2 for Fitted Model — r2","text":"Generic Method Calculate R2 Fitted Model","code":""},{"path":"https://jsilve24.github.io/fido/reference/r2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generic Method to Calculate R2 for Fitted Model — r2","text":"","code":"r2(m, ...)  # S3 method for pibblefit r2(m, covariates = NULL, ...)  # S3 method for bassetfit r2(m, covariates = NULL, components = NULL, ...)"},{"path":"https://jsilve24.github.io/fido/reference/r2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generic Method to Calculate R2 for Fitted Model — r2","text":"m model object ... arguments pass covariates vector indices covariates include calculation R2 (default:NULL means include covariates default). non-null, covariates specified set zero prediction. components vector indices components GP model include calculation R2, .e. elements list Theta/Gamma used calculating R2 (default:NULL means include components default). non-null, components specified removed prediction.","code":""},{"path":"https://jsilve24.github.io/fido/reference/r2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generic Method to Calculate R2 for Fitted Model — r2","text":"vector","code":""},{"path":"https://jsilve24.github.io/fido/reference/r2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generic Method to Calculate R2 for Fitted Model — r2","text":"Calculates Posterior Linear Model R2 : $$1-\\frac{SS_{res}}{SS_{tot}}$$   \\(SS\\) defined terms trace variances Method calculating R2 multivariate version Bayesian R2 proposed   Gelman, Goodrich, Gabry, Vehtari, 2019 Calculates Posterior Basset Model R2 :   $$1-\\frac{SS_{res}}{SS_tot}$$ Method calculating R2 multivariate version Bayesian R2 proposed   Gelman, Goodrich, Gabry, Vehtari, 2019","code":""},{"path":"https://jsilve24.github.io/fido/reference/random_pibble_init.html","id":null,"dir":"Reference","previous_headings":"","what":"Provide random initialization for pibble model — random_pibble_init","title":"Provide random initialization for pibble model — random_pibble_init","text":"Randomly initializes based ALR transform counts plus random pseudocounts uniformily distributed  0 1.","code":""},{"path":"https://jsilve24.github.io/fido/reference/random_pibble_init.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Provide random initialization for pibble model — random_pibble_init","text":"","code":"random_pibble_init(Y)"},{"path":"https://jsilve24.github.io/fido/reference/random_pibble_init.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Provide random initialization for pibble model — random_pibble_init","text":"Y matrix (D x N) counts","code":""},{"path":"https://jsilve24.github.io/fido/reference/random_pibble_init.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Provide random initialization for pibble model — random_pibble_init","text":"(D-1) x N matrix","code":""},{"path":"https://jsilve24.github.io/fido/reference/random_pibble_init.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Provide random initialization for pibble model — random_pibble_init","text":"Notation: N number samples D number multinomial categories","code":""},{"path":"https://jsilve24.github.io/fido/reference/random_pibble_init.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Provide random initialization for pibble model — random_pibble_init","text":"","code":"Y <- matrix(sample(1:100, 100), 10, 10) random_pibble_init(Y) #>              [,1]       [,2]       [,3]       [,4]       [,5]       [,6] #>  [1,] -0.13743727 -0.3312002 -1.5952317  2.5896872  1.0364971  0.7134912 #>  [2,] -0.03605466 -1.0946291  0.4302611  1.7693657  1.2425171  0.8972791 #>  [3,] -0.98053047 -1.0006552 -0.3529571  2.8586754  0.1886809  0.8603231 #>  [4,] -0.04712701  0.3486153 -1.2748981 -0.8325446  0.6011610  1.8485723 #>  [5,] -0.20535453  0.5282856 -0.6949068  2.4347884  0.7002748 -0.3407350 #>  [6,]  0.43013291 -0.2163443 -0.8447681  1.4769015  0.2124275  1.9787427 #>  [7,]  0.14265373 -0.0971531 -1.4255502  1.8172756 -0.5752273  1.2281001 #>  [8,] -2.58595155 -1.0625784  0.0375343  2.5399985 -0.9885152  1.6870342 #>  [9,] -0.46374826 -0.9394908  0.4786111  2.8058892  0.6653587  2.0580245 #>             [,7]        [,8]        [,9]      [,10] #>  [1,]  0.7968142  0.44298835 -0.15629481  1.6804717 #>  [2,]  0.4671822 -1.06688846 -2.42821498  1.9322217 #>  [3,]  0.8580515  0.26008043 -0.13261153  2.5100225 #>  [4,]  1.0455422 -0.36516180  0.09458404  2.5321603 #>  [5,]  0.8988951  0.43221338 -0.67354694  2.3401178 #>  [6,] -3.1160542 -0.33808636 -2.04372820  0.9544726 #>  [7,]  0.9815253 -0.02679923  0.13288455 -0.7066310 #>  [8,]  1.1179594  0.19562534 -0.20936590  1.7681255 #>  [9,]  0.6984627 -0.60785405  0.17259204  2.3099825"},{"path":"https://jsilve24.github.io/fido/reference/refit.html","id":null,"dir":"Reference","previous_headings":"","what":"Generic method for fitting model from passed model fit object — refit","title":"Generic method for fitting model from passed model fit object — refit","text":"Generic method fitting model passed model fit object","code":""},{"path":"https://jsilve24.github.io/fido/reference/refit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generic method for fitting model from passed model fit object — refit","text":"","code":"refit(m, ...)"},{"path":"https://jsilve24.github.io/fido/reference/refit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generic method for fitting model from passed model fit object — refit","text":"m object ... arguments passed control fitting","code":""},{"path":"https://jsilve24.github.io/fido/reference/refit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generic method for fitting model from passed model fit object — refit","text":"object class m","code":""},{"path":"https://jsilve24.github.io/fido/reference/req.html","id":null,"dir":"Reference","previous_headings":"","what":"Generic method for ensuring object contains required elements — req","title":"Generic method for ensuring object contains required elements — req","text":"Intended called internally package","code":""},{"path":"https://jsilve24.github.io/fido/reference/req.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generic method for ensuring object contains required elements — req","text":"","code":"req(m, r)"},{"path":"https://jsilve24.github.io/fido/reference/req.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generic method for ensuring object contains required elements — req","text":"m object r vector elements test ","code":""},{"path":"https://jsilve24.github.io/fido/reference/req.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generic method for ensuring object contains required elements — req","text":"throws error required element present","code":""},{"path":"https://jsilve24.github.io/fido/reference/req.maltipoofit.html","id":null,"dir":"Reference","previous_headings":"","what":"require elements to be non-null in pibblefit or throw error — req.maltipoofit","title":"require elements to be non-null in pibblefit or throw error — req.maltipoofit","text":"require elements non-null pibblefit throw error","code":""},{"path":"https://jsilve24.github.io/fido/reference/req.maltipoofit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"require elements to be non-null in pibblefit or throw error — req.maltipoofit","text":"","code":"# S3 method for maltipoofit req(m, r)"},{"path":"https://jsilve24.github.io/fido/reference/req.maltipoofit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"require elements to be non-null in pibblefit or throw error — req.maltipoofit","text":"m object r vector elements test ","code":""},{"path":"https://jsilve24.github.io/fido/reference/req.maltipoofit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"require elements to be non-null in pibblefit or throw error — req.maltipoofit","text":"Throws error null","code":""},{"path":"https://jsilve24.github.io/fido/reference/req.orthusfit.html","id":null,"dir":"Reference","previous_headings":"","what":"require elements to be non-null in orthusfit or throw error — req.orthusfit","title":"require elements to be non-null in orthusfit or throw error — req.orthusfit","text":"require elements non-null orthusfit throw error","code":""},{"path":"https://jsilve24.github.io/fido/reference/req.orthusfit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"require elements to be non-null in orthusfit or throw error — req.orthusfit","text":"","code":"# S3 method for orthusfit req(m, r)"},{"path":"https://jsilve24.github.io/fido/reference/req.orthusfit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"require elements to be non-null in orthusfit or throw error — req.orthusfit","text":"m object r vector elements test ","code":""},{"path":"https://jsilve24.github.io/fido/reference/req.orthusfit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"require elements to be non-null in orthusfit or throw error — req.orthusfit","text":"None, throws error NULL","code":""},{"path":"https://jsilve24.github.io/fido/reference/req.pibblefit.html","id":null,"dir":"Reference","previous_headings":"","what":"require elements to be non-null in pibblefit or throw error — req.pibblefit","title":"require elements to be non-null in pibblefit or throw error — req.pibblefit","text":"require elements non-null pibblefit throw error","code":""},{"path":"https://jsilve24.github.io/fido/reference/req.pibblefit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"require elements to be non-null in pibblefit or throw error — req.pibblefit","text":"","code":"# S3 method for pibblefit req(m, r)"},{"path":"https://jsilve24.github.io/fido/reference/req.pibblefit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"require elements to be non-null in pibblefit or throw error — req.pibblefit","text":"m object r vector elements test ","code":""},{"path":"https://jsilve24.github.io/fido/reference/req.pibblefit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"require elements to be non-null in pibblefit or throw error — req.pibblefit","text":"Nothing, throws error NULL","code":""},{"path":"https://jsilve24.github.io/fido/reference/sample_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Generic method for sampling from prior distribution of object — sample_prior","title":"Generic method for sampling from prior distribution of object — sample_prior","text":"Generic method sampling prior distribution object","code":""},{"path":"https://jsilve24.github.io/fido/reference/sample_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generic method for sampling from prior distribution of object — sample_prior","text":"","code":"sample_prior(m, n_samples = 2000L, ...)"},{"path":"https://jsilve24.github.io/fido/reference/sample_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generic method for sampling from prior distribution of object — sample_prior","text":"m object n_samples number samples produce ... arguments passed","code":""},{"path":"https://jsilve24.github.io/fido/reference/sample_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generic method for sampling from prior distribution of object — sample_prior","text":"object class","code":""},{"path":"https://jsilve24.github.io/fido/reference/sample_prior.pibblefit.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample from the prior distribution of pibblefit object — sample_prior.pibblefit","title":"Sample from the prior distribution of pibblefit object — sample_prior.pibblefit","text":"Note can used sample prior predict can called get counts LambdaX (predict.pibblefit)","code":""},{"path":"https://jsilve24.github.io/fido/reference/sample_prior.pibblefit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample from the prior distribution of pibblefit object — sample_prior.pibblefit","text":"","code":"# S3 method for pibblefit sample_prior(   m,   n_samples = 2000L,   pars = c(\"Eta\", \"Lambda\", \"Sigma\"),   use_names = TRUE,   ... )"},{"path":"https://jsilve24.github.io/fido/reference/sample_prior.pibblefit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample from the prior distribution of pibblefit object — sample_prior.pibblefit","text":"m object class pibblefit n_samples number samples produce pars parameters sample use_names names used available ... currently ignored","code":""},{"path":"https://jsilve24.github.io/fido/reference/sample_prior.pibblefit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample from the prior distribution of pibblefit object — sample_prior.pibblefit","text":"pibblefit object","code":""},{"path":"https://jsilve24.github.io/fido/reference/sample_prior.pibblefit.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sample from the prior distribution of pibblefit object — sample_prior.pibblefit","text":"greatly speed future needed sampling directly cholesky form inverse wishart (currently implemented  header library - see MatDist.h).","code":""},{"path":"https://jsilve24.github.io/fido/reference/sample_prior.pibblefit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample from the prior distribution of pibblefit object — sample_prior.pibblefit","text":"","code":"# Sample prior of already fitted  pibblefit object sim <- pibble_sim() attach(sim) #> The following object is masked from package:fido: #>  #>     Y fit <- pibble(Y, X) head(sample_prior(fit)) #> $D #> [1] 10 #>  #> $N #> [1] 30 #>  #> $Q #> [1] 2 #>  #> $iter #> [1] 2000 #>  #> $coord_system #> [1] \"alr\" #>  #> $alr_base #> [1] 10 #>   # Sample prior as part of model fitting m <- pibblefit(N=as.integer(sim$N), D=as.integer(sim$D), Q=as.integer(sim$Q),                  iter=2000L, upsilon=upsilon,                  Xi=Xi, Gamma=Gamma, Theta=Theta, X=X,                  coord_system=\"alr\", alr_base=D) m <- sample_prior(m) plot(m) # plot prior distribution (defaults to parameter Lambda)  #> Scale for colour is already present. #> Adding another scale for colour, which will replace the existing scale."},{"path":"https://jsilve24.github.io/fido/reference/store_coord.html","id":null,"dir":"Reference","previous_headings":"","what":"Holds information on coordinates system to later be reapplied — store_coord","title":"Holds information on coordinates system to later be reapplied — store_coord","text":"store_coord stores coordinate information pibblefit object can reapplied function reapply_coord. coordinate systems useful computation makes simple keep  returned object computations coordinate system input.  (Likely useful inside package)","code":""},{"path":"https://jsilve24.github.io/fido/reference/store_coord.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Holds information on coordinates system to later be reapplied — store_coord","text":"","code":"store_coord(m)  reapply_coord(m, l)"},{"path":"https://jsilve24.github.io/fido/reference/store_coord.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Holds information on coordinates system to later be reapplied — store_coord","text":"m object class pibblefit l object returned function store_coord","code":""},{"path":"https://jsilve24.github.io/fido/reference/store_coord.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Holds information on coordinates system to later be reapplied — store_coord","text":"store_coord list important information identify c  coordinate system pibblefit object. reapply_coord pibblefit object  coordinate system previously stored.","code":""},{"path":"https://jsilve24.github.io/fido/reference/summarise_posterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Shortcut for summarize variable with quantiles and mean — summarise_posterior","title":"Shortcut for summarize variable with quantiles and mean — summarise_posterior","text":"Shortcut summarize variable quantiles mean","code":""},{"path":"https://jsilve24.github.io/fido/reference/summarise_posterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Shortcut for summarize variable with quantiles and mean — summarise_posterior","text":"","code":"summarise_posterior(data, var, ...)"},{"path":"https://jsilve24.github.io/fido/reference/summarise_posterior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Shortcut for summarize variable with quantiles and mean — summarise_posterior","text":"data tidy data frame var variable name (unquoted) summarised ... expressions pass summarise","code":""},{"path":"https://jsilve24.github.io/fido/reference/summarise_posterior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Shortcut for summarize variable with quantiles and mean — summarise_posterior","text":"data.frame","code":""},{"path":"https://jsilve24.github.io/fido/reference/summarise_posterior.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Shortcut for summarize variable with quantiles and mean — summarise_posterior","text":"Notation: pX refers X% quantile","code":""},{"path":"https://jsilve24.github.io/fido/reference/summarise_posterior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Shortcut for summarize variable with quantiles and mean — summarise_posterior","text":"","code":"d <- data.frame(\"a\"=sample(1:10, 50, TRUE),                 \"b\"=rnorm(50))  # Summarize posterior for b over grouping of a and also calcuate # minmum of b (in addition to normal statistics returned) d <- dplyr::group_by(d, a) summarise_posterior(d, b, mean.b = mean(b), min=min(b)) #> # A tibble: 10 × 9 #>        a    p2.5     p25     p50     mean     p75  p97.5   mean.b     min #>    <int>   <dbl>   <dbl>   <dbl>    <dbl>   <dbl>  <dbl>    <dbl>   <dbl> #>  1     1 -1.50   -1.38   -0.644  -0.615    0.123  0.316  -0.615   -1.51   #>  2     2 -0.609  -0.311   0.0189  0.125    0.508  0.949   0.125   -0.642  #>  3     3 -0.227  -0.0597  0.474   0.364    0.765  0.840   0.364   -0.238  #>  4     4 -0.995  -0.306   0.714   0.290    0.904  1.12    0.290   -1.01   #>  5     5 -1.51   -0.202   0.512  -0.00225  0.665  0.668  -0.00225 -1.65   #>  6     6  0.483   0.496   0.591   0.751    0.846  1.29    0.751    0.482  #>  7     7 -0.410  -0.361  -0.230  -0.0870   0.247  0.316  -0.0870  -0.415  #>  8     8 -1.82   -0.494   0.340   0.0668   0.681  1.60    0.0668  -1.99   #>  9     9 -0.0325  0.0389  0.284   0.761    1.13   2.27    0.761   -0.0404 #> 10    10 -0.928  -0.350  -0.106  -0.285   -0.0410 0.0535 -0.285   -0.992"},{"path":"https://jsilve24.github.io/fido/reference/summary.orthusfit.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise orthusfit object and print posterior quantiles — summary.orthusfit","title":"Summarise orthusfit object and print posterior quantiles — summary.orthusfit","text":"Default calculates median, mean, 50% 95% credible interval","code":""},{"path":"https://jsilve24.github.io/fido/reference/summary.orthusfit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise orthusfit object and print posterior quantiles — summary.orthusfit","text":"","code":"# S3 method for orthusfit summary(   object,   pars = NULL,   use_names = TRUE,   as_factor = FALSE,   gather_prob = FALSE,   ... )"},{"path":"https://jsilve24.github.io/fido/reference/summary.orthusfit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise orthusfit object and print posterior quantiles — summary.orthusfit","text":"object object class orthusfit pars character vector (default: c(\"Eta\", \"Lambda\", \"Sigma\")) use_names summary replace dimension indices orthusfit  names names Y X named call orthus as_factor use_names as_factor returns names factors  (useful maintaining orderings plotting) gather_prob TRUE prints quantiles long format rather  wide (useful plotting functions) ... expressions pass summarise (using name 'val' unquoted  probably want)","code":""},{"path":"https://jsilve24.github.io/fido/reference/summary.orthusfit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise orthusfit object and print posterior quantiles — summary.orthusfit","text":"list","code":""},{"path":"https://jsilve24.github.io/fido/reference/summary.pibblefit.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise pibblefit object and print posterior quantiles — summary.pibblefit","title":"Summarise pibblefit object and print posterior quantiles — summary.pibblefit","text":"Default calculates median, mean, 50% 95% credible interval","code":""},{"path":"https://jsilve24.github.io/fido/reference/summary.pibblefit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise pibblefit object and print posterior quantiles — summary.pibblefit","text":"","code":"# S3 method for pibblefit summary(   object,   pars = NULL,   use_names = TRUE,   as_factor = FALSE,   gather_prob = FALSE,   ... )"},{"path":"https://jsilve24.github.io/fido/reference/summary.pibblefit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise pibblefit object and print posterior quantiles — summary.pibblefit","text":"object object class pibblefit pars character vector (default: c(\"Eta\", \"Lambda\", \"Sigma\")) use_names summary replace dimension indices pibblefit  names names Y X named call pibble as_factor use_names as_factor returns names factors  (useful maintaining orderings plotting) gather_prob TRUE prints quantiles long format rather  wide (useful plotting functions) ... expressions pass summarise (using name 'val' unquoted  probably want)","code":""},{"path":"https://jsilve24.github.io/fido/reference/summary.pibblefit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise pibblefit object and print posterior quantiles — summary.pibblefit","text":"list","code":""},{"path":"https://jsilve24.github.io/fido/reference/uncollapsePibble.html","id":null,"dir":"Reference","previous_headings":"","what":"Uncollapse output from optimPibbleCollapsed to full pibble Model — uncollapsePibble","title":"Uncollapse output from optimPibbleCollapsed to full pibble Model — uncollapsePibble","text":"See details model. likely called following optimPibbleCollapsed. Notation: N number samples, D number multinomial categories, Q number covariates, iter number samples eta (e.g., parameter n_samples function optimPibbleCollapsed)","code":""},{"path":"https://jsilve24.github.io/fido/reference/uncollapsePibble.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Uncollapse output from optimPibbleCollapsed to full pibble Model — uncollapsePibble","text":"","code":"uncollapsePibble(   eta,   X,   Theta,   Gamma,   Xi,   upsilon,   seed,   ret_mean = FALSE,   ncores = -1L )"},{"path":"https://jsilve24.github.io/fido/reference/uncollapsePibble.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Uncollapse output from optimPibbleCollapsed to full pibble Model — uncollapsePibble","text":"eta array dimension (D-1) x N x iter (e.g., Pars output function optimPibbleCollapsed) X matrix covariates dimension Q x N Theta matrix prior mean dimension (D-1) x Q Gamma covariance matrix dimension Q x Q Xi covariance matrix dimension (D-1) x (D-1) upsilon scalar (must > D) degrees freedom InvWishart prior seed seed use random number generation ret_mean true uses posterior mean Lambda Sigma corresponding sample eta rather sampling posterior Lambda Sigma (useful Laplace approximation used (fails) optimPibbleCollapsed) ncores (default:-1) number cores use, ncores==-1 uses default OpenMP typically use available cores.","code":""},{"path":"https://jsilve24.github.io/fido/reference/uncollapsePibble.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Uncollapse output from optimPibbleCollapsed to full pibble Model — uncollapsePibble","text":"List components Lambda Array dimension (D-1) x Q x iter (posterior samples) Sigma Array dimension (D-1) x (D-1) x iter (posterior samples) number cores used Timer","code":""},{"path":"https://jsilve24.github.io/fido/reference/uncollapsePibble.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Uncollapse output from optimPibbleCollapsed to full pibble Model — uncollapsePibble","text":"Notation: Let Z_j denote J-th row matrix Z. collapsed model given : $$Y_j sim Multinomial(Pi_j)$$ $$Pi_j = Phi^{-1}(Eta_j)$$ $$Eta \\sim T_{D-1, N}(upsilon, Theta*X, K, )$$ = I_N + X * Gamma * X', K = Xi (D-1)x(D-1) covariance matrix, Gamma Q x Q covariance matrix, \\(Phi^{-1}\\) ALRInv_D transform. uncollapsed model (Full pibble model) given : $$Y_j \\sim Multinomial(Pi_j)$$ $$Pi_j = Phi^{-1}(Eta_j)$$ $$Eta \\sim MN_{D-1 x N}(Lambda*X, Sigma, I_N)$$ $$Lambda \\sim MN_{D-1 x Q}(Theta, Sigma, Gamma)$$ $$Sigma \\sim InvWish(upsilon, Xi)$$ function provides means sampling posterior distribution Lambda Sigma given posterior samples Eta collapsed model.","code":""},{"path":"https://jsilve24.github.io/fido/reference/uncollapsePibble.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Uncollapse output from optimPibbleCollapsed to full pibble Model — uncollapsePibble","text":"JD Silverman K Roche, ZC Holmes, LA David, S Mukherjee. Bayesian Multinomial Logistic Normal Models Marginally Latent Matrix-T Processes. 2019, arXiv e-prints, arXiv:1903.11695","code":""},{"path":[]},{"path":"https://jsilve24.github.io/fido/reference/uncollapsePibble.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Uncollapse output from optimPibbleCollapsed to full pibble Model — uncollapsePibble","text":"","code":"sim <- pibble_sim()  # Fit model for eta fit <- optimPibbleCollapsed(sim$Y, sim$upsilon, sim$Theta%*%sim$X, sim$KInv,                               sim$AInv, random_pibble_init(sim$Y))    # Finally obtain samples from Lambda and Sigma fit2 <- uncollapsePibble(fit$Samples, sim$X, sim$Theta,                                     sim$Gamma, sim$Xi, sim$upsilon,                                     seed=2849)"},{"path":"https://jsilve24.github.io/fido/reference/uncollapsePibble_sigmaKnown.html","id":null,"dir":"Reference","previous_headings":"","what":"Uncollapse output from optimPibbleCollapsed to full pibble Model when Sigma is known — uncollapsePibble_sigmaKnown","title":"Uncollapse output from optimPibbleCollapsed to full pibble Model when Sigma is known — uncollapsePibble_sigmaKnown","text":"See details model. likely called following optimPibbleCollapsed. Notation: N number samples, D number multinomial categories, Q number covariates, iter number samples eta (e.g., parameter n_samples function optimPibbleCollapsed)","code":""},{"path":"https://jsilve24.github.io/fido/reference/uncollapsePibble_sigmaKnown.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Uncollapse output from optimPibbleCollapsed to full pibble Model when Sigma is known — uncollapsePibble_sigmaKnown","text":"","code":"uncollapsePibble_sigmaKnown(   eta,   X,   Theta,   Gamma,   GammaComb,   Xi,   sigma,   upsilon,   seed,   ret_mean = FALSE,   linear = FALSE,   ncores = -1L )"},{"path":"https://jsilve24.github.io/fido/reference/uncollapsePibble_sigmaKnown.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Uncollapse output from optimPibbleCollapsed to full pibble Model when Sigma is known — uncollapsePibble_sigmaKnown","text":"eta array dimension (D-1) x N x iter (e.g., Pars output function optimPibbleCollapsed) X matrix covariates dimension Q x N Theta matrix prior mean dimension (D-1) x Q Gamma covariance matrix dimension Q x Q GammaComb summed covariance matrix across additive components dimension Q x Q. Xi covariance matrix dimension (D-1) x (D-1) sigma known covariance matrix dimension (D-1) x (D-1) x iter upsilon scalar (must > D) degrees freedom InvWishart prior seed seed use random number generation ret_mean true uses posterior mean Lambda Sigma corresponding sample eta rather sampling posterior Lambda Sigma (useful Laplace approximation used (fails) optimPibbleCollapsed) linear Boolean. linear parameter? ncores (default:-1) number cores use, ncores==-1 uses default OpenMP typically use available cores.","code":""},{"path":"https://jsilve24.github.io/fido/reference/uncollapsePibble_sigmaKnown.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Uncollapse output from optimPibbleCollapsed to full pibble Model when Sigma is known — uncollapsePibble_sigmaKnown","text":"List components Lambda Array dimension (D-1) x Q x iter (posterior samples) Sigma Array dimension (D-1) x (D-1) x iter (posterior samples) number cores used Timer","code":""},{"path":"https://jsilve24.github.io/fido/reference/uncollapsePibble_sigmaKnown.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Uncollapse output from optimPibbleCollapsed to full pibble Model when Sigma is known — uncollapsePibble_sigmaKnown","text":"Notation: Let Z_j denote J-th row matrix Z. collapsed model given : $$Y_j \\sim Multinomial(Pi_j)$$ $$Pi_j = Phi^{-1}(Eta_j)$$ $$Eta \\sim T_{D-1, N}(upsilon, Theta*X, K, )$$ = I_N + X * Gamma * X', K = Xi (D-1)x(D-1) covariance matrix, Gamma Q x Q covariance matrix, \\(Phi^{-1}\\) ALRInv_D transform. uncollapsed model (Full pibble model) given : $$Y_j \\sim Multinomial(Pi_j)$$ $$Pi_j = Phi^{-1}(Eta_j)$$ $$Eta \\sim MN_{D-1 x N}(Lambda*X, Sigma, I_N)$$ $$Lambda \\sim MN_{D-1 x Q}(Theta, Sigma, Gamma)$$ $$Sigma \\sim InvWish(upsilon, Xi)$$ function provides means sampling posterior distribution Lambda Sigma given posterior samples Eta collapsed model.","code":""},{"path":"https://jsilve24.github.io/fido/reference/uncollapsePibble_sigmaKnown.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Uncollapse output from optimPibbleCollapsed to full pibble Model when Sigma is known — uncollapsePibble_sigmaKnown","text":"JD Silverman K Roche, ZC Holmes, LA David, S Mukherjee. Bayesian Multinomial Logistic Normal Models Marginally Latent Matrix-T Processes. 2019, arXiv e-prints, arXiv:1903.11695","code":""},{"path":[]},{"path":"https://jsilve24.github.io/fido/reference/verify.bassetfit.html","id":null,"dir":"Reference","previous_headings":"","what":"Simple verification of passed bassetfit object — verify.bassetfit","title":"Simple verification of passed bassetfit object — verify.bassetfit","text":"Simple verification passed bassetfit object","code":""},{"path":"https://jsilve24.github.io/fido/reference/verify.bassetfit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simple verification of passed bassetfit object — verify.bassetfit","text":"","code":"# S3 method for bassetfit verify(m, ...)"},{"path":"https://jsilve24.github.io/fido/reference/verify.bassetfit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simple verification of passed bassetfit object — verify.bassetfit","text":"m object class bassetfit ... used","code":""},{"path":"https://jsilve24.github.io/fido/reference/verify.bassetfit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simple verification of passed bassetfit object — verify.bassetfit","text":"throws error verification tests fail","code":""},{"path":"https://jsilve24.github.io/fido/reference/verify.html","id":null,"dir":"Reference","previous_headings":"","what":"Generic method for verifying new objects — verify","title":"Generic method for verifying new objects — verify","text":"Intended called internally package object creator","code":""},{"path":"https://jsilve24.github.io/fido/reference/verify.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generic method for verifying new objects — verify","text":"","code":"verify(m, ...)"},{"path":"https://jsilve24.github.io/fido/reference/verify.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generic method for verifying new objects — verify","text":"m object ... arguments passed verify","code":""},{"path":"https://jsilve24.github.io/fido/reference/verify.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generic method for verifying new objects — verify","text":"throws error verify test fails","code":""},{"path":"https://jsilve24.github.io/fido/reference/verify.maltipoofit.html","id":null,"dir":"Reference","previous_headings":"","what":"Simple verification of passed multipoo object — verify.maltipoofit","title":"Simple verification of passed multipoo object — verify.maltipoofit","text":"Simple verification passed multipoo object","code":""},{"path":"https://jsilve24.github.io/fido/reference/verify.maltipoofit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simple verification of passed multipoo object — verify.maltipoofit","text":"","code":"# S3 method for maltipoofit verify(m, ...)"},{"path":"https://jsilve24.github.io/fido/reference/verify.maltipoofit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simple verification of passed multipoo object — verify.maltipoofit","text":"m object class multipoo ... used","code":""},{"path":"https://jsilve24.github.io/fido/reference/verify.maltipoofit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simple verification of passed multipoo object — verify.maltipoofit","text":"throws error verification tests fail","code":""},{"path":"https://jsilve24.github.io/fido/reference/verify.orthusfit.html","id":null,"dir":"Reference","previous_headings":"","what":"Simple verification of passed orthusfit object — verify.orthusfit","title":"Simple verification of passed orthusfit object — verify.orthusfit","text":"Simple verification passed orthusfit object","code":""},{"path":"https://jsilve24.github.io/fido/reference/verify.orthusfit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simple verification of passed orthusfit object — verify.orthusfit","text":"","code":"# S3 method for orthusfit verify(m, ...)"},{"path":"https://jsilve24.github.io/fido/reference/verify.orthusfit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simple verification of passed orthusfit object — verify.orthusfit","text":"m object class orthusfit ... used","code":""},{"path":"https://jsilve24.github.io/fido/reference/verify.orthusfit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simple verification of passed orthusfit object — verify.orthusfit","text":"throws error verification tests fail","code":""},{"path":"https://jsilve24.github.io/fido/reference/verify.pibblefit.html","id":null,"dir":"Reference","previous_headings":"","what":"Simple verification of passed pibblefit object — verify.pibblefit","title":"Simple verification of passed pibblefit object — verify.pibblefit","text":"Simple verification passed pibblefit object","code":""},{"path":"https://jsilve24.github.io/fido/reference/verify.pibblefit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simple verification of passed pibblefit object — verify.pibblefit","text":"","code":"# S3 method for pibblefit verify(m, ...)"},{"path":"https://jsilve24.github.io/fido/reference/verify.pibblefit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simple verification of passed pibblefit object — verify.pibblefit","text":"m object class pibblefit ... used","code":""},{"path":"https://jsilve24.github.io/fido/reference/verify.pibblefit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simple verification of passed pibblefit object — verify.pibblefit","text":"throws error verification tests fail","code":""},{"path":"https://jsilve24.github.io/fido/reference/Y.html","id":null,"dir":"Reference","previous_headings":"","what":"Data from Silverman et al. (2019) bioRxiv — Y","title":"Data from Silverman et al. (2019) bioRxiv — Y","text":"Mock communities calibration samples created measuring validating model PCR bias. data preprocessed original manuscript.","code":""},{"path":"https://jsilve24.github.io/fido/reference/Y.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Data from Silverman et al. (2019) bioRxiv — Y","text":"matrix Y (counts community member)","code":""},{"path":"https://jsilve24.github.io/fido/reference/Y.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Data from Silverman et al. (2019) bioRxiv — Y","text":"Justin D. Silverman, Rachael J. Bloom, Sharon Jiang, Heather K. Durand, Sayan Mukherjee,  Lawrence . David. (2019) Measuring Mitigating PCR Bias Microbiome Data.  bioRxiv 604025; doi: https://doi.org/10.1101/604025","code":""},{"path":"https://jsilve24.github.io/fido/news/index.html","id":"fido-110","dir":"Changelog","previous_headings":"","what":"fido 1.1.0","title":"fido 1.1.0","text":"Updating basset model allow additive Gaussian processes Updating random seed generation","code":""},{"path":"https://jsilve24.github.io/fido/news/index.html","id":"fido-104","dir":"Changelog","previous_headings":"","what":"fido 1.0.4","title":"fido 1.0.4","text":"CRAN release: 2023-03-24 changing default optimizer (lbfgs rather adam), adam sensitive random seed adding new r2 methods calculating Bayesian R2 pibble basset models predict.bassetfit now accepts newdata=NULL argument predict training set bug fixes fixing discrepancies base R commands (print, summary, etc).","code":""},{"path":"https://jsilve24.github.io/fido/news/index.html","id":"fido-103","dir":"Changelog","previous_headings":"","what":"fido 1.0.3","title":"fido 1.0.3","text":"CRAN release: 2022-08-23 bug fixes Updating documentation newest version R (4.2.1)","code":""},{"path":"https://jsilve24.github.io/fido/news/index.html","id":"fido-102","dir":"Changelog","previous_headings":"","what":"fido 1.0.2","title":"fido 1.0.2","text":"CRAN release: 2022-07-06 bug fixes Removing timing test irrelevant can fail certain set-ups.","code":""},{"path":"https://jsilve24.github.io/fido/news/index.html","id":"fido-101","dir":"Changelog","previous_headings":"","what":"fido 1.0.1","title":"fido 1.0.1","text":"CRAN release: 2022-05-17 bug fixes Changing phyloseq imports depends, causing issues installing CRAN. Fixing bug configure.ac causing openmp parallelization work machines.","code":""},{"path":"https://jsilve24.github.io/fido/news/index.html","id":"fido-100","dir":"Changelog","previous_headings":"","what":"fido 1.0.0","title":"fido 1.0.0","text":"CRAN release: 2022-02-16 changes make final push CRAN! Changes include: Updating description file match CRAN’s standards Removing dependency driver Linking one remote package (MicrobeDS) separate CRAN-like Github repo using “drat” package. match CRAN’s policy use “Remotes”. Precomputing longer running vignettes, cutting R CMD check times half. original vignettes can found vignettes folder “.orig” extension reproducibility.","code":""},{"path":"https://jsilve24.github.io/fido/news/index.html","id":"fido-0114","dir":"Changelog","previous_headings":"","what":"fido 0.1.14","title":"fido 0.1.14","text":"changes prepare version 0.2 (CRAN soon), including: Lots cleaning small warnings notes Fixing erorrs base plot function Cleaning manual entries Fixing errors posted Github (to_ilr among others)","code":""},{"path":"https://jsilve24.github.io/fido/news/index.html","id":"fido-0113","dir":"Changelog","previous_headings":"","what":"fido 0.1.13","title":"fido 0.1.13","text":"tons tiny changes prepare version 0.2 (ultimately CRAN) featured changes include: plot coef methods *fit objects now abide CRAN generic naming scheme - may cause problems prior code positional arguments functions now tested using travis integration (vignettes tested due time constraints) merged Kim’s fixes maltipoo code (almost certainly change maltipoo results; bug prior versions) Internally stored mallard mallard_family data now import mallard mallard_family rather importing ps. Solved R CMD CHECK warning. Lots tiny updates documentation","code":""},{"path":"https://jsilve24.github.io/fido/news/index.html","id":"fido-0112","dir":"Changelog","previous_headings":"","what":"fido 0.1.12","title":"fido 0.1.12","text":"orthus added jointly fitting multinomial gaussian data (e.g., 16S microbiome metabolomics data)","code":""},{"path":"https://jsilve24.github.io/fido/news/index.html","id":"fido-0111","dir":"Changelog","previous_headings":"","what":"fido 0.1.11","title":"fido 0.1.11","text":"Kim fixed windows installation problems (Thanks Kim!) Fixed bug predict effecting ppc Fixed error pars!=NULL summary lambda_to_iqlr now default behavior focus.cov=NULL Fixed issue Xi=NULL pibblefit trying transform small changes make pibble wrapper around c++ functions faster","code":""},{"path":"https://jsilve24.github.io/fido/news/index.html","id":"fido-0110","dir":"Changelog","previous_headings":"","what":"fido 0.1.10","title":"fido 0.1.10","text":"basset added fitting non-linear regression using fido numerous changes make installation easier Added NEWS.md file track changes package.","code":""}]
