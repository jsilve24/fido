<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Uncollapse output from optimPibbleCollapsed to full pibble Model — uncollapsePibble • fido</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Uncollapse output from optimPibbleCollapsed to full pibble Model — uncollapsePibble"><meta name="description" content="See details for model. Should likely be called following
optimPibbleCollapsed. Notation: N is number of samples,
D is number of multinomial categories, Q is number
of covariates, iter is the number of samples of eta (e.g.,
the parameter n_samples in the function optimPibbleCollapsed)"><meta property="og:description" content="See details for model. Should likely be called following
optimPibbleCollapsed. Notation: N is number of samples,
D is number of multinomial categories, Q is number
of covariates, iter is the number of samples of eta (e.g.,
the parameter n_samples in the function optimPibbleCollapsed)"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fido</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction-to-fido.html">Introduction to fido::Pibble</a></li>
    <li><a class="dropdown-item" href="../articles/non-linear-models.html">Non-linear models with fido::basset</a></li>
    <li><a class="dropdown-item" href="../articles/orthus.html">Joint Modeling  (e.g., Multiomics) with fido::Orthus</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jsilve24/fido/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Uncollapse output from optimPibbleCollapsed to full pibble Model</h1>
      <small class="dont-index">Source: <a href="https://github.com/jsilve24/fido/blob/master/R/RcppExports.R" class="external-link"><code>R/RcppExports.R</code></a></small>
      <div class="d-none name"><code>uncollapsePibble.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>See details for model. Should likely be called following
<code><a href="optimPibbleCollapsed.html">optimPibbleCollapsed</a></code>. Notation: <code>N</code> is number of samples,
<code>D</code> is number of multinomial categories, <code>Q</code> is number
of covariates, <code>iter</code> is the number of samples of <code>eta</code> (e.g.,
the parameter <code>n_samples</code> in the function <code>optimPibbleCollapsed</code>)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">uncollapsePibble</span><span class="op">(</span></span>
<span>  <span class="va">eta</span>,</span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">Theta</span>,</span>
<span>  <span class="va">Gamma</span>,</span>
<span>  <span class="va">Xi</span>,</span>
<span>  <span class="va">upsilon</span>,</span>
<span>  <span class="va">seed</span>,</span>
<span>  ret_mean <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ncores <span class="op">=</span> <span class="op">-</span><span class="fl">1L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-eta">eta<a class="anchor" aria-label="anchor" href="#arg-eta"></a></dt>
<dd><p>array of dimension (D-1) x N x iter (e.g., <code>Pars</code> output of
function optimPibbleCollapsed)</p></dd>


<dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>matrix of covariates of dimension Q x N</p></dd>


<dt id="arg-theta">Theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>matrix of prior mean of dimension (D-1) x Q</p></dd>


<dt id="arg-gamma">Gamma<a class="anchor" aria-label="anchor" href="#arg-gamma"></a></dt>
<dd><p>covariance matrix of dimension Q x Q</p></dd>


<dt id="arg-xi">Xi<a class="anchor" aria-label="anchor" href="#arg-xi"></a></dt>
<dd><p>covariance matrix of dimension (D-1) x (D-1)</p></dd>


<dt id="arg-upsilon">upsilon<a class="anchor" aria-label="anchor" href="#arg-upsilon"></a></dt>
<dd><p>scalar (must be &gt; D) degrees of freedom for InvWishart prior</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>seed to use for random number generation</p></dd>


<dt id="arg-ret-mean">ret_mean<a class="anchor" aria-label="anchor" href="#arg-ret-mean"></a></dt>
<dd><p>if true then uses posterior mean of Lambda and Sigma
corresponding to each sample of eta rather than sampling from
posterior of Lambda and Sigma (useful if Laplace approximation
is not used (or fails) in optimPibbleCollapsed)</p></dd>


<dt id="arg-ncores">ncores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>(default:-1) number of cores to use, if ncores==-1 then
uses default from OpenMP typically to use all available cores.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List with components</p><ol><li><p>Lambda Array of dimension (D-1) x Q x iter (posterior samples)</p></li>
<li><p>Sigma Array of dimension (D-1) x (D-1) x iter (posterior samples)</p></li>
<li><p>The number of cores used</p></li>
<li><p>Timer</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Notation: Let \(Z_j\) denote the J-th row of a matrix Z.
While the collapsed model is given by:
$$Y_j \sim \text{Multinomial}(\pi_j)$$
$$\pi_j = \Phi^{-1}(\eta_j)$$
$$\eta \sim T_{D-1, N}(\upsilon, \Theta X, K, A)$$
Where \(A = I_N + X \Gamma X'\), \(K=\Xi\) is a (D-1)x(D-1) covariance
matrix, \(\Gamma\) is a Q x Q covariance matrix, and \(\Phi^{-1}\) is ALRInv_D
transform.</p>
<p>The uncollapsed model (Full pibble model) is given by:
$$Y_j \sim \text{Multinomial}(\pi_j)$$
$$\pi_j = \Phi^{-1}(\eta_j)$$
$$\eta \sim MN_{D-1 \times N}(\Lambda X, \Sigma, I_N)$$
$$\Lambda \sim MN_{D-1 x Q}(\Theta, \Sigma, \Gamma)$$
$$\Sigma \sim InvWish(\upsilon, \Xi)$$
This function provides a means of sampling from the posterior distribution of
<code>Lambda</code> and <code>Sigma</code> given posterior samples of <code>Eta</code> from
the collapsed model.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>JD Silverman K Roche, ZC Holmes, LA David, S Mukherjee.
Bayesian Multinomial Logistic Normal Models through Marginally Latent Matrix-T Processes.
2019, arXiv e-prints, arXiv:1903.11695</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="optimPibbleCollapsed.html">optimPibbleCollapsed</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="pibble_sim.html">pibble_sim</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit model for eta</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="optimPibbleCollapsed.html">optimPibbleCollapsed</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">Y</span>, <span class="va">sim</span><span class="op">$</span><span class="va">upsilon</span>, <span class="va">sim</span><span class="op">$</span><span class="va">Theta</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">sim</span><span class="op">$</span><span class="va">X</span>, <span class="va">sim</span><span class="op">$</span><span class="va">KInv</span>, </span></span>
<span class="r-in"><span>                             <span class="va">sim</span><span class="op">$</span><span class="va">AInv</span>, <span class="fu"><a href="random_pibble_init.html">random_pibble_init</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span>  </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Finally obtain samples from Lambda and Sigma</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">uncollapsePibble</span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">Samples</span>, <span class="va">sim</span><span class="op">$</span><span class="va">X</span>, <span class="va">sim</span><span class="op">$</span><span class="va">Theta</span>, </span></span>
<span class="r-in"><span>                                   <span class="va">sim</span><span class="op">$</span><span class="va">Gamma</span>, <span class="va">sim</span><span class="op">$</span><span class="va">Xi</span>, <span class="va">sim</span><span class="op">$</span><span class="va">upsilon</span>, </span></span>
<span class="r-in"><span>                                   seed<span class="op">=</span><span class="fl">2849</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.justin-silverman.com/" class="external-link">Justin Silverman</a>, Michelle Nixon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

